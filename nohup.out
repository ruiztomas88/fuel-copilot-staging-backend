INFO:     Will watch for changes in these directories: ['/Users/tomasruiz/Desktop/Fuel-Analytics-Backend']
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
INFO:     Started reloader process [24417] using WatchFiles
‚ö†Ô∏è MYSQL_PASSWORD not set - database connections will fail
‚ö†Ô∏è LOCAL_DB_PASS not set - local database connections will fail
‚ö†Ô∏è  Redis cache unavailable: No module named 'redis_cache'
/opt/anaconda3/lib/python3.12/site-packages/keras/src/export/tf2onnx_lib.py:8: FutureWarning: In the future `np.object` will be defined as the corresponding NumPy scalar.
  if not hasattr(np, "object"):
‚ö†Ô∏è MPG History router not available: No module named 'logger_config'
INFO:main:‚úÖ Driver Alerts router registered
INFO:main:‚úÖ Alerts router registered
INFO:main:‚úÖ Trucks router registered
INFO:main:‚úÖ Refuels router registered
INFO:main:‚úÖ Analytics router registered
INFO:main:‚úÖ Maintenance router registered
INFO:ekf_integration:‚úÖ EKFManager inicializado en data/ekf_states
INFO:main:‚úÖ FASE 2A: EKF Integration & Diagnostics endpoints registered
INFO:main:‚úÖ FASE 2B: ML Pipeline (LSTM + Anomaly Detection + Driver Scoring) loaded
INFO:kafka_event_bus:‚úÖ Event Bus inicializado
INFO:kafka_event_bus:‚úÖ Event Bus suscriptores inicializados
INFO:main:‚úÖ FASE 2C: Event Bus & Microservices Orchestrator loaded
INFO:main:‚úÖ New Features: Cache + WebSocket + ML + Coaching registered
INFO:main:‚úÖ API v2 router registered
INFO:main:‚úÖ FASE 2C: Route Optimization Engine loaded
INFO:main:‚úÖ Prometheus metrics enabled
INFO:main:‚úÖ Rate limiting middleware enabled
INFO:main:‚úÖ GZip compression middleware enabled
INFO:main:‚úÖ CORS configured with 5 allowed origins
INFO:main:‚úÖ Global exception handler registered
INFO:routers:‚úÖ Registered api_v2 router at /fuelAnalytics/api/v2
INFO:routers:‚úÖ Registered command_center router at /fuelAnalytics/api/command-center
INFO:main:‚úÖ All routers included successfully
INFO:routers_v3:‚úÖ Registered api_v2 router at /fuelAnalytics/api/v2
INFO:routers_v3:‚úÖ Registered sse_endpoints router
INFO:routers_v3:‚úÖ Registered fuel_stations router
INFO:routers_v3:‚úÖ Registered sensor_health_router
INFO:routers_v3:‚úÖ Registered mpg_baseline_router
INFO:routers_v3:‚úÖ Registered driver_alerts_router at /fuelAnalytics/api/v2/driver-alerts
INFO:routers_v3:üöÄ v3.12.21 routers registration complete
INFO:main:‚úÖ v3.12.21 API v2 router registered
INFO:v5_endpoints:‚úÖ V5 Endpoints registered (Fleet Analytics + Leaderboard)
INFO:main:‚úÖ V5 Clean Endpoints registered (Fleet Analytics, Leaderboard)
INFO:main:üöÄ v5.2: Using new lightweight v5 endpoints (TruckHealthMonitor disabled)
INFO:     Started server process [24548]
INFO:     Waiting for application startup.
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üöÄ Fuel Copilot API v3.12.0 STARTING...
INFO:lifecycle_manager:üìÖ Startup Time: 2025-12-28T17:53:18.943271
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üîÑ Initializing multi-layer cache...
INFO:lifecycle_manager:‚úÖ Multi-layer cache connected successfully
INFO:lifecycle_manager:üîÑ Initializing async database pool...
INFO:database_async:üîÑ Creating async MySQL connection pool...
INFO:database_async:   Host: localhost:3306
INFO:database_async:   Database: fuel_copilot_local
INFO:database_async:   Pool size: 5-20
INFO:database_async:‚úÖ Async MySQL connection pool created successfully
INFO:lifecycle_manager:‚úÖ Async DB pool initialized successfully
INFO:database_mysql:‚úÖ SQLAlchemy engine created with connection pooling (10+5 connections)
INFO:database:‚úÖ Found 22 trucks in MySQL
INFO:lifecycle_manager:Available trucks: 22
INFO:lifecycle_manager:MySQL enhanced features: enabled
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:‚úÖ API ready for connections
INFO:lifecycle_manager:================================================================================
INFO:     Application startup complete.
INFO:database:‚úÖ Found 22 trucks in MySQL
INFO:config:‚úÖ Loaded 45 trucks from tanks.yaml
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=9.6, estimated_pct(row[35])=9.61
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 9.6
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
INFO:bulk_mysql_handler:üöÄ Bulk MySQL Handler initialized (batch_size=20, auto_flush=30.0s)
‚úÖ SPN Decoder initialized with 111 SPNs
‚úÖ SPN Decoder initialized with 111 SPNs
INFO:     127.0.0.1:55668 - "GET /fuelAnalytics/api/health HTTP/1.1" 200 OK
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=9.6, estimated_pct(row[35])=9.61
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 9.6
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 17:54:01 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
WARNING:main:üîç DEBUG: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
WARNING:main:üîç DEBUG: sensor_pct value: 9.6
INFO:     127.0.0.1:55675 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:     127.0.0.1:55672 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 17:55:01 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=9.6, estimated_pct(row[35])=9.61
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 9.6
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
WARNING:main:üîç DEBUG: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
WARNING:main:üîç DEBUG: sensor_pct value: 9.6
INFO:     127.0.0.1:55691 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:     127.0.0.1:55689 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 17:55:13 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:55699 - "GET /fuelAnalytics/api/v2/fleet/patterns HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 17:56:01 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=9.6, estimated_pct(row[35])=9.61
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 9.6
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
WARNING:main:üîç DEBUG: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
WARNING:main:üîç DEBUG: sensor_pct value: 9.6
INFO:     127.0.0.1:55709 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:     127.0.0.1:55707 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 17:57:01 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=9.6, estimated_pct(row[35])=9.61
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 9.6
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
WARNING:main:üîç DEBUG: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
WARNING:main:üîç DEBUG: sensor_pct value: 9.6
INFO:     127.0.0.1:55718 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:     127.0.0.1:55715 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 17:57:13 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:55725 - "GET /fuelAnalytics/api/v2/fleet/patterns HTTP/1.1" 200 OK
INFO:cache_service:‚úÖ Redis connected: redis://localhost:6379/0
INFO:     127.0.0.1:55729 - "GET /fuelAnalytics/api/predictive-maintenance HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 17:58:01 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=9.6, estimated_pct(row[35])=9.61
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 9.6
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
WARNING:main:üîç DEBUG: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
WARNING:main:üîç DEBUG: sensor_pct value: 9.6
INFO:     127.0.0.1:55740 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:     127.0.0.1:55737 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 17:59:01 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=9.6, estimated_pct(row[35])=9.61
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 9.6
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
WARNING:main:üîç DEBUG: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
WARNING:main:üîç DEBUG: sensor_pct value: 9.6
INFO:     127.0.0.1:55754 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:     127.0.0.1:55752 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 17:59:13 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:55760 - "GET /fuelAnalytics/api/v2/fleet/patterns HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:00:01 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=9.6, estimated_pct(row[35])=9.61
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 9.6
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
WARNING:main:üîç DEBUG: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
WARNING:main:üîç DEBUG: sensor_pct value: 9.6
INFO:     127.0.0.1:55769 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:     127.0.0.1:55766 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:01:01 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=9.6, estimated_pct(row[35])=9.61
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 9.6
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
WARNING:main:üîç DEBUG: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
WARNING:main:üîç DEBUG: sensor_pct value: 9.6
INFO:     127.0.0.1:55780 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:     127.0.0.1:55777 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:02:01 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=9.6, estimated_pct(row[35])=9.61
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 9.6
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
WARNING:main:üîç DEBUG: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
WARNING:main:üîç DEBUG: sensor_pct value: 9.6
INFO:     127.0.0.1:55792 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:     127.0.0.1:55790 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:02:05 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:55798 - "GET /fuelAnalytics/api/v2/fleet/patterns HTTP/1.1" 200 OK
WARNING:api_endpoints_async:Error analyzing oil_pump for CO0681: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for CO0681: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for CO0681: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for DO9356: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for DO9356: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for DO9356: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for DO9693: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for DO9693: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for DO9693: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for DR6664: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for DR6664: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for DR6664: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for FM3363: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for FM3363: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for GP9677: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for GP9677: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for GS5030: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for GS5030: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for JB6858: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for JB6858: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for JB6858: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for JC1282: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for JC1282: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for JC1282: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for JP3281: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for JP3281: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for JP3281: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for JR7099: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for JR7099: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for LC6799: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for LC6799: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for LC6799: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for LH1141: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for LH1141: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for MJ9547: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for MJ9547: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for MJ9547: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for MR7679: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for MR7679: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for OM7769: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for OM7769: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for RA9250: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for RA9250: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for RC6625: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for RC6625: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for RH1522: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for RH1522: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for RR1272: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for RR1272: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for RT9127: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for RT9127: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for RT9127: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for SG5760: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for SG5760: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for SG5760: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
INFO:     127.0.0.1:55804 - "GET /fuelAnalytics/api/predictive-maintenance HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:03:01 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=9.6, estimated_pct(row[35])=9.57
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 9.6
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
WARNING:main:üîç DEBUG: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
WARNING:main:üîç DEBUG: sensor_pct value: 9.6
INFO:     127.0.0.1:55817 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:     127.0.0.1:55814 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:     127.0.0.1:55829 - "GET /fuelAnalytics/api/auth/me HTTP/1.1" 401 Unauthorized
INFO:database:‚úÖ Found 22 trucks in MySQL
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=9.6, estimated_pct(row[35])=9.57
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 9.6
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
INFO:     127.0.0.1:55927 - "GET /fuelAnalytics/api/health HTTP/1.1" 200 OK
WARNING:  WatchFiles detected changes in 'main.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üõë Shutting down Fuel Copilot API
INFO:lifecycle_manager:üìÖ Shutdown Time: 2025-12-28T18:10:41.105467
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üîÑ Disconnecting cache...
INFO:lifecycle_manager:‚úÖ Cache disconnected
INFO:lifecycle_manager:üîÑ Closing async database pool...
INFO:database_async:üîÑ Closing async MySQL connection pool...
INFO:database_async:‚úÖ Async MySQL connection pool closed
INFO:lifecycle_manager:‚úÖ Async DB pool closed
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:‚úÖ Clean shutdown completed
INFO:lifecycle_manager:================================================================================
INFO:     Application shutdown complete.
INFO:     Finished server process [24548]
‚ö†Ô∏è MYSQL_PASSWORD not set - database connections will fail
‚ö†Ô∏è LOCAL_DB_PASS not set - local database connections will fail
‚ö†Ô∏è  Redis cache unavailable: No module named 'redis_cache'
WARNING:  WatchFiles detected changes in 'api_endpoints_async.py'. Reloading...
/opt/anaconda3/lib/python3.12/site-packages/keras/src/export/tf2onnx_lib.py:8: FutureWarning: In the future `np.object` will be defined as the corresponding NumPy scalar.
  if not hasattr(np, "object"):
‚ö†Ô∏è MPG History router not available: No module named 'logger_config'
INFO:main:‚úÖ Driver Alerts router registered
INFO:main:‚úÖ Alerts router registered
INFO:main:‚úÖ Trucks router registered
INFO:main:‚úÖ Refuels router registered
INFO:main:‚úÖ Analytics router registered
INFO:main:‚úÖ Maintenance router registered
INFO:ekf_integration:‚úÖ EKFManager inicializado en data/ekf_states
INFO:main:‚úÖ FASE 2A: EKF Integration & Diagnostics endpoints registered
INFO:main:‚úÖ FASE 2B: ML Pipeline (LSTM + Anomaly Detection + Driver Scoring) loaded
INFO:kafka_event_bus:‚úÖ Event Bus inicializado
INFO:kafka_event_bus:‚úÖ Event Bus suscriptores inicializados
INFO:main:‚úÖ FASE 2C: Event Bus & Microservices Orchestrator loaded
INFO:main:‚úÖ New Features: Cache + WebSocket + ML + Coaching registered
INFO:main:‚úÖ API v2 router registered
INFO:main:‚úÖ FASE 2C: Route Optimization Engine loaded
INFO:main:‚úÖ Prometheus metrics enabled
INFO:main:‚úÖ Rate limiting middleware enabled
INFO:main:‚úÖ GZip compression middleware enabled
INFO:main:‚úÖ CORS configured with 5 allowed origins
INFO:main:‚úÖ Global exception handler registered
INFO:routers:‚úÖ Registered api_v2 router at /fuelAnalytics/api/v2
INFO:routers:‚úÖ Registered command_center router at /fuelAnalytics/api/command-center
INFO:main:‚úÖ All routers included successfully
INFO:routers_v3:‚úÖ Registered api_v2 router at /fuelAnalytics/api/v2
INFO:routers_v3:‚úÖ Registered sse_endpoints router
INFO:routers_v3:‚úÖ Registered fuel_stations router
INFO:routers_v3:‚úÖ Registered sensor_health_router
INFO:routers_v3:‚úÖ Registered mpg_baseline_router
INFO:routers_v3:‚úÖ Registered driver_alerts_router at /fuelAnalytics/api/v2/driver-alerts
INFO:routers_v3:üöÄ v3.12.21 routers registration complete
INFO:main:‚úÖ v3.12.21 API v2 router registered
INFO:v5_endpoints:‚úÖ V5 Endpoints registered (Fleet Analytics + Leaderboard)
INFO:main:‚úÖ V5 Clean Endpoints registered (Fleet Analytics, Leaderboard)
INFO:main:üöÄ v5.2: Using new lightweight v5 endpoints (TruckHealthMonitor disabled)
INFO:     Started server process [30568]
INFO:     Waiting for application startup.
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üöÄ Fuel Copilot API v3.12.0 STARTING...
INFO:lifecycle_manager:üìÖ Startup Time: 2025-12-28T18:10:44.787331
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üîÑ Initializing multi-layer cache...
INFO:lifecycle_manager:‚úÖ Multi-layer cache connected successfully
INFO:lifecycle_manager:üîÑ Initializing async database pool...
INFO:database_async:üîÑ Creating async MySQL connection pool...
INFO:database_async:   Host: localhost:3306
INFO:database_async:   Database: fuel_copilot_local
INFO:database_async:   Pool size: 5-20
INFO:database_async:‚úÖ Async MySQL connection pool created successfully
INFO:lifecycle_manager:‚úÖ Async DB pool initialized successfully
INFO:database_mysql:‚úÖ SQLAlchemy engine created with connection pooling (10+5 connections)
INFO:database:‚úÖ Found 22 trucks in MySQL
INFO:lifecycle_manager:Available trucks: 22
INFO:lifecycle_manager:MySQL enhanced features: enabled
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:‚úÖ API ready for connections
INFO:lifecycle_manager:================================================================================
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'lifecycle_manager.py'. Reloading...
‚ö†Ô∏è MYSQL_PASSWORD not set - database connections will fail
‚ö†Ô∏è LOCAL_DB_PASS not set - local database connections will fail
‚ö†Ô∏è  Redis cache unavailable: No module named 'redis_cache'
/opt/anaconda3/lib/python3.12/site-packages/keras/src/export/tf2onnx_lib.py:8: FutureWarning: In the future `np.object` will be defined as the corresponding NumPy scalar.
  if not hasattr(np, "object"):
‚ö†Ô∏è MPG History router not available: No module named 'logger_config'
INFO:main:‚úÖ Driver Alerts router registered
INFO:main:‚úÖ Alerts router registered
INFO:main:‚úÖ Trucks router registered
INFO:main:‚úÖ Refuels router registered
INFO:main:‚úÖ Analytics router registered
INFO:main:‚úÖ Maintenance router registered
INFO:ekf_integration:‚úÖ EKFManager inicializado en data/ekf_states
INFO:main:‚úÖ FASE 2A: EKF Integration & Diagnostics endpoints registered
INFO:main:‚úÖ FASE 2B: ML Pipeline (LSTM + Anomaly Detection + Driver Scoring) loaded
INFO:kafka_event_bus:‚úÖ Event Bus inicializado
INFO:kafka_event_bus:‚úÖ Event Bus suscriptores inicializados
INFO:main:‚úÖ FASE 2C: Event Bus & Microservices Orchestrator loaded
INFO:main:‚úÖ New Features: Cache + WebSocket + ML + Coaching registered
INFO:main:‚úÖ API v2 router registered
INFO:main:‚úÖ FASE 2C: Route Optimization Engine loaded
INFO:main:‚úÖ Prometheus metrics enabled
INFO:main:‚úÖ Rate limiting middleware enabled
INFO:main:‚úÖ GZip compression middleware enabled
INFO:main:‚úÖ CORS configured with 5 allowed origins
INFO:main:‚úÖ Global exception handler registered
INFO:routers:‚úÖ Registered api_v2 router at /fuelAnalytics/api/v2
INFO:routers:‚úÖ Registered command_center router at /fuelAnalytics/api/command-center
INFO:main:‚úÖ All routers included successfully
INFO:routers_v3:‚úÖ Registered api_v2 router at /fuelAnalytics/api/v2
INFO:routers_v3:‚úÖ Registered sse_endpoints router
INFO:routers_v3:‚úÖ Registered fuel_stations router
INFO:routers_v3:‚úÖ Registered sensor_health_router
INFO:routers_v3:‚úÖ Registered mpg_baseline_router
INFO:routers_v3:‚úÖ Registered driver_alerts_router at /fuelAnalytics/api/v2/driver-alerts
INFO:routers_v3:üöÄ v3.12.21 routers registration complete
INFO:main:‚úÖ v3.12.21 API v2 router registered
INFO:v5_endpoints:‚úÖ V5 Endpoints registered (Fleet Analytics + Leaderboard)
INFO:main:‚úÖ V5 Clean Endpoints registered (Fleet Analytics, Leaderboard)
INFO:main:üöÄ v5.2: Using new lightweight v5 endpoints (TruckHealthMonitor disabled)
INFO:     Started server process [30580]
INFO:     Waiting for application startup.
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üöÄ Fuel Copilot API v3.12.0 STARTING...
INFO:lifecycle_manager:üìÖ Startup Time: 2025-12-28T18:10:48.393535
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üîÑ Initializing multi-layer cache...
INFO:lifecycle_manager:‚úÖ Multi-layer cache connected successfully
INFO:lifecycle_manager:üîÑ Initializing async database pool...
INFO:database_async:üîÑ Creating async MySQL connection pool...
INFO:database_async:   Host: localhost:3306
INFO:database_async:   Database: fuel_copilot_local
INFO:database_async:   Pool size: 5-20
INFO:database_async:‚úÖ Async MySQL connection pool created successfully
INFO:lifecycle_manager:‚úÖ Async DB pool initialized successfully
INFO:database_mysql:‚úÖ SQLAlchemy engine created with connection pooling (10+5 connections)
INFO:database:‚úÖ Found 22 trucks in MySQL
INFO:lifecycle_manager:Available trucks: 22
INFO:lifecycle_manager:MySQL enhanced features: enabled
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:‚úÖ API ready for connections
INFO:lifecycle_manager:================================================================================
INFO:     Application startup complete.
‚ö†Ô∏è MYSQL_PASSWORD not set - database connections will fail
‚ö†Ô∏è LOCAL_DB_PASS not set - local database connections will fail
‚ö†Ô∏è  Redis cache unavailable: No module named 'redis_cache'
/opt/anaconda3/lib/python3.12/site-packages/keras/src/export/tf2onnx_lib.py:8: FutureWarning: In the future `np.object` will be defined as the corresponding NumPy scalar.
  if not hasattr(np, "object"):
‚ö†Ô∏è MPG History router not available: No module named 'logger_config'
INFO:main:‚úÖ Driver Alerts router registered
INFO:main:‚úÖ Alerts router registered
INFO:main:‚úÖ Trucks router registered
INFO:main:‚úÖ Refuels router registered
INFO:main:‚úÖ Analytics router registered
INFO:main:‚úÖ Maintenance router registered
INFO:ekf_integration:‚úÖ EKFManager inicializado en data/ekf_states
INFO:main:‚úÖ FASE 2A: EKF Integration & Diagnostics endpoints registered
INFO:main:‚úÖ FASE 2B: ML Pipeline (LSTM + Anomaly Detection + Driver Scoring) loaded
INFO:kafka_event_bus:‚úÖ Event Bus inicializado
INFO:kafka_event_bus:‚úÖ Event Bus suscriptores inicializados
INFO:main:‚úÖ FASE 2C: Event Bus & Microservices Orchestrator loaded
INFO:main:‚úÖ New Features: Cache + WebSocket + ML + Coaching registered
INFO:main:‚úÖ API v2 router registered
INFO:main:‚úÖ FASE 2C: Route Optimization Engine loaded
INFO:main:‚úÖ Prometheus metrics enabled
INFO:main:‚úÖ Rate limiting middleware enabled
INFO:main:‚úÖ GZip compression middleware enabled
INFO:main:‚úÖ CORS configured with 5 allowed origins
INFO:main:‚úÖ Global exception handler registered
INFO:routers:‚úÖ Registered api_v2 router at /fuelAnalytics/api/v2
INFO:routers:‚úÖ Registered command_center router at /fuelAnalytics/api/command-center
INFO:main:‚úÖ All routers included successfully
INFO:routers_v3:‚úÖ Registered api_v2 router at /fuelAnalytics/api/v2
INFO:routers_v3:‚úÖ Registered sse_endpoints router
INFO:routers_v3:‚úÖ Registered fuel_stations router
INFO:routers_v3:‚úÖ Registered sensor_health_router
INFO:routers_v3:‚úÖ Registered mpg_baseline_router
INFO:routers_v3:‚úÖ Registered driver_alerts_router at /fuelAnalytics/api/v2/driver-alerts
INFO:routers_v3:üöÄ v3.12.21 routers registration complete
INFO:main:‚úÖ v3.12.21 API v2 router registered
INFO:v5_endpoints:‚úÖ V5 Endpoints registered (Fleet Analytics + Leaderboard)
INFO:main:‚úÖ V5 Clean Endpoints registered (Fleet Analytics, Leaderboard)
INFO:main:üöÄ v5.2: Using new lightweight v5 endpoints (TruckHealthMonitor disabled)
INFO:     Started server process [32767]
INFO:     Waiting for application startup.
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üöÄ Fuel Copilot API v3.12.0 STARTING...
INFO:lifecycle_manager:üìÖ Startup Time: 2025-12-28T18:10:51.676851
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üîÑ Initializing multi-layer cache...
INFO:lifecycle_manager:‚úÖ Multi-layer cache connected successfully
INFO:lifecycle_manager:üîÑ Initializing async database pool...
INFO:database_async:üîÑ Creating async MySQL connection pool...
INFO:database_async:   Host: localhost:3306
INFO:database_async:   Database: fuel_copilot_local
INFO:database_async:   Pool size: 5-20
INFO:database_async:‚úÖ Async MySQL connection pool created successfully
INFO:lifecycle_manager:‚úÖ Async DB pool initialized successfully
INFO:database_mysql:‚úÖ SQLAlchemy engine created with connection pooling (10+5 connections)
INFO:database:‚úÖ Found 22 trucks in MySQL
INFO:lifecycle_manager:Available trucks: 22
INFO:lifecycle_manager:MySQL enhanced features: enabled
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:‚úÖ API ready for connections
INFO:lifecycle_manager:================================================================================
INFO:     Application startup complete.
INFO:database:‚úÖ Found 22 trucks in MySQL
INFO:config:‚úÖ Loaded 45 trucks from tanks.yaml
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=9.6, estimated_pct(row[35])=9.57
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 9.6
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
INFO:bulk_mysql_handler:üöÄ Bulk MySQL Handler initialized (batch_size=20, auto_flush=30.0s)
‚úÖ SPN Decoder initialized with 111 SPNs
‚úÖ SPN Decoder initialized with 111 SPNs
INFO:     127.0.0.1:55956 - "GET /fuelAnalytics/api/health HTTP/1.1" 200 OK
INFO:routers.auth_router:üîç Login endpoint received: username='admin', password_length=14
INFO:routers.auth_router:   Password first 10 chars: 'FuelAdmin2'
INFO:routers.auth_router:   Password last 4 chars: '025!'
INFO:auth:üîç Login attempt: username='admin', password_length=14
INFO:auth:üîç Verifying password for 'admin'...
INFO:auth:   Password received: 'FuelAdmin2'... (first 10 chars)
INFO:auth:   Password hash: $2b$12$x3W1/rtu8LRjbiDZ9q.YReVVCmy/Rdk0/ZmDCs0UAXc2bnJh2Sfka...
INFO:auth:   Password verification result: True
INFO:auth:‚úÖ Login successful: admin (carrier: *, role: super_admin)
INFO:     127.0.0.1:55982 - "POST /fuelAnalytics/api/auth/login HTTP/1.1" 200 OK
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 9.6
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
WARNING:main:üîç DEBUG: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
WARNING:main:üîç DEBUG: sensor_pct value: 9.6
INFO:     127.0.0.1:55982 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:     127.0.0.1:55982 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:11:13 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:55990 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:11:17 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:55997 - "GET /fuelAnalytics/api/v2/fleet/patterns HTTP/1.1" 200 OK
INFO:cache_service:‚úÖ Redis connected: redis://localhost:6379/0
WARNING:api_endpoints_async:Error analyzing oil_pump for CO0681: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for CO0681: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for CO0681: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for DO9356: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for DO9356: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for DO9356: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for DO9693: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for DO9693: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for DO9693: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for DR6664: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for DR6664: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for DR6664: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for FM3363: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for FM3363: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for GP9677: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for GP9677: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for GS5030: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for GS5030: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for JB6858: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for JB6858: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for JB6858: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for JC1282: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for JC1282: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for JC1282: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for JP3281: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for JP3281: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for JP3281: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for JR7099: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for JR7099: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for LC6799: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for LC6799: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for LC6799: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for LH1141: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for LH1141: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for MJ9547: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for MJ9547: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for MJ9547: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for MR7679: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for MR7679: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for OM7769: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for OM7769: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for RA9250: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for RA9250: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for RC6625: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for RC6625: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for RH1522: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for RH1522: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for RR1272: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for RR1272: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for RT9127: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for RT9127: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for RT9127: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for SG5760: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for SG5760: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for SG5760: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
INFO:     127.0.0.1:56001 - "GET /fuelAnalytics/api/predictive-maintenance HTTP/1.1" 200 OK
INFO:     127.0.0.1:56001 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:database_mysql:‚úÖ KPIs calculated from MySQL: 22 trucks, 2452 records, 1d period
INFO:     127.0.0.1:56001 - "GET /fuelAnalytics/api/kpis HTTP/1.1" 200 OK
INFO:database:‚úÖ Found 22 trucks in MySQL
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for CO0681
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for DO9356
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for DO9693
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for DR6664
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for FF7702
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for FM3363
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for GP9677
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for JB6858
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for JC1282
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for JP3281
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for JR7099
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for LC6799
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for MJ9547
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for MO0195
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for MR7679
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for OM7769
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for PC1280
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for RH1522
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for RR1272
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for RT9127
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for SG5760
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for VD3579
INFO:     127.0.0.1:56001 - "GET /fuelAnalytics/api/alerts HTTP/1.1" 200 OK
INFO:     127.0.0.1:56004 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:     127.0.0.1:56009 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:11:43 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:56012 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=9.6, estimated_pct(row[35])=9.58
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 9.6
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
WARNING:main:üîç DEBUG: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
WARNING:main:üîç DEBUG: sensor_pct value: 9.6
INFO:     127.0.0.1:56018 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:     127.0.0.1:56020 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:12:13 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:56023 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:     127.0.0.1:56031 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=9.6, estimated_pct(row[35])=9.58
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 9.6
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
WARNING:main:üîç DEBUG: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
WARNING:main:üîç DEBUG: sensor_pct value: 9.6
INFO:     127.0.0.1:56033 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:12:43 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:56036 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:     127.0.0.1:56041 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:     127.0.0.1:56043 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:13:13 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:56046 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:13:17 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:56052 - "GET /fuelAnalytics/api/v2/fleet/patterns HTTP/1.1" 200 OK
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=9.6, estimated_pct(row[35])=9.54
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 9.6
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
WARNING:main:üîç DEBUG: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
WARNING:main:üîç DEBUG: sensor_pct value: 9.6
INFO:     127.0.0.1:56056 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:     127.0.0.1:56059 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:13:43 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:56062 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:     127.0.0.1:56068 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=9.6, estimated_pct(row[35])=9.54
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 9.6
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
WARNING:main:üîç DEBUG: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
WARNING:main:üîç DEBUG: sensor_pct value: 9.6
INFO:     127.0.0.1:56073 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:14:13 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:56076 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:     127.0.0.1:56085 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:     127.0.0.1:56103 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:14:43 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:56106 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=9.6, estimated_pct(row[35])=9.54
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 9.6
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
WARNING:main:üîç DEBUG: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
WARNING:main:üîç DEBUG: sensor_pct value: 9.6
INFO:     127.0.0.1:56142 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:     127.0.0.1:56158 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:15:13 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:56161 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:15:17 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:56167 - "GET /fuelAnalytics/api/v2/fleet/patterns HTTP/1.1" 200 OK
INFO:     127.0.0.1:56175 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=9.6, estimated_pct(row[35])=9.54
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 9.6
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
WARNING:main:üîç DEBUG: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
WARNING:main:üîç DEBUG: sensor_pct value: 9.6
INFO:     127.0.0.1:56186 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:15:43 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:56189 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:     127.0.0.1:56360 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:     127.0.0.1:56514 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:16:13 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:56517 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:     127.0.0.1:56514 - "GET /fuelAnalytics/api/predictive-maintenance HTTP/1.1" 200 OK
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=9.6, estimated_pct(row[35])=9.54
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 9.6
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
WARNING:main:üîç DEBUG: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
WARNING:main:üîç DEBUG: sensor_pct value: 9.6
INFO:     127.0.0.1:56802 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:     127.0.0.1:56836 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:16:43 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:56839 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:     127.0.0.1:56925 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=9.6, estimated_pct(row[35])=9.54
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 9.6
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
WARNING:main:üîç DEBUG: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
WARNING:main:üîç DEBUG: sensor_pct value: 9.6
INFO:     127.0.0.1:56950 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:17:13 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:56953 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:17:17 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:56962 - "GET /fuelAnalytics/api/v2/fleet/patterns HTTP/1.1" 200 OK
INFO:     127.0.0.1:56972 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:     127.0.0.1:56989 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:17:43 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:56992 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=9.6, estimated_pct(row[35])=9.55
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 9.6
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
WARNING:main:üîç DEBUG: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
WARNING:main:üîç DEBUG: sensor_pct value: 9.6
INFO:     127.0.0.1:56999 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:     127.0.0.1:57001 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:18:13 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:57004 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:     127.0.0.1:57014 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=9.6, estimated_pct(row[35])=9.55
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 9.6
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
WARNING:main:üîç DEBUG: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
WARNING:main:üîç DEBUG: sensor_pct value: 9.6
INFO:     127.0.0.1:57123 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:18:43 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:57126 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:     127.0.0.1:57165 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:     127.0.0.1:57167 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:19:13 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:57170 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:19:17 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:57176 - "GET /fuelAnalytics/api/v2/fleet/patterns HTTP/1.1" 200 OK
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=9.6, estimated_pct(row[35])=9.55
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 9.6
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
WARNING:main:üîç DEBUG: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
WARNING:main:üîç DEBUG: sensor_pct value: 9.6
INFO:     127.0.0.1:57191 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:     127.0.0.1:57210 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:19:43 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:57213 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:     127.0.0.1:57218 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=9.6, estimated_pct(row[35])=9.55
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 9.6
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
WARNING:main:üîç DEBUG: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
WARNING:main:üîç DEBUG: sensor_pct value: 9.6
INFO:     127.0.0.1:57222 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:20:13 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:57225 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:     127.0.0.1:57232 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:     127.0.0.1:57234 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:20:43 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:57237 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=9.6, estimated_pct(row[35])=9.55
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 9.6
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
WARNING:main:üîç DEBUG: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
WARNING:main:üîç DEBUG: sensor_pct value: 9.6
INFO:     127.0.0.1:57242 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:     127.0.0.1:57244 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:21:13 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:57247 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:21:17 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:57255 - "GET /fuelAnalytics/api/v2/fleet/patterns HTTP/1.1" 200 OK
WARNING:api_endpoints_async:Error analyzing oil_pump for CO0681: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for CO0681: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for CO0681: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for DO9356: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for DO9356: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for DO9356: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for DO9693: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for DO9693: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for DO9693: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for DR6664: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for DR6664: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for DR6664: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for FM3363: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for FM3363: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for GP9677: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for GP9677: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for GS5030: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for GS5030: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for JB6858: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for JB6858: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for JB6858: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for JC1282: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for JC1282: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for JC1282: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for JP3281: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for JP3281: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for JP3281: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for JR7099: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for JR7099: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for LC6799: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for LC6799: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for LC6799: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for LH1141: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for LH1141: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for MJ9547: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for MJ9547: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for MJ9547: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for MR7679: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for MR7679: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for OM7769: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for OM7769: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for RA9250: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for RA9250: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for RC6625: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for RC6625: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for RH1522: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for RH1522: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for RR1272: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for RR1272: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for RT9127: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for RT9127: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for RT9127: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for SG5760: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for SG5760: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for SG5760: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
INFO:     127.0.0.1:57259 - "GET /fuelAnalytics/api/predictive-maintenance HTTP/1.1" 200 OK
INFO:     127.0.0.1:57264 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:     127.0.0.1:57273 - "GET /fuelAnalytics/api/auth/me HTTP/1.1" 401 Unauthorized
INFO:     127.0.0.1:57273 - "OPTIONS /fuelAnalytics/api/auth/login HTTP/1.1" 200 OK
INFO:routers.auth_router:üîç Login endpoint received: username='admin', password_length=14
INFO:routers.auth_router:   Password first 10 chars: 'FuelAdmin2'
INFO:routers.auth_router:   Password last 4 chars: '025!'
INFO:auth:üîç Login attempt: username='admin', password_length=14
INFO:auth:üîç Verifying password for 'admin'...
INFO:auth:   Password received: 'FuelAdmin2'... (first 10 chars)
INFO:auth:   Password hash: $2b$12$x3W1/rtu8LRjbiDZ9q.YReVVCmy/Rdk0/ZmDCs0UAXc2bnJh2Sfka...
INFO:auth:   Password verification result: True
INFO:auth:‚úÖ Login successful: admin (carrier: *, role: super_admin)
INFO:     127.0.0.1:57273 - "POST /fuelAnalytics/api/auth/login HTTP/1.1" 200 OK
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=9.6, estimated_pct(row[35])=9.55
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 9.6
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
WARNING:main:üîç DEBUG: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
WARNING:main:üîç DEBUG: sensor_pct value: 9.6
INFO:     127.0.0.1:57273 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:     127.0.0.1:57273 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:21:42 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:57278 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:21:47 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:57283 - "GET /fuelAnalytics/api/v2/fleet/patterns HTTP/1.1" 200 OK
INFO:     127.0.0.1:57276 - "GET /fuelAnalytics/api/predictive-maintenance HTTP/1.1" 200 OK
INFO:     127.0.0.1:57276 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:database_mysql:‚úÖ KPIs calculated from MySQL: 22 trucks, 2466 records, 1d period
INFO:     127.0.0.1:57276 - "GET /fuelAnalytics/api/kpis HTTP/1.1" 200 OK
INFO:database:‚úÖ Found 22 trucks in MySQL
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for CO0681
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for DO9356
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for DO9693
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for DR6664
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for FF7702
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for FM3363
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for GP9677
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for JB6858
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for JC1282
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for JP3281
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for JR7099
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for LC6799
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for MJ9547
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for MO0195
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for MR7679
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for OM7769
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for PC1280
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for RH1522
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for RR1272
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for RT9127
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for SG5760
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for VD3579
INFO:     127.0.0.1:57276 - "GET /fuelAnalytics/api/alerts HTTP/1.1" 200 OK
INFO:     127.0.0.1:57287 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:     127.0.0.1:57289 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:22:12 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:57291 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=9.6, estimated_pct(row[35])=9.55
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 9.6
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
WARNING:main:üîç DEBUG: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
WARNING:main:üîç DEBUG: sensor_pct value: 9.6
INFO:     127.0.0.1:57299 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:     127.0.0.1:57301 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:22:42 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:57304 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:     127.0.0.1:57309 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=9.6, estimated_pct(row[35])=9.51
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 9.6
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
WARNING:main:üîç DEBUG: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
WARNING:main:üîç DEBUG: sensor_pct value: 9.6
INFO:     127.0.0.1:57311 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:23:12 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:57314 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:     127.0.0.1:57320 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:     127.0.0.1:57322 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:23:42 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:57325 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:23:46 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:57331 - "GET /fuelAnalytics/api/v2/fleet/patterns HTTP/1.1" 200 OK
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=9.6, estimated_pct(row[35])=9.51
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 9.6
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
WARNING:main:üîç DEBUG: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
WARNING:main:üîç DEBUG: sensor_pct value: 9.6
INFO:     127.0.0.1:57335 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:     127.0.0.1:57338 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:24:12 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:57341 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:     127.0.0.1:57357 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=9.6, estimated_pct(row[35])=9.51
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 9.6
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
WARNING:main:üîç DEBUG: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
WARNING:main:üîç DEBUG: sensor_pct value: 9.6
INFO:     127.0.0.1:57359 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:24:42 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:57362 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:     127.0.0.1:57403 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:     127.0.0.1:57418 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:25:12 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:57421 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=9.6, estimated_pct(row[35])=9.52
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 9.6
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
WARNING:main:üîç DEBUG: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
WARNING:main:üîç DEBUG: sensor_pct value: 9.6
INFO:     127.0.0.1:57432 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:     127.0.0.1:57436 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:25:42 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:57439 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:25:46 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:57453 - "GET /fuelAnalytics/api/v2/fleet/patterns HTTP/1.1" 200 OK
INFO:     127.0.0.1:57458 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=9.6, estimated_pct(row[35])=9.52
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 9.6
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:26:12 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
WARNING:main:üîç DEBUG: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
WARNING:main:üîç DEBUG: sensor_pct value: 9.6
INFO:     127.0.0.1:57465 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:     127.0.0.1:57462 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:     127.0.0.1:57470 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:     127.0.0.1:57472 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:26:42 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:57475 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
WARNING:api_endpoints_async:Error analyzing oil_pump for CO0681: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for CO0681: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for CO0681: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for DO9356: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for DO9356: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for DO9356: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for DO9693: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for DO9693: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for DO9693: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for DR6664: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for DR6664: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for DR6664: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for FM3363: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for FM3363: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for GP9677: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for GP9677: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for GS5030: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for GS5030: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for JB6858: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for JB6858: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for JB6858: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for JC1282: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for JC1282: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for JC1282: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for JP3281: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for JP3281: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for JP3281: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for JR7099: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for JR7099: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for LC6799: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for LC6799: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for LC6799: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for LH1141: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for LH1141: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for MJ9547: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for MJ9547: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for MJ9547: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for MR7679: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for MR7679: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for OM7769: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for OM7769: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for RA9250: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for RA9250: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for RC6625: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for RC6625: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for RH1522: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for RH1522: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for RR1272: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for RR1272: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for RT9127: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for RT9127: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for RT9127: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for SG5760: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for SG5760: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for SG5760: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
INFO:     127.0.0.1:57472 - "GET /fuelAnalytics/api/predictive-maintenance HTTP/1.1" 200 OK
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=8.8, estimated_pct(row[35])=9.51
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 8.8
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
WARNING:main:üîç DEBUG: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
WARNING:main:üîç DEBUG: sensor_pct value: 8.8
INFO:     127.0.0.1:57483 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:     127.0.0.1:57487 - "OPTIONS /fuelAnalytics/api/auth/login HTTP/1.1" 200 OK
INFO:routers.auth_router:üîç Login endpoint received: username='admin', password_length=14
INFO:routers.auth_router:   Password first 10 chars: 'FuelAdmin2'
INFO:routers.auth_router:   Password last 4 chars: '025!'
INFO:auth:üîç Login attempt: username='admin', password_length=14
INFO:auth:üîç Verifying password for 'admin'...
INFO:auth:   Password received: 'FuelAdmin2'... (first 10 chars)
INFO:auth:   Password hash: $2b$12$x3W1/rtu8LRjbiDZ9q.YReVVCmy/Rdk0/ZmDCs0UAXc2bnJh2Sfka...
INFO:auth:   Password verification result: True
INFO:auth:‚úÖ Login successful: admin (carrier: *, role: super_admin)
INFO:     127.0.0.1:57487 - "POST /fuelAnalytics/api/auth/login HTTP/1.1" 200 OK
INFO:     127.0.0.1:57487 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:27:06 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:57495 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:27:10 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:57502 - "GET /fuelAnalytics/api/v2/fleet/patterns HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:27:15 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:57505 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:     127.0.0.1:57508 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:     127.0.0.1:57512 - "GET /fuelAnalytics/api/predictive-maintenance HTTP/1.1" 200 OK
INFO:     127.0.0.1:57512 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:database_mysql:‚úÖ KPIs calculated from MySQL: 22 trucks, 2466 records, 1d period
INFO:     127.0.0.1:57512 - "GET /fuelAnalytics/api/kpis HTTP/1.1" 200 OK
INFO:database:‚úÖ Found 22 trucks in MySQL
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for CO0681
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for DO9356
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for DO9693
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for DR6664
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for FF7702
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for FM3363
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for GP9677
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for JB6858
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for JC1282
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for JP3281
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for JR7099
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for LC6799
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for MJ9547
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for MO0195
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for MR7679
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for OM7769
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for PC1280
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for RH1522
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for RR1272
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for RT9127
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for SG5760
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for VD3579
INFO:     127.0.0.1:57512 - "GET /fuelAnalytics/api/alerts HTTP/1.1" 200 OK
INFO:     127.0.0.1:57512 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:     127.0.0.1:57518 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:27:36 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:57523 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=8.8, estimated_pct(row[35])=9.5
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 8.8
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
WARNING:main:üîç DEBUG: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
WARNING:main:üîç DEBUG: sensor_pct value: 8.8
INFO:     127.0.0.1:57525 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:     127.0.0.1:57530 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:27:42 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:57533 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:27:46 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:57539 - "GET /fuelAnalytics/api/v2/fleet/patterns HTTP/1.1" 200 OK
INFO:     127.0.0.1:57545 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:     127.0.0.1:57549 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:28:06 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:57552 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:     127.0.0.1:57555 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=8.8, estimated_pct(row[35])=9.5
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 8.8
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
WARNING:main:üîç DEBUG: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
WARNING:main:üîç DEBUG: sensor_pct value: 8.8
INFO:     127.0.0.1:57559 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:28:12 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:57562 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:     127.0.0.1:57568 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:     127.0.0.1:57572 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:28:42 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:57575 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=8.8, estimated_pct(row[35])=9.49
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 8.8
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
WARNING:main:üîç DEBUG: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
WARNING:main:üîç DEBUG: sensor_pct value: 8.8
INFO:     127.0.0.1:57582 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:     127.0.0.1:57586 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:29:12 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:57589 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:     127.0.0.1:57598 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:29:42 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=10.0, estimated_pct(row[35])=9.33
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 10.0
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
WARNING:main:üîç DEBUG: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
WARNING:main:üîç DEBUG: sensor_pct value: 10.0
INFO:     127.0.0.1:57607 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:     127.0.0.1:57604 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:29:52 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:57615 - "GET /fuelAnalytics/api/v2/fleet/patterns HTTP/1.1" 200 OK
INFO:     127.0.0.1:57622 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:     127.0.0.1:57624 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:30:12 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:57627 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
WARNING:  WatchFiles detected changes in 'tests/test_predictive_90pct_part1.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üõë Shutting down Fuel Copilot API
INFO:lifecycle_manager:üìÖ Shutdown Time: 2025-12-28T18:30:22.868166
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üîÑ Disconnecting cache...
INFO:lifecycle_manager:‚úÖ Cache disconnected
INFO:lifecycle_manager:üîÑ Closing async database pool...
INFO:database_async:üîÑ Closing async MySQL connection pool...
INFO:database_async:‚úÖ Async MySQL connection pool closed
INFO:lifecycle_manager:‚úÖ Async DB pool closed
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:‚úÖ Clean shutdown completed
INFO:lifecycle_manager:================================================================================
INFO:     Application shutdown complete.
INFO:     Finished server process [32767]
‚ö†Ô∏è MYSQL_PASSWORD not set - database connections will fail
‚ö†Ô∏è LOCAL_DB_PASS not set - local database connections will fail
‚ö†Ô∏è  Redis cache unavailable: No module named 'redis_cache'
WARNING:  WatchFiles detected changes in 'tests/test_predictive_90pct_part1.py'. Reloading...
/opt/anaconda3/lib/python3.12/site-packages/keras/src/export/tf2onnx_lib.py:8: FutureWarning: In the future `np.object` will be defined as the corresponding NumPy scalar.
  if not hasattr(np, "object"):
‚ö†Ô∏è MPG History router not available: No module named 'logger_config'
INFO:main:‚úÖ Driver Alerts router registered
INFO:main:‚úÖ Alerts router registered
INFO:main:‚úÖ Trucks router registered
INFO:main:‚úÖ Refuels router registered
INFO:main:‚úÖ Analytics router registered
INFO:main:‚úÖ Maintenance router registered
INFO:ekf_integration:‚úÖ EKFManager inicializado en data/ekf_states
INFO:main:‚úÖ FASE 2A: EKF Integration & Diagnostics endpoints registered
INFO:main:‚úÖ FASE 2B: ML Pipeline (LSTM + Anomaly Detection + Driver Scoring) loaded
INFO:kafka_event_bus:‚úÖ Event Bus inicializado
INFO:kafka_event_bus:‚úÖ Event Bus suscriptores inicializados
INFO:main:‚úÖ FASE 2C: Event Bus & Microservices Orchestrator loaded
INFO:main:‚úÖ New Features: Cache + WebSocket + ML + Coaching registered
INFO:main:‚úÖ API v2 router registered
INFO:main:‚úÖ FASE 2C: Route Optimization Engine loaded
INFO:main:‚úÖ Prometheus metrics enabled
INFO:main:‚úÖ Rate limiting middleware enabled
INFO:main:‚úÖ GZip compression middleware enabled
INFO:main:‚úÖ CORS configured with 5 allowed origins
INFO:main:‚úÖ Global exception handler registered
INFO:routers:‚úÖ Registered api_v2 router at /fuelAnalytics/api/v2
INFO:routers:‚úÖ Registered command_center router at /fuelAnalytics/api/command-center
INFO:main:‚úÖ All routers included successfully
INFO:routers_v3:‚úÖ Registered api_v2 router at /fuelAnalytics/api/v2
INFO:routers_v3:‚úÖ Registered sse_endpoints router
INFO:routers_v3:‚úÖ Registered fuel_stations router
INFO:routers_v3:‚úÖ Registered sensor_health_router
INFO:routers_v3:‚úÖ Registered mpg_baseline_router
INFO:routers_v3:‚úÖ Registered driver_alerts_router at /fuelAnalytics/api/v2/driver-alerts
INFO:routers_v3:üöÄ v3.12.21 routers registration complete
INFO:main:‚úÖ v3.12.21 API v2 router registered
INFO:v5_endpoints:‚úÖ V5 Endpoints registered (Fleet Analytics + Leaderboard)
INFO:main:‚úÖ V5 Clean Endpoints registered (Fleet Analytics, Leaderboard)
INFO:main:üöÄ v5.2: Using new lightweight v5 endpoints (TruckHealthMonitor disabled)
INFO:     Started server process [51625]
INFO:     Waiting for application startup.
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üöÄ Fuel Copilot API v3.12.0 STARTING...
INFO:lifecycle_manager:üìÖ Startup Time: 2025-12-28T18:30:27.381093
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üîÑ Initializing multi-layer cache...
INFO:lifecycle_manager:‚úÖ Multi-layer cache connected successfully
INFO:lifecycle_manager:üîÑ Initializing async database pool...
INFO:database_async:üîÑ Creating async MySQL connection pool...
INFO:database_async:   Host: localhost:3306
INFO:database_async:   Database: fuel_copilot_local
INFO:database_async:   Pool size: 5-20
INFO:database_async:‚úÖ Async MySQL connection pool created successfully
INFO:lifecycle_manager:‚úÖ Async DB pool initialized successfully
INFO:database_mysql:‚úÖ SQLAlchemy engine created with connection pooling (10+5 connections)
INFO:database:‚úÖ Found 22 trucks in MySQL
INFO:lifecycle_manager:Available trucks: 22
INFO:lifecycle_manager:MySQL enhanced features: enabled
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:‚úÖ API ready for connections
INFO:lifecycle_manager:================================================================================
INFO:     Application startup complete.
‚ö†Ô∏è MYSQL_PASSWORD not set - database connections will fail
‚ö†Ô∏è LOCAL_DB_PASS not set - local database connections will fail
‚ö†Ô∏è  Redis cache unavailable: No module named 'redis_cache'
/opt/anaconda3/lib/python3.12/site-packages/keras/src/export/tf2onnx_lib.py:8: FutureWarning: In the future `np.object` will be defined as the corresponding NumPy scalar.
  if not hasattr(np, "object"):
‚ö†Ô∏è MPG History router not available: No module named 'logger_config'
INFO:main:‚úÖ Driver Alerts router registered
INFO:main:‚úÖ Alerts router registered
INFO:main:‚úÖ Trucks router registered
INFO:main:‚úÖ Refuels router registered
INFO:main:‚úÖ Analytics router registered
INFO:main:‚úÖ Maintenance router registered
INFO:ekf_integration:‚úÖ EKFManager inicializado en data/ekf_states
INFO:main:‚úÖ FASE 2A: EKF Integration & Diagnostics endpoints registered
INFO:main:‚úÖ FASE 2B: ML Pipeline (LSTM + Anomaly Detection + Driver Scoring) loaded
INFO:kafka_event_bus:‚úÖ Event Bus inicializado
INFO:kafka_event_bus:‚úÖ Event Bus suscriptores inicializados
INFO:main:‚úÖ FASE 2C: Event Bus & Microservices Orchestrator loaded
INFO:main:‚úÖ New Features: Cache + WebSocket + ML + Coaching registered
INFO:main:‚úÖ API v2 router registered
INFO:main:‚úÖ FASE 2C: Route Optimization Engine loaded
INFO:main:‚úÖ Prometheus metrics enabled
INFO:main:‚úÖ Rate limiting middleware enabled
INFO:main:‚úÖ GZip compression middleware enabled
INFO:main:‚úÖ CORS configured with 5 allowed origins
INFO:main:‚úÖ Global exception handler registered
INFO:routers:‚úÖ Registered api_v2 router at /fuelAnalytics/api/v2
INFO:routers:‚úÖ Registered command_center router at /fuelAnalytics/api/command-center
INFO:main:‚úÖ All routers included successfully
INFO:routers_v3:‚úÖ Registered api_v2 router at /fuelAnalytics/api/v2
INFO:routers_v3:‚úÖ Registered sse_endpoints router
INFO:routers_v3:‚úÖ Registered fuel_stations router
INFO:routers_v3:‚úÖ Registered sensor_health_router
INFO:routers_v3:‚úÖ Registered mpg_baseline_router
INFO:routers_v3:‚úÖ Registered driver_alerts_router at /fuelAnalytics/api/v2/driver-alerts
INFO:routers_v3:üöÄ v3.12.21 routers registration complete
INFO:main:‚úÖ v3.12.21 API v2 router registered
INFO:v5_endpoints:‚úÖ V5 Endpoints registered (Fleet Analytics + Leaderboard)
INFO:main:‚úÖ V5 Clean Endpoints registered (Fleet Analytics, Leaderboard)
INFO:main:üöÄ v5.2: Using new lightweight v5 endpoints (TruckHealthMonitor disabled)
INFO:     Started server process [51647]
INFO:     Waiting for application startup.
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üöÄ Fuel Copilot API v3.12.0 STARTING...
INFO:lifecycle_manager:üìÖ Startup Time: 2025-12-28T18:30:30.848323
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üîÑ Initializing multi-layer cache...
INFO:lifecycle_manager:‚úÖ Multi-layer cache connected successfully
INFO:lifecycle_manager:üîÑ Initializing async database pool...
INFO:database_async:üîÑ Creating async MySQL connection pool...
INFO:database_async:   Host: localhost:3306
INFO:database_async:   Database: fuel_copilot_local
INFO:database_async:   Pool size: 5-20
INFO:database_async:‚úÖ Async MySQL connection pool created successfully
INFO:lifecycle_manager:‚úÖ Async DB pool initialized successfully
INFO:database_mysql:‚úÖ SQLAlchemy engine created with connection pooling (10+5 connections)
INFO:database:‚úÖ Found 22 trucks in MySQL
INFO:lifecycle_manager:Available trucks: 22
INFO:lifecycle_manager:MySQL enhanced features: enabled
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:‚úÖ API ready for connections
INFO:lifecycle_manager:================================================================================
INFO:     Application startup complete.
INFO:config:‚úÖ Loaded 45 trucks from tanks.yaml
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=10.0, estimated_pct(row[35])=9.34
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 10.0
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
WARNING:main:üîç DEBUG: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
WARNING:main:üîç DEBUG: sensor_pct value: 10.0
‚úÖ SPN Decoder initialized with 111 SPNs
‚úÖ SPN Decoder initialized with 111 SPNs
INFO:     127.0.0.1:57646 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:     127.0.0.1:57659 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:30:42 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:57662 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:     127.0.0.1:57667 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
WARNING:  WatchFiles detected changes in 'tests/test_predictive_90pct_part2.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üõë Shutting down Fuel Copilot API
INFO:lifecycle_manager:üìÖ Shutdown Time: 2025-12-28T18:31:06.599978
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üîÑ Disconnecting cache...
INFO:lifecycle_manager:‚úÖ Cache disconnected
INFO:lifecycle_manager:üîÑ Closing async database pool...
INFO:database_async:üîÑ Closing async MySQL connection pool...
INFO:database_async:‚úÖ Async MySQL connection pool closed
INFO:lifecycle_manager:‚úÖ Async DB pool closed
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:‚úÖ Clean shutdown completed
INFO:lifecycle_manager:================================================================================
INFO:     Application shutdown complete.
INFO:     Finished server process [51647]
‚ö†Ô∏è MYSQL_PASSWORD not set - database connections will fail
‚ö†Ô∏è LOCAL_DB_PASS not set - local database connections will fail
‚ö†Ô∏è  Redis cache unavailable: No module named 'redis_cache'
WARNING:  WatchFiles detected changes in 'tests/test_predictive_90pct_part2.py'. Reloading...
/opt/anaconda3/lib/python3.12/site-packages/keras/src/export/tf2onnx_lib.py:8: FutureWarning: In the future `np.object` will be defined as the corresponding NumPy scalar.
  if not hasattr(np, "object"):
‚ö†Ô∏è MPG History router not available: No module named 'logger_config'
INFO:main:‚úÖ Driver Alerts router registered
INFO:main:‚úÖ Alerts router registered
INFO:main:‚úÖ Trucks router registered
INFO:main:‚úÖ Refuels router registered
INFO:main:‚úÖ Analytics router registered
INFO:main:‚úÖ Maintenance router registered
INFO:ekf_integration:‚úÖ EKFManager inicializado en data/ekf_states
INFO:main:‚úÖ FASE 2A: EKF Integration & Diagnostics endpoints registered
INFO:main:‚úÖ FASE 2B: ML Pipeline (LSTM + Anomaly Detection + Driver Scoring) loaded
INFO:kafka_event_bus:‚úÖ Event Bus inicializado
INFO:kafka_event_bus:‚úÖ Event Bus suscriptores inicializados
INFO:main:‚úÖ FASE 2C: Event Bus & Microservices Orchestrator loaded
INFO:main:‚úÖ New Features: Cache + WebSocket + ML + Coaching registered
INFO:main:‚úÖ API v2 router registered
INFO:main:‚úÖ FASE 2C: Route Optimization Engine loaded
INFO:main:‚úÖ Prometheus metrics enabled
INFO:main:‚úÖ Rate limiting middleware enabled
INFO:main:‚úÖ GZip compression middleware enabled
INFO:main:‚úÖ CORS configured with 5 allowed origins
INFO:main:‚úÖ Global exception handler registered
INFO:routers:‚úÖ Registered api_v2 router at /fuelAnalytics/api/v2
INFO:routers:‚úÖ Registered command_center router at /fuelAnalytics/api/command-center
INFO:main:‚úÖ All routers included successfully
INFO:routers_v3:‚úÖ Registered api_v2 router at /fuelAnalytics/api/v2
INFO:routers_v3:‚úÖ Registered sse_endpoints router
INFO:routers_v3:‚úÖ Registered fuel_stations router
INFO:routers_v3:‚úÖ Registered sensor_health_router
INFO:routers_v3:‚úÖ Registered mpg_baseline_router
INFO:routers_v3:‚úÖ Registered driver_alerts_router at /fuelAnalytics/api/v2/driver-alerts
INFO:routers_v3:üöÄ v3.12.21 routers registration complete
INFO:main:‚úÖ v3.12.21 API v2 router registered
INFO:v5_endpoints:‚úÖ V5 Endpoints registered (Fleet Analytics + Leaderboard)
INFO:main:‚úÖ V5 Clean Endpoints registered (Fleet Analytics, Leaderboard)
INFO:main:üöÄ v5.2: Using new lightweight v5 endpoints (TruckHealthMonitor disabled)
INFO:     Started server process [51767]
INFO:     Waiting for application startup.
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üöÄ Fuel Copilot API v3.12.0 STARTING...
INFO:lifecycle_manager:üìÖ Startup Time: 2025-12-28T18:31:10.300158
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üîÑ Initializing multi-layer cache...
INFO:lifecycle_manager:‚úÖ Multi-layer cache connected successfully
INFO:lifecycle_manager:üîÑ Initializing async database pool...
INFO:database_async:üîÑ Creating async MySQL connection pool...
INFO:database_async:   Host: localhost:3306
INFO:database_async:   Database: fuel_copilot_local
INFO:database_async:   Pool size: 5-20
INFO:database_async:‚úÖ Async MySQL connection pool created successfully
INFO:lifecycle_manager:‚úÖ Async DB pool initialized successfully
INFO:database_mysql:‚úÖ SQLAlchemy engine created with connection pooling (10+5 connections)
INFO:database:‚úÖ Found 22 trucks in MySQL
INFO:lifecycle_manager:Available trucks: 22
INFO:lifecycle_manager:MySQL enhanced features: enabled
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:‚úÖ API ready for connections
INFO:lifecycle_manager:================================================================================
INFO:     Application startup complete.
‚ö†Ô∏è MYSQL_PASSWORD not set - database connections will fail
‚ö†Ô∏è LOCAL_DB_PASS not set - local database connections will fail
‚ö†Ô∏è  Redis cache unavailable: No module named 'redis_cache'
/opt/anaconda3/lib/python3.12/site-packages/keras/src/export/tf2onnx_lib.py:8: FutureWarning: In the future `np.object` will be defined as the corresponding NumPy scalar.
  if not hasattr(np, "object"):
‚ö†Ô∏è MPG History router not available: No module named 'logger_config'
INFO:main:‚úÖ Driver Alerts router registered
INFO:main:‚úÖ Alerts router registered
INFO:main:‚úÖ Trucks router registered
INFO:main:‚úÖ Refuels router registered
INFO:main:‚úÖ Analytics router registered
INFO:main:‚úÖ Maintenance router registered
INFO:ekf_integration:‚úÖ EKFManager inicializado en data/ekf_states
INFO:main:‚úÖ FASE 2A: EKF Integration & Diagnostics endpoints registered
INFO:main:‚úÖ FASE 2B: ML Pipeline (LSTM + Anomaly Detection + Driver Scoring) loaded
INFO:kafka_event_bus:‚úÖ Event Bus inicializado
INFO:kafka_event_bus:‚úÖ Event Bus suscriptores inicializados
INFO:main:‚úÖ FASE 2C: Event Bus & Microservices Orchestrator loaded
INFO:main:‚úÖ New Features: Cache + WebSocket + ML + Coaching registered
INFO:main:‚úÖ API v2 router registered
INFO:main:‚úÖ FASE 2C: Route Optimization Engine loaded
INFO:main:‚úÖ Prometheus metrics enabled
INFO:main:‚úÖ Rate limiting middleware enabled
INFO:main:‚úÖ GZip compression middleware enabled
INFO:main:‚úÖ CORS configured with 5 allowed origins
INFO:main:‚úÖ Global exception handler registered
INFO:routers:‚úÖ Registered api_v2 router at /fuelAnalytics/api/v2
INFO:routers:‚úÖ Registered command_center router at /fuelAnalytics/api/command-center
INFO:main:‚úÖ All routers included successfully
INFO:routers_v3:‚úÖ Registered api_v2 router at /fuelAnalytics/api/v2
INFO:routers_v3:‚úÖ Registered sse_endpoints router
INFO:routers_v3:‚úÖ Registered fuel_stations router
INFO:routers_v3:‚úÖ Registered sensor_health_router
INFO:routers_v3:‚úÖ Registered mpg_baseline_router
INFO:routers_v3:‚úÖ Registered driver_alerts_router at /fuelAnalytics/api/v2/driver-alerts
INFO:routers_v3:üöÄ v3.12.21 routers registration complete
INFO:main:‚úÖ v3.12.21 API v2 router registered
INFO:v5_endpoints:‚úÖ V5 Endpoints registered (Fleet Analytics + Leaderboard)
INFO:main:‚úÖ V5 Clean Endpoints registered (Fleet Analytics, Leaderboard)
INFO:main:üöÄ v5.2: Using new lightweight v5 endpoints (TruckHealthMonitor disabled)
INFO:     Started server process [51780]
INFO:     Waiting for application startup.
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üöÄ Fuel Copilot API v3.12.0 STARTING...
INFO:lifecycle_manager:üìÖ Startup Time: 2025-12-28T18:31:13.768023
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üîÑ Initializing multi-layer cache...
INFO:lifecycle_manager:‚úÖ Multi-layer cache connected successfully
INFO:lifecycle_manager:üîÑ Initializing async database pool...
INFO:database_async:üîÑ Creating async MySQL connection pool...
INFO:database_async:   Host: localhost:3306
INFO:database_async:   Database: fuel_copilot_local
INFO:database_async:   Pool size: 5-20
INFO:database_async:‚úÖ Async MySQL connection pool created successfully
INFO:lifecycle_manager:‚úÖ Async DB pool initialized successfully
INFO:database_mysql:‚úÖ SQLAlchemy engine created with connection pooling (10+5 connections)
INFO:database:‚úÖ Found 22 trucks in MySQL
INFO:lifecycle_manager:Available trucks: 22
INFO:lifecycle_manager:MySQL enhanced features: enabled
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:‚úÖ API ready for connections
INFO:lifecycle_manager:================================================================================
INFO:     Application startup complete.
INFO:config:‚úÖ Loaded 45 trucks from tanks.yaml
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=10.0, estimated_pct(row[35])=9.2
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
‚úÖ SPN Decoder initialized with 111 SPNs
‚úÖ SPN Decoder initialized with 111 SPNs
2025-12-28 18:31:13 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 10.0
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
WARNING:main:üîç DEBUG: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
WARNING:main:üîç DEBUG: sensor_pct value: 10.0
INFO:     127.0.0.1:57687 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:     127.0.0.1:57681 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:     127.0.0.1:57757 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:     127.0.0.1:57760 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:31:43 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:57763 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:31:47 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:57769 - "GET /fuelAnalytics/api/v2/fleet/patterns HTTP/1.1" 200 OK
INFO:cache_service:‚úÖ Redis connected: redis://localhost:6379/0
WARNING:api_endpoints_async:Error analyzing oil_pump for CO0681: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for CO0681: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for CO0681: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for DO9356: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for DO9356: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for DO9356: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for DO9693: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for DO9693: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for DO9693: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for DR6664: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for DR6664: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for DR6664: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for FM3363: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for FM3363: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for GP9677: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for GP9677: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for GS5030: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for GS5030: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for JB6858: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for JB6858: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for JB6858: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for JC1282: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for JC1282: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for JC1282: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for JP3281: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for JP3281: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for JP3281: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for JR7099: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for JR7099: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for LC6799: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for LC6799: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for LC6799: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for LH1141: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for LH1141: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for MJ9547: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for MJ9547: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for MJ9547: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for MR7679: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for MR7679: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for OM7769: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for OM7769: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for RA9250: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for RA9250: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for RC6625: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for RC6625: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for RH1522: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for RH1522: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for RR1272: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for RR1272: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for RT9127: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for RT9127: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for RT9127: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for SG5760: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for SG5760: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for SG5760: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
INFO:     127.0.0.1:57773 - "GET /fuelAnalytics/api/predictive-maintenance HTTP/1.1" 200 OK
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=10.0, estimated_pct(row[35])=9.21
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 10.0
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
WARNING:main:üîç DEBUG: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
WARNING:main:üîç DEBUG: sensor_pct value: 10.0
INFO:     127.0.0.1:57773 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
WARNING:  WatchFiles detected changes in 'tests/test_fleet_90pct_part1.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üõë Shutting down Fuel Copilot API
INFO:lifecycle_manager:üìÖ Shutdown Time: 2025-12-28T18:32:01.112574
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üîÑ Disconnecting cache...
INFO:lifecycle_manager:‚úÖ Cache disconnected
INFO:lifecycle_manager:üîÑ Closing async database pool...
INFO:database_async:üîÑ Closing async MySQL connection pool...
INFO:database_async:‚úÖ Async MySQL connection pool closed
INFO:lifecycle_manager:‚úÖ Async DB pool closed
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:‚úÖ Clean shutdown completed
INFO:lifecycle_manager:================================================================================
INFO:     Application shutdown complete.
INFO:     Finished server process [51780]
‚ö†Ô∏è MYSQL_PASSWORD not set - database connections will fail
‚ö†Ô∏è LOCAL_DB_PASS not set - local database connections will fail
‚ö†Ô∏è  Redis cache unavailable: No module named 'redis_cache'
WARNING:  WatchFiles detected changes in 'tests/test_fleet_90pct_part1.py'. Reloading...
/opt/anaconda3/lib/python3.12/site-packages/keras/src/export/tf2onnx_lib.py:8: FutureWarning: In the future `np.object` will be defined as the corresponding NumPy scalar.
  if not hasattr(np, "object"):
‚ö†Ô∏è MPG History router not available: No module named 'logger_config'
INFO:main:‚úÖ Driver Alerts router registered
INFO:main:‚úÖ Alerts router registered
INFO:main:‚úÖ Trucks router registered
INFO:main:‚úÖ Refuels router registered
INFO:main:‚úÖ Analytics router registered
INFO:main:‚úÖ Maintenance router registered
INFO:ekf_integration:‚úÖ EKFManager inicializado en data/ekf_states
INFO:main:‚úÖ FASE 2A: EKF Integration & Diagnostics endpoints registered
INFO:main:‚úÖ FASE 2B: ML Pipeline (LSTM + Anomaly Detection + Driver Scoring) loaded
INFO:kafka_event_bus:‚úÖ Event Bus inicializado
INFO:kafka_event_bus:‚úÖ Event Bus suscriptores inicializados
INFO:main:‚úÖ FASE 2C: Event Bus & Microservices Orchestrator loaded
INFO:main:‚úÖ New Features: Cache + WebSocket + ML + Coaching registered
INFO:main:‚úÖ API v2 router registered
INFO:main:‚úÖ FASE 2C: Route Optimization Engine loaded
INFO:main:‚úÖ Prometheus metrics enabled
INFO:main:‚úÖ Rate limiting middleware enabled
INFO:main:‚úÖ GZip compression middleware enabled
INFO:main:‚úÖ CORS configured with 5 allowed origins
INFO:main:‚úÖ Global exception handler registered
INFO:routers:‚úÖ Registered api_v2 router at /fuelAnalytics/api/v2
INFO:routers:‚úÖ Registered command_center router at /fuelAnalytics/api/command-center
INFO:main:‚úÖ All routers included successfully
INFO:routers_v3:‚úÖ Registered api_v2 router at /fuelAnalytics/api/v2
INFO:routers_v3:‚úÖ Registered sse_endpoints router
INFO:routers_v3:‚úÖ Registered fuel_stations router
INFO:routers_v3:‚úÖ Registered sensor_health_router
INFO:routers_v3:‚úÖ Registered mpg_baseline_router
INFO:routers_v3:‚úÖ Registered driver_alerts_router at /fuelAnalytics/api/v2/driver-alerts
INFO:routers_v3:üöÄ v3.12.21 routers registration complete
INFO:main:‚úÖ v3.12.21 API v2 router registered
INFO:v5_endpoints:‚úÖ V5 Endpoints registered (Fleet Analytics + Leaderboard)
INFO:main:‚úÖ V5 Clean Endpoints registered (Fleet Analytics, Leaderboard)
INFO:main:üöÄ v5.2: Using new lightweight v5 endpoints (TruckHealthMonitor disabled)
INFO:     Started server process [51906]
INFO:     Waiting for application startup.
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üöÄ Fuel Copilot API v3.12.0 STARTING...
INFO:lifecycle_manager:üìÖ Startup Time: 2025-12-28T18:32:04.795962
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üîÑ Initializing multi-layer cache...
INFO:lifecycle_manager:‚úÖ Multi-layer cache connected successfully
INFO:lifecycle_manager:üîÑ Initializing async database pool...
INFO:database_async:üîÑ Creating async MySQL connection pool...
INFO:database_async:   Host: localhost:3306
INFO:database_async:   Database: fuel_copilot_local
INFO:database_async:   Pool size: 5-20
INFO:database_async:‚úÖ Async MySQL connection pool created successfully
INFO:lifecycle_manager:‚úÖ Async DB pool initialized successfully
INFO:database_mysql:‚úÖ SQLAlchemy engine created with connection pooling (10+5 connections)
INFO:database:‚úÖ Found 22 trucks in MySQL
INFO:lifecycle_manager:Available trucks: 22
INFO:lifecycle_manager:MySQL enhanced features: enabled
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:‚úÖ API ready for connections
INFO:lifecycle_manager:================================================================================
INFO:     Application startup complete.
‚ö†Ô∏è MYSQL_PASSWORD not set - database connections will fail
‚ö†Ô∏è LOCAL_DB_PASS not set - local database connections will fail
‚ö†Ô∏è  Redis cache unavailable: No module named 'redis_cache'
/opt/anaconda3/lib/python3.12/site-packages/keras/src/export/tf2onnx_lib.py:8: FutureWarning: In the future `np.object` will be defined as the corresponding NumPy scalar.
  if not hasattr(np, "object"):
‚ö†Ô∏è MPG History router not available: No module named 'logger_config'
INFO:main:‚úÖ Driver Alerts router registered
INFO:main:‚úÖ Alerts router registered
INFO:main:‚úÖ Trucks router registered
INFO:main:‚úÖ Refuels router registered
INFO:main:‚úÖ Analytics router registered
INFO:main:‚úÖ Maintenance router registered
INFO:ekf_integration:‚úÖ EKFManager inicializado en data/ekf_states
INFO:main:‚úÖ FASE 2A: EKF Integration & Diagnostics endpoints registered
INFO:main:‚úÖ FASE 2B: ML Pipeline (LSTM + Anomaly Detection + Driver Scoring) loaded
INFO:kafka_event_bus:‚úÖ Event Bus inicializado
INFO:kafka_event_bus:‚úÖ Event Bus suscriptores inicializados
INFO:main:‚úÖ FASE 2C: Event Bus & Microservices Orchestrator loaded
INFO:main:‚úÖ New Features: Cache + WebSocket + ML + Coaching registered
INFO:main:‚úÖ API v2 router registered
INFO:main:‚úÖ FASE 2C: Route Optimization Engine loaded
INFO:main:‚úÖ Prometheus metrics enabled
INFO:main:‚úÖ Rate limiting middleware enabled
INFO:main:‚úÖ GZip compression middleware enabled
INFO:main:‚úÖ CORS configured with 5 allowed origins
INFO:main:‚úÖ Global exception handler registered
INFO:routers:‚úÖ Registered api_v2 router at /fuelAnalytics/api/v2
INFO:routers:‚úÖ Registered command_center router at /fuelAnalytics/api/command-center
INFO:main:‚úÖ All routers included successfully
INFO:routers_v3:‚úÖ Registered api_v2 router at /fuelAnalytics/api/v2
INFO:routers_v3:‚úÖ Registered sse_endpoints router
INFO:routers_v3:‚úÖ Registered fuel_stations router
INFO:routers_v3:‚úÖ Registered sensor_health_router
INFO:routers_v3:‚úÖ Registered mpg_baseline_router
INFO:routers_v3:‚úÖ Registered driver_alerts_router at /fuelAnalytics/api/v2/driver-alerts
INFO:routers_v3:üöÄ v3.12.21 routers registration complete
INFO:main:‚úÖ v3.12.21 API v2 router registered
INFO:v5_endpoints:‚úÖ V5 Endpoints registered (Fleet Analytics + Leaderboard)
INFO:main:‚úÖ V5 Clean Endpoints registered (Fleet Analytics, Leaderboard)
INFO:main:üöÄ v5.2: Using new lightweight v5 endpoints (TruckHealthMonitor disabled)
INFO:     Started server process [51918]
INFO:     Waiting for application startup.
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üöÄ Fuel Copilot API v3.12.0 STARTING...
INFO:lifecycle_manager:üìÖ Startup Time: 2025-12-28T18:32:15.046377
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üîÑ Initializing multi-layer cache...
INFO:lifecycle_manager:‚úÖ Multi-layer cache connected successfully
INFO:lifecycle_manager:üîÑ Initializing async database pool...
INFO:database_async:üîÑ Creating async MySQL connection pool...
INFO:database_async:   Host: localhost:3306
INFO:database_async:   Database: fuel_copilot_local
INFO:database_async:   Pool size: 5-20
INFO:database_async:‚úÖ Async MySQL connection pool created successfully
INFO:lifecycle_manager:‚úÖ Async DB pool initialized successfully
INFO:database_mysql:‚úÖ SQLAlchemy engine created with connection pooling (10+5 connections)
INFO:database:‚úÖ Found 22 trucks in MySQL
INFO:lifecycle_manager:Available trucks: 22
INFO:lifecycle_manager:MySQL enhanced features: enabled
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:‚úÖ API ready for connections
INFO:lifecycle_manager:================================================================================
INFO:     Application startup complete.
INFO:config:‚úÖ Loaded 45 trucks from tanks.yaml
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=10.0, estimated_pct(row[35])=9.09
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 10.0
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
‚úÖ SPN Decoder initialized with 111 SPNs
‚úÖ SPN Decoder initialized with 111 SPNs
2025-12-28 18:33:04 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
WARNING:main:üîç DEBUG: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
WARNING:main:üîç DEBUG: sensor_pct value: 10.0
INFO:     127.0.0.1:57819 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:     127.0.0.1:57816 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:33:43 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
WARNING:  WatchFiles detected changes in 'tests/test_predictive_90pct_part1.py'. Reloading...
INFO:     Shutting down
INFO:     127.0.0.1:57832 - "GET /fuelAnalytics/api/v2/fleet/patterns HTTP/1.1" 200 OK
INFO:     Waiting for application shutdown.
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üõë Shutting down Fuel Copilot API
INFO:lifecycle_manager:üìÖ Shutdown Time: 2025-12-28T18:33:48.113594
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üîÑ Disconnecting cache...
INFO:lifecycle_manager:‚úÖ Cache disconnected
INFO:lifecycle_manager:üîÑ Closing async database pool...
INFO:database_async:üîÑ Closing async MySQL connection pool...
INFO:database_async:‚úÖ Async MySQL connection pool closed
INFO:lifecycle_manager:‚úÖ Async DB pool closed
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:‚úÖ Clean shutdown completed
INFO:lifecycle_manager:================================================================================
INFO:     Application shutdown complete.
INFO:     Finished server process [51918]
WARNING:  WatchFiles detected changes in 'tests/test_predictive_90pct_part1.py'. Reloading...
‚ö†Ô∏è MYSQL_PASSWORD not set - database connections will fail
‚ö†Ô∏è LOCAL_DB_PASS not set - local database connections will fail
‚ö†Ô∏è  Redis cache unavailable: No module named 'redis_cache'
/opt/anaconda3/lib/python3.12/site-packages/keras/src/export/tf2onnx_lib.py:8: FutureWarning: In the future `np.object` will be defined as the corresponding NumPy scalar.
  if not hasattr(np, "object"):
‚ö†Ô∏è MPG History router not available: No module named 'logger_config'
INFO:main:‚úÖ Driver Alerts router registered
INFO:main:‚úÖ Alerts router registered
INFO:main:‚úÖ Trucks router registered
INFO:main:‚úÖ Refuels router registered
INFO:main:‚úÖ Analytics router registered
INFO:main:‚úÖ Maintenance router registered
INFO:ekf_integration:‚úÖ EKFManager inicializado en data/ekf_states
INFO:main:‚úÖ FASE 2A: EKF Integration & Diagnostics endpoints registered
INFO:main:‚úÖ FASE 2B: ML Pipeline (LSTM + Anomaly Detection + Driver Scoring) loaded
INFO:kafka_event_bus:‚úÖ Event Bus inicializado
INFO:kafka_event_bus:‚úÖ Event Bus suscriptores inicializados
INFO:main:‚úÖ FASE 2C: Event Bus & Microservices Orchestrator loaded
INFO:main:‚úÖ New Features: Cache + WebSocket + ML + Coaching registered
INFO:main:‚úÖ API v2 router registered
INFO:main:‚úÖ FASE 2C: Route Optimization Engine loaded
INFO:main:‚úÖ Prometheus metrics enabled
INFO:main:‚úÖ Rate limiting middleware enabled
INFO:main:‚úÖ GZip compression middleware enabled
INFO:main:‚úÖ CORS configured with 5 allowed origins
INFO:main:‚úÖ Global exception handler registered
INFO:routers:‚úÖ Registered api_v2 router at /fuelAnalytics/api/v2
INFO:routers:‚úÖ Registered command_center router at /fuelAnalytics/api/command-center
INFO:main:‚úÖ All routers included successfully
INFO:routers_v3:‚úÖ Registered api_v2 router at /fuelAnalytics/api/v2
INFO:routers_v3:‚úÖ Registered sse_endpoints router
INFO:routers_v3:‚úÖ Registered fuel_stations router
INFO:routers_v3:‚úÖ Registered sensor_health_router
INFO:routers_v3:‚úÖ Registered mpg_baseline_router
INFO:routers_v3:‚úÖ Registered driver_alerts_router at /fuelAnalytics/api/v2/driver-alerts
INFO:routers_v3:üöÄ v3.12.21 routers registration complete
INFO:main:‚úÖ v3.12.21 API v2 router registered
INFO:v5_endpoints:‚úÖ V5 Endpoints registered (Fleet Analytics + Leaderboard)
INFO:main:‚úÖ V5 Clean Endpoints registered (Fleet Analytics, Leaderboard)
INFO:main:üöÄ v5.2: Using new lightweight v5 endpoints (TruckHealthMonitor disabled)
INFO:     Started server process [52486]
INFO:     Waiting for application startup.
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üöÄ Fuel Copilot API v3.12.0 STARTING...
INFO:lifecycle_manager:üìÖ Startup Time: 2025-12-28T18:33:51.644258
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üîÑ Initializing multi-layer cache...
INFO:lifecycle_manager:‚úÖ Multi-layer cache connected successfully
INFO:lifecycle_manager:üîÑ Initializing async database pool...
INFO:database_async:üîÑ Creating async MySQL connection pool...
INFO:database_async:   Host: localhost:3306
INFO:database_async:   Database: fuel_copilot_local
INFO:database_async:   Pool size: 5-20
INFO:database_async:‚úÖ Async MySQL connection pool created successfully
INFO:lifecycle_manager:‚úÖ Async DB pool initialized successfully
INFO:database_mysql:‚úÖ SQLAlchemy engine created with connection pooling (10+5 connections)
INFO:database:‚úÖ Found 22 trucks in MySQL
INFO:lifecycle_manager:Available trucks: 22
INFO:lifecycle_manager:MySQL enhanced features: enabled
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:‚úÖ API ready for connections
INFO:lifecycle_manager:================================================================================
INFO:     Application startup complete.
‚ö†Ô∏è MYSQL_PASSWORD not set - database connections will fail
‚ö†Ô∏è LOCAL_DB_PASS not set - local database connections will fail
‚ö†Ô∏è  Redis cache unavailable: No module named 'redis_cache'
/opt/anaconda3/lib/python3.12/site-packages/keras/src/export/tf2onnx_lib.py:8: FutureWarning: In the future `np.object` will be defined as the corresponding NumPy scalar.
  if not hasattr(np, "object"):
‚ö†Ô∏è MPG History router not available: No module named 'logger_config'
INFO:main:‚úÖ Driver Alerts router registered
INFO:main:‚úÖ Alerts router registered
INFO:main:‚úÖ Trucks router registered
INFO:main:‚úÖ Refuels router registered
INFO:main:‚úÖ Analytics router registered
INFO:main:‚úÖ Maintenance router registered
INFO:ekf_integration:‚úÖ EKFManager inicializado en data/ekf_states
INFO:main:‚úÖ FASE 2A: EKF Integration & Diagnostics endpoints registered
INFO:main:‚úÖ FASE 2B: ML Pipeline (LSTM + Anomaly Detection + Driver Scoring) loaded
INFO:kafka_event_bus:‚úÖ Event Bus inicializado
INFO:kafka_event_bus:‚úÖ Event Bus suscriptores inicializados
INFO:main:‚úÖ FASE 2C: Event Bus & Microservices Orchestrator loaded
INFO:main:‚úÖ New Features: Cache + WebSocket + ML + Coaching registered
INFO:main:‚úÖ API v2 router registered
INFO:main:‚úÖ FASE 2C: Route Optimization Engine loaded
INFO:main:‚úÖ Prometheus metrics enabled
INFO:main:‚úÖ Rate limiting middleware enabled
INFO:main:‚úÖ GZip compression middleware enabled
INFO:main:‚úÖ CORS configured with 5 allowed origins
INFO:main:‚úÖ Global exception handler registered
INFO:routers:‚úÖ Registered api_v2 router at /fuelAnalytics/api/v2
INFO:routers:‚úÖ Registered command_center router at /fuelAnalytics/api/command-center
INFO:main:‚úÖ All routers included successfully
INFO:routers_v3:‚úÖ Registered api_v2 router at /fuelAnalytics/api/v2
INFO:routers_v3:‚úÖ Registered sse_endpoints router
INFO:routers_v3:‚úÖ Registered fuel_stations router
INFO:routers_v3:‚úÖ Registered sensor_health_router
INFO:routers_v3:‚úÖ Registered mpg_baseline_router
INFO:routers_v3:‚úÖ Registered driver_alerts_router at /fuelAnalytics/api/v2/driver-alerts
INFO:routers_v3:üöÄ v3.12.21 routers registration complete
INFO:main:‚úÖ v3.12.21 API v2 router registered
INFO:v5_endpoints:‚úÖ V5 Endpoints registered (Fleet Analytics + Leaderboard)
INFO:main:‚úÖ V5 Clean Endpoints registered (Fleet Analytics, Leaderboard)
INFO:main:üöÄ v5.2: Using new lightweight v5 endpoints (TruckHealthMonitor disabled)
INFO:     Started server process [52493]
INFO:     Waiting for application startup.
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üöÄ Fuel Copilot API v3.12.0 STARTING...
INFO:lifecycle_manager:üìÖ Startup Time: 2025-12-28T18:33:55.027066
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üîÑ Initializing multi-layer cache...
INFO:lifecycle_manager:‚úÖ Multi-layer cache connected successfully
INFO:lifecycle_manager:üîÑ Initializing async database pool...
INFO:database_async:üîÑ Creating async MySQL connection pool...
INFO:database_async:   Host: localhost:3306
INFO:database_async:   Database: fuel_copilot_local
INFO:database_async:   Pool size: 5-20
INFO:database_async:‚úÖ Async MySQL connection pool created successfully
INFO:lifecycle_manager:‚úÖ Async DB pool initialized successfully
INFO:database_mysql:‚úÖ SQLAlchemy engine created with connection pooling (10+5 connections)
INFO:database:‚úÖ Found 22 trucks in MySQL
INFO:lifecycle_manager:Available trucks: 22
INFO:lifecycle_manager:MySQL enhanced features: enabled
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:‚úÖ API ready for connections
INFO:lifecycle_manager:================================================================================
INFO:     Application startup complete.
INFO:config:‚úÖ Loaded 45 trucks from tanks.yaml
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=10.0, estimated_pct(row[35])=9.1
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 10.0
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
‚úÖ SPN Decoder initialized with 111 SPNs
‚úÖ SPN Decoder initialized with 111 SPNs
2025-12-28 18:34:04 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
WARNING:main:üîç DEBUG: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
WARNING:main:üîç DEBUG: sensor_pct value: 10.0
INFO:     127.0.0.1:57858 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:     127.0.0.1:57855 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
WARNING:  WatchFiles detected changes in 'tests/test_predictive_90pct_part2.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üõë Shutting down Fuel Copilot API
INFO:lifecycle_manager:üìÖ Shutdown Time: 2025-12-28T18:34:24.732625
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üîÑ Disconnecting cache...
INFO:lifecycle_manager:‚úÖ Cache disconnected
INFO:lifecycle_manager:üîÑ Closing async database pool...
INFO:database_async:üîÑ Closing async MySQL connection pool...
INFO:database_async:‚úÖ Async MySQL connection pool closed
INFO:lifecycle_manager:‚úÖ Async DB pool closed
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:‚úÖ Clean shutdown completed
INFO:lifecycle_manager:================================================================================
INFO:     Application shutdown complete.
INFO:     Finished server process [52493]
WARNING:  WatchFiles detected changes in 'tests/test_predictive_90pct_part2.py'. Reloading...
‚ö†Ô∏è MYSQL_PASSWORD not set - database connections will fail
‚ö†Ô∏è LOCAL_DB_PASS not set - local database connections will fail
‚ö†Ô∏è  Redis cache unavailable: No module named 'redis_cache'
/opt/anaconda3/lib/python3.12/site-packages/keras/src/export/tf2onnx_lib.py:8: FutureWarning: In the future `np.object` will be defined as the corresponding NumPy scalar.
  if not hasattr(np, "object"):
‚ö†Ô∏è MPG History router not available: No module named 'logger_config'
INFO:main:‚úÖ Driver Alerts router registered
INFO:main:‚úÖ Alerts router registered
INFO:main:‚úÖ Trucks router registered
INFO:main:‚úÖ Refuels router registered
INFO:main:‚úÖ Analytics router registered
INFO:main:‚úÖ Maintenance router registered
INFO:ekf_integration:‚úÖ EKFManager inicializado en data/ekf_states
INFO:main:‚úÖ FASE 2A: EKF Integration & Diagnostics endpoints registered
INFO:main:‚úÖ FASE 2B: ML Pipeline (LSTM + Anomaly Detection + Driver Scoring) loaded
INFO:kafka_event_bus:‚úÖ Event Bus inicializado
INFO:kafka_event_bus:‚úÖ Event Bus suscriptores inicializados
INFO:main:‚úÖ FASE 2C: Event Bus & Microservices Orchestrator loaded
INFO:main:‚úÖ New Features: Cache + WebSocket + ML + Coaching registered
INFO:main:‚úÖ API v2 router registered
INFO:main:‚úÖ FASE 2C: Route Optimization Engine loaded
INFO:main:‚úÖ Prometheus metrics enabled
INFO:main:‚úÖ Rate limiting middleware enabled
INFO:main:‚úÖ GZip compression middleware enabled
INFO:main:‚úÖ CORS configured with 5 allowed origins
INFO:main:‚úÖ Global exception handler registered
INFO:routers:‚úÖ Registered api_v2 router at /fuelAnalytics/api/v2
INFO:routers:‚úÖ Registered command_center router at /fuelAnalytics/api/command-center
INFO:main:‚úÖ All routers included successfully
INFO:routers_v3:‚úÖ Registered api_v2 router at /fuelAnalytics/api/v2
INFO:routers_v3:‚úÖ Registered sse_endpoints router
INFO:routers_v3:‚úÖ Registered fuel_stations router
INFO:routers_v3:‚úÖ Registered sensor_health_router
INFO:routers_v3:‚úÖ Registered mpg_baseline_router
INFO:routers_v3:‚úÖ Registered driver_alerts_router at /fuelAnalytics/api/v2/driver-alerts
INFO:routers_v3:üöÄ v3.12.21 routers registration complete
INFO:main:‚úÖ v3.12.21 API v2 router registered
INFO:v5_endpoints:‚úÖ V5 Endpoints registered (Fleet Analytics + Leaderboard)
INFO:main:‚úÖ V5 Clean Endpoints registered (Fleet Analytics, Leaderboard)
INFO:main:üöÄ v5.2: Using new lightweight v5 endpoints (TruckHealthMonitor disabled)
INFO:     Started server process [52559]
INFO:     Waiting for application startup.
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üöÄ Fuel Copilot API v3.12.0 STARTING...
INFO:lifecycle_manager:üìÖ Startup Time: 2025-12-28T18:34:28.231735
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üîÑ Initializing multi-layer cache...
INFO:lifecycle_manager:‚úÖ Multi-layer cache connected successfully
INFO:lifecycle_manager:üîÑ Initializing async database pool...
INFO:database_async:üîÑ Creating async MySQL connection pool...
INFO:database_async:   Host: localhost:3306
INFO:database_async:   Database: fuel_copilot_local
INFO:database_async:   Pool size: 5-20
INFO:database_async:‚úÖ Async MySQL connection pool created successfully
INFO:lifecycle_manager:‚úÖ Async DB pool initialized successfully
INFO:database_mysql:‚úÖ SQLAlchemy engine created with connection pooling (10+5 connections)
INFO:database:‚úÖ Found 22 trucks in MySQL
INFO:lifecycle_manager:Available trucks: 22
INFO:lifecycle_manager:MySQL enhanced features: enabled
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:‚úÖ API ready for connections
INFO:lifecycle_manager:================================================================================
INFO:     Application startup complete.
‚ö†Ô∏è MYSQL_PASSWORD not set - database connections will fail
‚ö†Ô∏è LOCAL_DB_PASS not set - local database connections will fail
‚ö†Ô∏è  Redis cache unavailable: No module named 'redis_cache'
WARNING:  WatchFiles detected changes in 'tests/test_predictive_90pct_part1.py'. Reloading...
/opt/anaconda3/lib/python3.12/site-packages/keras/src/export/tf2onnx_lib.py:8: FutureWarning: In the future `np.object` will be defined as the corresponding NumPy scalar.
  if not hasattr(np, "object"):
‚ö†Ô∏è MPG History router not available: No module named 'logger_config'
INFO:main:‚úÖ Driver Alerts router registered
INFO:main:‚úÖ Alerts router registered
INFO:main:‚úÖ Trucks router registered
INFO:main:‚úÖ Refuels router registered
INFO:main:‚úÖ Analytics router registered
INFO:main:‚úÖ Maintenance router registered
INFO:ekf_integration:‚úÖ EKFManager inicializado en data/ekf_states
INFO:main:‚úÖ FASE 2A: EKF Integration & Diagnostics endpoints registered
INFO:main:‚úÖ FASE 2B: ML Pipeline (LSTM + Anomaly Detection + Driver Scoring) loaded
INFO:kafka_event_bus:‚úÖ Event Bus inicializado
INFO:kafka_event_bus:‚úÖ Event Bus suscriptores inicializados
INFO:main:‚úÖ FASE 2C: Event Bus & Microservices Orchestrator loaded
INFO:main:‚úÖ New Features: Cache + WebSocket + ML + Coaching registered
INFO:main:‚úÖ API v2 router registered
INFO:main:‚úÖ FASE 2C: Route Optimization Engine loaded
INFO:main:‚úÖ Prometheus metrics enabled
INFO:main:‚úÖ Rate limiting middleware enabled
INFO:main:‚úÖ GZip compression middleware enabled
INFO:main:‚úÖ CORS configured with 5 allowed origins
INFO:main:‚úÖ Global exception handler registered
INFO:routers:‚úÖ Registered api_v2 router at /fuelAnalytics/api/v2
INFO:routers:‚úÖ Registered command_center router at /fuelAnalytics/api/command-center
INFO:main:‚úÖ All routers included successfully
INFO:routers_v3:‚úÖ Registered api_v2 router at /fuelAnalytics/api/v2
INFO:routers_v3:‚úÖ Registered sse_endpoints router
INFO:routers_v3:‚úÖ Registered fuel_stations router
INFO:routers_v3:‚úÖ Registered sensor_health_router
INFO:routers_v3:‚úÖ Registered mpg_baseline_router
INFO:routers_v3:‚úÖ Registered driver_alerts_router at /fuelAnalytics/api/v2/driver-alerts
INFO:routers_v3:üöÄ v3.12.21 routers registration complete
INFO:main:‚úÖ v3.12.21 API v2 router registered
INFO:v5_endpoints:‚úÖ V5 Endpoints registered (Fleet Analytics + Leaderboard)
INFO:main:‚úÖ V5 Clean Endpoints registered (Fleet Analytics, Leaderboard)
INFO:main:üöÄ v5.2: Using new lightweight v5 endpoints (TruckHealthMonitor disabled)
INFO:     Started server process [52565]
INFO:     Waiting for application startup.
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üöÄ Fuel Copilot API v3.12.0 STARTING...
INFO:lifecycle_manager:üìÖ Startup Time: 2025-12-28T18:34:50.947802
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üîÑ Initializing multi-layer cache...
INFO:lifecycle_manager:‚úÖ Multi-layer cache connected successfully
INFO:lifecycle_manager:üîÑ Initializing async database pool...
INFO:database_async:üîÑ Creating async MySQL connection pool...
INFO:database_async:   Host: localhost:3306
INFO:database_async:   Database: fuel_copilot_local
INFO:database_async:   Pool size: 5-20
INFO:database_async:‚úÖ Async MySQL connection pool created successfully
INFO:lifecycle_manager:‚úÖ Async DB pool initialized successfully
INFO:database_mysql:‚úÖ SQLAlchemy engine created with connection pooling (10+5 connections)
INFO:database:‚úÖ Found 22 trucks in MySQL
INFO:lifecycle_manager:Available trucks: 22
INFO:lifecycle_manager:MySQL enhanced features: enabled
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:‚úÖ API ready for connections
INFO:lifecycle_manager:================================================================================
INFO:     Application startup complete.
‚ö†Ô∏è MYSQL_PASSWORD not set - database connections will fail
‚ö†Ô∏è LOCAL_DB_PASS not set - local database connections will fail
‚ö†Ô∏è  Redis cache unavailable: No module named 'redis_cache'
WARNING:  WatchFiles detected changes in 'tests/test_predictive_coverage_boost.py'. Reloading...
/opt/anaconda3/lib/python3.12/site-packages/keras/src/export/tf2onnx_lib.py:8: FutureWarning: In the future `np.object` will be defined as the corresponding NumPy scalar.
  if not hasattr(np, "object"):
‚ö†Ô∏è MPG History router not available: No module named 'logger_config'
INFO:main:‚úÖ Driver Alerts router registered
INFO:main:‚úÖ Alerts router registered
INFO:main:‚úÖ Trucks router registered
INFO:main:‚úÖ Refuels router registered
INFO:main:‚úÖ Analytics router registered
INFO:main:‚úÖ Maintenance router registered
INFO:ekf_integration:‚úÖ EKFManager inicializado en data/ekf_states
INFO:main:‚úÖ FASE 2A: EKF Integration & Diagnostics endpoints registered
INFO:main:‚úÖ FASE 2B: ML Pipeline (LSTM + Anomaly Detection + Driver Scoring) loaded
INFO:kafka_event_bus:‚úÖ Event Bus inicializado
INFO:kafka_event_bus:‚úÖ Event Bus suscriptores inicializados
INFO:main:‚úÖ FASE 2C: Event Bus & Microservices Orchestrator loaded
INFO:main:‚úÖ New Features: Cache + WebSocket + ML + Coaching registered
INFO:main:‚úÖ API v2 router registered
INFO:main:‚úÖ FASE 2C: Route Optimization Engine loaded
INFO:main:‚úÖ Prometheus metrics enabled
INFO:main:‚úÖ Rate limiting middleware enabled
INFO:main:‚úÖ GZip compression middleware enabled
INFO:main:‚úÖ CORS configured with 5 allowed origins
INFO:main:‚úÖ Global exception handler registered
INFO:routers:‚úÖ Registered api_v2 router at /fuelAnalytics/api/v2
INFO:routers:‚úÖ Registered command_center router at /fuelAnalytics/api/command-center
INFO:main:‚úÖ All routers included successfully
INFO:routers_v3:‚úÖ Registered api_v2 router at /fuelAnalytics/api/v2
INFO:routers_v3:‚úÖ Registered sse_endpoints router
INFO:routers_v3:‚úÖ Registered fuel_stations router
INFO:routers_v3:‚úÖ Registered sensor_health_router
INFO:routers_v3:‚úÖ Registered mpg_baseline_router
INFO:routers_v3:‚úÖ Registered driver_alerts_router at /fuelAnalytics/api/v2/driver-alerts
INFO:routers_v3:üöÄ v3.12.21 routers registration complete
INFO:main:‚úÖ v3.12.21 API v2 router registered
INFO:v5_endpoints:‚úÖ V5 Endpoints registered (Fleet Analytics + Leaderboard)
INFO:main:‚úÖ V5 Clean Endpoints registered (Fleet Analytics, Leaderboard)
INFO:main:üöÄ v5.2: Using new lightweight v5 endpoints (TruckHealthMonitor disabled)
INFO:     Started server process [53268]
INFO:     Waiting for application startup.
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üöÄ Fuel Copilot API v3.12.0 STARTING...
INFO:lifecycle_manager:üìÖ Startup Time: 2025-12-28T18:37:27.005967
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üîÑ Initializing multi-layer cache...
INFO:lifecycle_manager:‚úÖ Multi-layer cache connected successfully
INFO:lifecycle_manager:üîÑ Initializing async database pool...
INFO:database_async:üîÑ Creating async MySQL connection pool...
INFO:database_async:   Host: localhost:3306
INFO:database_async:   Database: fuel_copilot_local
INFO:database_async:   Pool size: 5-20
INFO:database_async:‚úÖ Async MySQL connection pool created successfully
INFO:lifecycle_manager:‚úÖ Async DB pool initialized successfully
INFO:database_mysql:‚úÖ SQLAlchemy engine created with connection pooling (10+5 connections)
INFO:database:‚úÖ Found 22 trucks in MySQL
INFO:lifecycle_manager:Available trucks: 22
INFO:lifecycle_manager:MySQL enhanced features: enabled
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:‚úÖ API ready for connections
INFO:lifecycle_manager:================================================================================
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'tests/test_fleet_90pct_part1.py', 'tests/test_predictive_90pct_part1.py', 'tests/test_fleet_coverage_boost.py', 'tests/test_predictive_coverage_boost.py', 'tests/test_predictive_90pct_part2.py'. Reloading...
‚ö†Ô∏è MYSQL_PASSWORD not set - database connections will fail
‚ö†Ô∏è LOCAL_DB_PASS not set - local database connections will fail
‚ö†Ô∏è  Redis cache unavailable: No module named 'redis_cache'
/opt/anaconda3/lib/python3.12/site-packages/keras/src/export/tf2onnx_lib.py:8: FutureWarning: In the future `np.object` will be defined as the corresponding NumPy scalar.
  if not hasattr(np, "object"):
‚ö†Ô∏è MPG History router not available: No module named 'logger_config'
INFO:main:‚úÖ Driver Alerts router registered
INFO:main:‚úÖ Alerts router registered
INFO:main:‚úÖ Trucks router registered
INFO:main:‚úÖ Refuels router registered
INFO:main:‚úÖ Analytics router registered
INFO:main:‚úÖ Maintenance router registered
INFO:ekf_integration:‚úÖ EKFManager inicializado en data/ekf_states
INFO:main:‚úÖ FASE 2A: EKF Integration & Diagnostics endpoints registered
INFO:main:‚úÖ FASE 2B: ML Pipeline (LSTM + Anomaly Detection + Driver Scoring) loaded
INFO:kafka_event_bus:‚úÖ Event Bus inicializado
INFO:kafka_event_bus:‚úÖ Event Bus suscriptores inicializados
INFO:main:‚úÖ FASE 2C: Event Bus & Microservices Orchestrator loaded
INFO:main:‚úÖ New Features: Cache + WebSocket + ML + Coaching registered
INFO:main:‚úÖ API v2 router registered
INFO:main:‚úÖ FASE 2C: Route Optimization Engine loaded
INFO:main:‚úÖ Prometheus metrics enabled
INFO:main:‚úÖ Rate limiting middleware enabled
INFO:main:‚úÖ GZip compression middleware enabled
INFO:main:‚úÖ CORS configured with 5 allowed origins
INFO:main:‚úÖ Global exception handler registered
INFO:routers:‚úÖ Registered api_v2 router at /fuelAnalytics/api/v2
INFO:routers:‚úÖ Registered command_center router at /fuelAnalytics/api/command-center
INFO:main:‚úÖ All routers included successfully
INFO:routers_v3:‚úÖ Registered api_v2 router at /fuelAnalytics/api/v2
INFO:routers_v3:‚úÖ Registered sse_endpoints router
INFO:routers_v3:‚úÖ Registered fuel_stations router
INFO:routers_v3:‚úÖ Registered sensor_health_router
INFO:routers_v3:‚úÖ Registered mpg_baseline_router
INFO:routers_v3:‚úÖ Registered driver_alerts_router at /fuelAnalytics/api/v2/driver-alerts
INFO:routers_v3:üöÄ v3.12.21 routers registration complete
INFO:main:‚úÖ v3.12.21 API v2 router registered
INFO:v5_endpoints:‚úÖ V5 Endpoints registered (Fleet Analytics + Leaderboard)
INFO:main:‚úÖ V5 Clean Endpoints registered (Fleet Analytics, Leaderboard)
INFO:main:üöÄ v5.2: Using new lightweight v5 endpoints (TruckHealthMonitor disabled)
INFO:     Started server process [54054]
INFO:     Waiting for application startup.
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üöÄ Fuel Copilot API v3.12.0 STARTING...
INFO:lifecycle_manager:üìÖ Startup Time: 2025-12-28T18:37:55.093272
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üîÑ Initializing multi-layer cache...
INFO:lifecycle_manager:‚úÖ Multi-layer cache connected successfully
INFO:lifecycle_manager:üîÑ Initializing async database pool...
INFO:database_async:üîÑ Creating async MySQL connection pool...
INFO:database_async:   Host: localhost:3306
INFO:database_async:   Database: fuel_copilot_local
INFO:database_async:   Pool size: 5-20
INFO:database_async:‚úÖ Async MySQL connection pool created successfully
INFO:lifecycle_manager:‚úÖ Async DB pool initialized successfully
INFO:database_mysql:‚úÖ SQLAlchemy engine created with connection pooling (10+5 connections)
INFO:database:‚úÖ Found 22 trucks in MySQL
INFO:lifecycle_manager:Available trucks: 22
INFO:lifecycle_manager:MySQL enhanced features: enabled
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:‚úÖ API ready for connections
INFO:lifecycle_manager:================================================================================
INFO:     Application startup complete.
INFO:config:‚úÖ Loaded 45 trucks from tanks.yaml
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
‚úÖ SPN Decoder initialized with 111 SPNs
‚úÖ SPN Decoder initialized with 111 SPNs
2025-12-28 18:37:56 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=10.0, estimated_pct(row[35])=8.91
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 10.0
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
WARNING:main:üîç DEBUG: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
WARNING:main:üîç DEBUG: sensor_pct value: 10.0
INFO:     127.0.0.1:57912 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:     127.0.0.1:57909 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:     127.0.0.1:57966 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:     127.0.0.1:57970 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
INFO:     127.0.0.1:57979 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
ERROR:database:üîç DEBUG database.py: sensor_pct value: 10.0
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
INFO:     127.0.0.1:57992 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
WARNING:main:üîç DEBUG: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
WARNING:main:üîç DEBUG: sensor_pct value: 10.0
INFO:     127.0.0.1:57946 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:     127.0.0.1:57966 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:     127.0.0.1:57946 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:     127.0.0.1:57946 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:38:02 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:58026 - "GET /fuelAnalytics/api/v2/fleet/patterns HTTP/1.1" 200 OK
INFO:     127.0.0.1:57946 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:cache_service:‚úÖ Redis connected: redis://localhost:6379/0
WARNING:api_endpoints_async:Error analyzing oil_pump for CO0681: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for CO0681: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for CO0681: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for DO9356: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for DO9356: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for DO9356: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for DO9693: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for DO9693: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for DO9693: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for DR6664: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for DR6664: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for DR6664: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for FM3363: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for FM3363: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for GP9677: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for GP9677: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for GS5030: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for GS5030: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for JB6858: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for JB6858: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for JB6858: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for JC1282: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for JC1282: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for JC1282: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for JP3281: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for JP3281: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for JP3281: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for JR7099: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for JR7099: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for LC6799: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for LC6799: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for LC6799: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for LH1141: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for LH1141: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for MJ9547: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for MJ9547: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for MJ9547: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for MR7679: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for MR7679: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for OM7769: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for OM7769: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for RA9250: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for RA9250: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for RC6625: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for RC6625: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for RH1522: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for RH1522: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for RR1272: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for RR1272: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for RT9127: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for RT9127: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for RT9127: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for SG5760: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for SG5760: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for SG5760: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
INFO:     127.0.0.1:57946 - "GET /fuelAnalytics/api/predictive-maintenance HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:38:26 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:58034 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:     127.0.0.1:57946 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
WARNING:  WatchFiles detected changes in 'tests/test_fleet_90pct_part1.py', 'tests/test_predictive_90pct_part2.py', 'tests/test_predictive_90pct_part1.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üõë Shutting down Fuel Copilot API
INFO:lifecycle_manager:üìÖ Shutdown Time: 2025-12-28T18:38:33.558512
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üîÑ Disconnecting cache...
INFO:lifecycle_manager:‚úÖ Cache disconnected
INFO:lifecycle_manager:üîÑ Closing async database pool...
INFO:database_async:üîÑ Closing async MySQL connection pool...
INFO:database_async:‚úÖ Async MySQL connection pool closed
INFO:lifecycle_manager:‚úÖ Async DB pool closed
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:‚úÖ Clean shutdown completed
INFO:lifecycle_manager:================================================================================
INFO:     Application shutdown complete.
INFO:     Finished server process [54054]
‚ö†Ô∏è MYSQL_PASSWORD not set - database connections will fail
‚ö†Ô∏è LOCAL_DB_PASS not set - local database connections will fail
‚ö†Ô∏è  Redis cache unavailable: No module named 'redis_cache'
/opt/anaconda3/lib/python3.12/site-packages/keras/src/export/tf2onnx_lib.py:8: FutureWarning: In the future `np.object` will be defined as the corresponding NumPy scalar.
  if not hasattr(np, "object"):
‚ö†Ô∏è MPG History router not available: No module named 'logger_config'
INFO:main:‚úÖ Driver Alerts router registered
INFO:main:‚úÖ Alerts router registered
INFO:main:‚úÖ Trucks router registered
INFO:main:‚úÖ Refuels router registered
INFO:main:‚úÖ Analytics router registered
INFO:main:‚úÖ Maintenance router registered
INFO:ekf_integration:‚úÖ EKFManager inicializado en data/ekf_states
INFO:main:‚úÖ FASE 2A: EKF Integration & Diagnostics endpoints registered
INFO:main:‚úÖ FASE 2B: ML Pipeline (LSTM + Anomaly Detection + Driver Scoring) loaded
INFO:kafka_event_bus:‚úÖ Event Bus inicializado
INFO:kafka_event_bus:‚úÖ Event Bus suscriptores inicializados
INFO:main:‚úÖ FASE 2C: Event Bus & Microservices Orchestrator loaded
INFO:main:‚úÖ New Features: Cache + WebSocket + ML + Coaching registered
INFO:main:‚úÖ API v2 router registered
INFO:main:‚úÖ FASE 2C: Route Optimization Engine loaded
INFO:main:‚úÖ Prometheus metrics enabled
INFO:main:‚úÖ Rate limiting middleware enabled
INFO:main:‚úÖ GZip compression middleware enabled
INFO:main:‚úÖ CORS configured with 5 allowed origins
INFO:main:‚úÖ Global exception handler registered
INFO:routers:‚úÖ Registered api_v2 router at /fuelAnalytics/api/v2
INFO:routers:‚úÖ Registered command_center router at /fuelAnalytics/api/command-center
INFO:main:‚úÖ All routers included successfully
INFO:routers_v3:‚úÖ Registered api_v2 router at /fuelAnalytics/api/v2
INFO:routers_v3:‚úÖ Registered sse_endpoints router
INFO:routers_v3:‚úÖ Registered fuel_stations router
INFO:routers_v3:‚úÖ Registered sensor_health_router
INFO:routers_v3:‚úÖ Registered mpg_baseline_router
INFO:routers_v3:‚úÖ Registered driver_alerts_router at /fuelAnalytics/api/v2/driver-alerts
INFO:routers_v3:üöÄ v3.12.21 routers registration complete
INFO:main:‚úÖ v3.12.21 API v2 router registered
INFO:v5_endpoints:‚úÖ V5 Endpoints registered (Fleet Analytics + Leaderboard)
INFO:main:‚úÖ V5 Clean Endpoints registered (Fleet Analytics, Leaderboard)
INFO:main:üöÄ v5.2: Using new lightweight v5 endpoints (TruckHealthMonitor disabled)
INFO:     Started server process [55161]
INFO:     Waiting for application startup.
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üöÄ Fuel Copilot API v3.12.0 STARTING...
INFO:lifecycle_manager:üìÖ Startup Time: 2025-12-28T18:38:51.290290
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üîÑ Initializing multi-layer cache...
INFO:lifecycle_manager:‚úÖ Multi-layer cache connected successfully
INFO:lifecycle_manager:üîÑ Initializing async database pool...
INFO:database_async:üîÑ Creating async MySQL connection pool...
INFO:database_async:   Host: localhost:3306
INFO:database_async:   Database: fuel_copilot_local
INFO:database_async:   Pool size: 5-20
INFO:database_async:‚úÖ Async MySQL connection pool created successfully
INFO:lifecycle_manager:‚úÖ Async DB pool initialized successfully
INFO:database_mysql:‚úÖ SQLAlchemy engine created with connection pooling (10+5 connections)
INFO:database:‚úÖ Found 22 trucks in MySQL
INFO:lifecycle_manager:Available trucks: 22
INFO:lifecycle_manager:MySQL enhanced features: enabled
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:‚úÖ API ready for connections
INFO:lifecycle_manager:================================================================================
INFO:     Application startup complete.
INFO:config:‚úÖ Loaded 45 trucks from tanks.yaml
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=10.0, estimated_pct(row[35])=8.92
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 10.0
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
‚úÖ SPN Decoder initialized with 111 SPNs
‚úÖ SPN Decoder initialized with 111 SPNs
2025-12-28 18:38:51 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
WARNING:main:üîç DEBUG: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
WARNING:main:üîç DEBUG: sensor_pct value: 10.0
INFO:     127.0.0.1:58045 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:     127.0.0.1:58042 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:     127.0.0.1:58042 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:     127.0.0.1:58060 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:39:12 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:58063 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=10.0, estimated_pct(row[35])=8.84
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 10.0
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
WARNING:main:üîç DEBUG: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
WARNING:main:üîç DEBUG: sensor_pct value: 10.0
INFO:     127.0.0.1:58082 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:     127.0.0.1:58085 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:39:42 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:58088 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:39:47 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:58096 - "GET /fuelAnalytics/api/v2/fleet/patterns HTTP/1.1" 200 OK
INFO:     127.0.0.1:58102 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=10.0, estimated_pct(row[35])=8.86
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 10.0
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
WARNING:main:üîç DEBUG: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
WARNING:main:üîç DEBUG: sensor_pct value: 10.0
INFO:     127.0.0.1:58105 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:40:12 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:58108 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:     127.0.0.1:58114 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:     127.0.0.1:58116 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:40:42 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:58119 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=10.0, estimated_pct(row[35])=8.78
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 10.0
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
WARNING:main:üîç DEBUG: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
WARNING:main:üîç DEBUG: sensor_pct value: 10.0
INFO:     127.0.0.1:58124 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:     127.0.0.1:58126 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:41:12 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:58129 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:     127.0.0.1:58134 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=10.0, estimated_pct(row[35])=8.79
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 10.0
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
WARNING:main:üîç DEBUG: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
WARNING:main:üîç DEBUG: sensor_pct value: 10.0
INFO:     127.0.0.1:58137 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:41:42 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:58140 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:41:47 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:58146 - "GET /fuelAnalytics/api/v2/fleet/patterns HTTP/1.1" 200 OK
INFO:cache_service:‚úÖ Redis connected: redis://localhost:6379/0
INFO:     127.0.0.1:58150 - "GET /fuelAnalytics/api/predictive-maintenance HTTP/1.1" 200 OK
INFO:     127.0.0.1:58154 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:     127.0.0.1:58158 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:42:12 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:58161 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=10.0, estimated_pct(row[35])=8.81
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 10.0
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
WARNING:main:üîç DEBUG: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
WARNING:main:üîç DEBUG: sensor_pct value: 10.0
INFO:     127.0.0.1:58181 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:     127.0.0.1:58206 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:42:42 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:58209 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:     127.0.0.1:58233 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=10.0, estimated_pct(row[35])=8.74
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 10.0
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
WARNING:main:üîç DEBUG: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
WARNING:main:üîç DEBUG: sensor_pct value: 10.0
INFO:     127.0.0.1:58235 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:43:12 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:58238 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:     127.0.0.1:58253 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:     127.0.0.1:58255 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:43:42 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:58258 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:43:47 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:58264 - "GET /fuelAnalytics/api/v2/fleet/patterns HTTP/1.1" 200 OK
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=10.0, estimated_pct(row[35])=8.76
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 10.0
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
WARNING:main:üîç DEBUG: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
WARNING:main:üîç DEBUG: sensor_pct value: 10.0
INFO:     127.0.0.1:58585 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:     127.0.0.1:58864 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:44:12 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
WARNING:  WatchFiles detected changes in 'tests/test_fleet_coverage_boost.py'. Reloading...
INFO:     Shutting down
INFO:     127.0.0.1:58867 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:     Waiting for application shutdown.
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üõë Shutting down Fuel Copilot API
INFO:lifecycle_manager:üìÖ Shutdown Time: 2025-12-28T18:44:17.130860
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üîÑ Disconnecting cache...
INFO:lifecycle_manager:‚úÖ Cache disconnected
INFO:lifecycle_manager:üîÑ Closing async database pool...
INFO:database_async:üîÑ Closing async MySQL connection pool...
INFO:database_async:‚úÖ Async MySQL connection pool closed
INFO:lifecycle_manager:‚úÖ Async DB pool closed
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:‚úÖ Clean shutdown completed
INFO:lifecycle_manager:================================================================================
INFO:     Application shutdown complete.
INFO:     Finished server process [55161]
‚ö†Ô∏è MYSQL_PASSWORD not set - database connections will fail
‚ö†Ô∏è LOCAL_DB_PASS not set - local database connections will fail
‚ö†Ô∏è  Redis cache unavailable: No module named 'redis_cache'
/opt/anaconda3/lib/python3.12/site-packages/keras/src/export/tf2onnx_lib.py:8: FutureWarning: In the future `np.object` will be defined as the corresponding NumPy scalar.
  if not hasattr(np, "object"):
‚ö†Ô∏è MPG History router not available: No module named 'logger_config'
INFO:main:‚úÖ Driver Alerts router registered
INFO:main:‚úÖ Alerts router registered
INFO:main:‚úÖ Trucks router registered
INFO:main:‚úÖ Refuels router registered
INFO:main:‚úÖ Analytics router registered
INFO:main:‚úÖ Maintenance router registered
INFO:ekf_integration:‚úÖ EKFManager inicializado en data/ekf_states
INFO:main:‚úÖ FASE 2A: EKF Integration & Diagnostics endpoints registered
INFO:main:‚úÖ FASE 2B: ML Pipeline (LSTM + Anomaly Detection + Driver Scoring) loaded
INFO:kafka_event_bus:‚úÖ Event Bus inicializado
INFO:kafka_event_bus:‚úÖ Event Bus suscriptores inicializados
INFO:main:‚úÖ FASE 2C: Event Bus & Microservices Orchestrator loaded
INFO:main:‚úÖ New Features: Cache + WebSocket + ML + Coaching registered
INFO:main:‚úÖ API v2 router registered
INFO:main:‚úÖ FASE 2C: Route Optimization Engine loaded
INFO:main:‚úÖ Prometheus metrics enabled
INFO:main:‚úÖ Rate limiting middleware enabled
INFO:main:‚úÖ GZip compression middleware enabled
INFO:main:‚úÖ CORS configured with 5 allowed origins
INFO:main:‚úÖ Global exception handler registered
INFO:routers:‚úÖ Registered api_v2 router at /fuelAnalytics/api/v2
INFO:routers:‚úÖ Registered command_center router at /fuelAnalytics/api/command-center
INFO:main:‚úÖ All routers included successfully
INFO:routers_v3:‚úÖ Registered api_v2 router at /fuelAnalytics/api/v2
INFO:routers_v3:‚úÖ Registered sse_endpoints router
INFO:routers_v3:‚úÖ Registered fuel_stations router
INFO:routers_v3:‚úÖ Registered sensor_health_router
INFO:routers_v3:‚úÖ Registered mpg_baseline_router
INFO:routers_v3:‚úÖ Registered driver_alerts_router at /fuelAnalytics/api/v2/driver-alerts
INFO:routers_v3:üöÄ v3.12.21 routers registration complete
INFO:main:‚úÖ v3.12.21 API v2 router registered
INFO:v5_endpoints:‚úÖ V5 Endpoints registered (Fleet Analytics + Leaderboard)
INFO:main:‚úÖ V5 Clean Endpoints registered (Fleet Analytics, Leaderboard)
INFO:main:üöÄ v5.2: Using new lightweight v5 endpoints (TruckHealthMonitor disabled)
INFO:     Started server process [56004]
INFO:     Waiting for application startup.
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üöÄ Fuel Copilot API v3.12.0 STARTING...
INFO:lifecycle_manager:üìÖ Startup Time: 2025-12-28T18:44:20.724886
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üîÑ Initializing multi-layer cache...
INFO:lifecycle_manager:‚úÖ Multi-layer cache connected successfully
INFO:lifecycle_manager:üîÑ Initializing async database pool...
INFO:database_async:üîÑ Creating async MySQL connection pool...
INFO:database_async:   Host: localhost:3306
INFO:database_async:   Database: fuel_copilot_local
INFO:database_async:   Pool size: 5-20
INFO:database_async:‚úÖ Async MySQL connection pool created successfully
INFO:lifecycle_manager:‚úÖ Async DB pool initialized successfully
INFO:database_mysql:‚úÖ SQLAlchemy engine created with connection pooling (10+5 connections)
INFO:database:‚úÖ Found 22 trucks in MySQL
INFO:lifecycle_manager:Available trucks: 22
INFO:lifecycle_manager:MySQL enhanced features: enabled
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:‚úÖ API ready for connections
INFO:lifecycle_manager:================================================================================
INFO:     Application startup complete.
INFO:config:‚úÖ Loaded 45 trucks from tanks.yaml
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=10.0, estimated_pct(row[35])=8.77
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 10.0
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
WARNING:main:üîç DEBUG: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
WARNING:main:üîç DEBUG: sensor_pct value: 10.0
‚úÖ SPN Decoder initialized with 111 SPNs
‚úÖ SPN Decoder initialized with 111 SPNs
INFO:     127.0.0.1:58891 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:     127.0.0.1:58925 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:44:42 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:58929 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:     127.0.0.1:59017 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=10.0, estimated_pct(row[35])=8.61
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 10.0
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
WARNING:main:üîç DEBUG: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
WARNING:main:üîç DEBUG: sensor_pct value: 10.0
INFO:     127.0.0.1:59044 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:45:12 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:59047 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:     127.0.0.1:59064 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:     127.0.0.1:59080 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:45:42 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:59083 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:45:47 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:59091 - "GET /fuelAnalytics/api/v2/fleet/patterns HTTP/1.1" 200 OK
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=10.0, estimated_pct(row[35])=8.64
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 10.0
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
WARNING:main:üîç DEBUG: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
WARNING:main:üîç DEBUG: sensor_pct value: 10.0
INFO:     127.0.0.1:59096 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:     127.0.0.1:59098 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:46:12 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:59101 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:     127.0.0.1:59109 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=10.0, estimated_pct(row[35])=8.65
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 10.0
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
WARNING:main:üîç DEBUG: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
WARNING:main:üîç DEBUG: sensor_pct value: 10.0
INFO:     127.0.0.1:59232 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:46:42 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:59235 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:cache_service:‚úÖ Redis connected: redis://localhost:6379/0
WARNING:api_endpoints_async:Error analyzing oil_pump for CO0681: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for CO0681: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for CO0681: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for DO9356: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for DO9356: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for DO9356: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for DO9693: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for DO9693: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for DO9693: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for DR6664: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for DR6664: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for DR6664: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for FM3363: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for FM3363: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for GP9677: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for GP9677: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for GS5030: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for GS5030: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for JB6858: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for JB6858: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for JB6858: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for JC1282: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for JC1282: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for JC1282: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for JP3281: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for JP3281: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for JP3281: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for JR7099: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for JR7099: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for LC6799: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for LC6799: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for LC6799: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for LH1141: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for LH1141: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for MJ9547: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for MJ9547: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for MJ9547: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for MR7679: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for MR7679: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for OM7769: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for OM7769: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for RA9250: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for RA9250: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for RC6625: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for RC6625: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for RH1522: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for RH1522: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for RR1272: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for RR1272: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for RT9127: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for RT9127: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for RT9127: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for SG5760: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for SG5760: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for SG5760: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
INFO:     127.0.0.1:59232 - "GET /fuelAnalytics/api/predictive-maintenance HTTP/1.1" 200 OK
INFO:     127.0.0.1:59275 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:     127.0.0.1:59279 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:47:12 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:59282 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=10.0, estimated_pct(row[35])=8.55
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 10.0
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
WARNING:main:üîç DEBUG: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
WARNING:main:üîç DEBUG: sensor_pct value: 10.0
INFO:     127.0.0.1:59292 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:     127.0.0.1:59296 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:47:42 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:59299 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:47:46 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:59307 - "GET /fuelAnalytics/api/v2/fleet/patterns HTTP/1.1" 200 OK
INFO:     127.0.0.1:59311 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=10.0, estimated_pct(row[35])=8.57
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
ERROR:database:üîç DEBUG database.py: sensor_pct value: 10.0
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:48:12 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
WARNING:  WatchFiles detected changes in 'tests/test_predictive_final_90pct.py'. Reloading...
INFO:     Shutting down
WARNING:main:üîç DEBUG: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
WARNING:main:üîç DEBUG: sensor_pct value: 10.0
INFO:     127.0.0.1:59316 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:     127.0.0.1:59313 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:     Waiting for application shutdown.
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üõë Shutting down Fuel Copilot API
INFO:lifecycle_manager:üìÖ Shutdown Time: 2025-12-28T18:48:17.187055
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üîÑ Disconnecting cache...
INFO:lifecycle_manager:‚úÖ Cache disconnected
INFO:lifecycle_manager:üîÑ Closing async database pool...
INFO:database_async:üîÑ Closing async MySQL connection pool...
INFO:database_async:‚úÖ Async MySQL connection pool closed
INFO:lifecycle_manager:‚úÖ Async DB pool closed
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:‚úÖ Clean shutdown completed
INFO:lifecycle_manager:================================================================================
INFO:     Application shutdown complete.
INFO:     Finished server process [56004]
WARNING:  WatchFiles detected changes in 'tests/test_predictive_final_90pct.py'. Reloading...
‚ö†Ô∏è MYSQL_PASSWORD not set - database connections will fail
‚ö†Ô∏è LOCAL_DB_PASS not set - local database connections will fail
‚ö†Ô∏è  Redis cache unavailable: No module named 'redis_cache'
/opt/anaconda3/lib/python3.12/site-packages/keras/src/export/tf2onnx_lib.py:8: FutureWarning: In the future `np.object` will be defined as the corresponding NumPy scalar.
  if not hasattr(np, "object"):
‚ö†Ô∏è MPG History router not available: No module named 'logger_config'
INFO:main:‚úÖ Driver Alerts router registered
INFO:main:‚úÖ Alerts router registered
INFO:main:‚úÖ Trucks router registered
INFO:main:‚úÖ Refuels router registered
INFO:main:‚úÖ Analytics router registered
INFO:main:‚úÖ Maintenance router registered
INFO:ekf_integration:‚úÖ EKFManager inicializado en data/ekf_states
INFO:main:‚úÖ FASE 2A: EKF Integration & Diagnostics endpoints registered
INFO:main:‚úÖ FASE 2B: ML Pipeline (LSTM + Anomaly Detection + Driver Scoring) loaded
INFO:kafka_event_bus:‚úÖ Event Bus inicializado
INFO:kafka_event_bus:‚úÖ Event Bus suscriptores inicializados
INFO:main:‚úÖ FASE 2C: Event Bus & Microservices Orchestrator loaded
INFO:main:‚úÖ New Features: Cache + WebSocket + ML + Coaching registered
INFO:main:‚úÖ API v2 router registered
INFO:main:‚úÖ FASE 2C: Route Optimization Engine loaded
INFO:main:‚úÖ Prometheus metrics enabled
INFO:main:‚úÖ Rate limiting middleware enabled
INFO:main:‚úÖ GZip compression middleware enabled
INFO:main:‚úÖ CORS configured with 5 allowed origins
INFO:main:‚úÖ Global exception handler registered
INFO:routers:‚úÖ Registered api_v2 router at /fuelAnalytics/api/v2
INFO:routers:‚úÖ Registered command_center router at /fuelAnalytics/api/command-center
INFO:main:‚úÖ All routers included successfully
INFO:routers_v3:‚úÖ Registered api_v2 router at /fuelAnalytics/api/v2
INFO:routers_v3:‚úÖ Registered sse_endpoints router
INFO:routers_v3:‚úÖ Registered fuel_stations router
INFO:routers_v3:‚úÖ Registered sensor_health_router
INFO:routers_v3:‚úÖ Registered mpg_baseline_router
INFO:routers_v3:‚úÖ Registered driver_alerts_router at /fuelAnalytics/api/v2/driver-alerts
INFO:routers_v3:üöÄ v3.12.21 routers registration complete
INFO:main:‚úÖ v3.12.21 API v2 router registered
INFO:v5_endpoints:‚úÖ V5 Endpoints registered (Fleet Analytics + Leaderboard)
INFO:main:‚úÖ V5 Clean Endpoints registered (Fleet Analytics, Leaderboard)
INFO:main:üöÄ v5.2: Using new lightweight v5 endpoints (TruckHealthMonitor disabled)
INFO:     Started server process [56794]
INFO:     Waiting for application startup.
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üöÄ Fuel Copilot API v3.12.0 STARTING...
INFO:lifecycle_manager:üìÖ Startup Time: 2025-12-28T18:48:25.512561
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üîÑ Initializing multi-layer cache...
INFO:lifecycle_manager:‚úÖ Multi-layer cache connected successfully
INFO:lifecycle_manager:üîÑ Initializing async database pool...
INFO:database_async:üîÑ Creating async MySQL connection pool...
INFO:database_async:   Host: localhost:3306
INFO:database_async:   Database: fuel_copilot_local
INFO:database_async:   Pool size: 5-20
INFO:database_async:‚úÖ Async MySQL connection pool created successfully
INFO:lifecycle_manager:‚úÖ Async DB pool initialized successfully
INFO:database_mysql:‚úÖ SQLAlchemy engine created with connection pooling (10+5 connections)
INFO:database:‚úÖ Found 22 trucks in MySQL
INFO:lifecycle_manager:Available trucks: 22
INFO:lifecycle_manager:MySQL enhanced features: enabled
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:‚úÖ API ready for connections
INFO:lifecycle_manager:================================================================================
INFO:     Application startup complete.
‚ö†Ô∏è MYSQL_PASSWORD not set - database connections will fail
‚ö†Ô∏è LOCAL_DB_PASS not set - local database connections will fail
‚ö†Ô∏è  Redis cache unavailable: No module named 'redis_cache'
/opt/anaconda3/lib/python3.12/site-packages/keras/src/export/tf2onnx_lib.py:8: FutureWarning: In the future `np.object` will be defined as the corresponding NumPy scalar.
  if not hasattr(np, "object"):
‚ö†Ô∏è MPG History router not available: No module named 'logger_config'
INFO:main:‚úÖ Driver Alerts router registered
INFO:main:‚úÖ Alerts router registered
INFO:main:‚úÖ Trucks router registered
INFO:main:‚úÖ Refuels router registered
INFO:main:‚úÖ Analytics router registered
INFO:main:‚úÖ Maintenance router registered
INFO:ekf_integration:‚úÖ EKFManager inicializado en data/ekf_states
INFO:main:‚úÖ FASE 2A: EKF Integration & Diagnostics endpoints registered
INFO:main:‚úÖ FASE 2B: ML Pipeline (LSTM + Anomaly Detection + Driver Scoring) loaded
INFO:kafka_event_bus:‚úÖ Event Bus inicializado
INFO:kafka_event_bus:‚úÖ Event Bus suscriptores inicializados
INFO:main:‚úÖ FASE 2C: Event Bus & Microservices Orchestrator loaded
INFO:main:‚úÖ New Features: Cache + WebSocket + ML + Coaching registered
INFO:main:‚úÖ API v2 router registered
INFO:main:‚úÖ FASE 2C: Route Optimization Engine loaded
INFO:main:‚úÖ Prometheus metrics enabled
INFO:main:‚úÖ Rate limiting middleware enabled
INFO:main:‚úÖ GZip compression middleware enabled
INFO:main:‚úÖ CORS configured with 5 allowed origins
INFO:main:‚úÖ Global exception handler registered
INFO:routers:‚úÖ Registered api_v2 router at /fuelAnalytics/api/v2
INFO:routers:‚úÖ Registered command_center router at /fuelAnalytics/api/command-center
INFO:main:‚úÖ All routers included successfully
INFO:routers_v3:‚úÖ Registered api_v2 router at /fuelAnalytics/api/v2
INFO:routers_v3:‚úÖ Registered sse_endpoints router
INFO:routers_v3:‚úÖ Registered fuel_stations router
INFO:routers_v3:‚úÖ Registered sensor_health_router
INFO:routers_v3:‚úÖ Registered mpg_baseline_router
INFO:routers_v3:‚úÖ Registered driver_alerts_router at /fuelAnalytics/api/v2/driver-alerts
INFO:routers_v3:üöÄ v3.12.21 routers registration complete
INFO:main:‚úÖ v3.12.21 API v2 router registered
INFO:v5_endpoints:‚úÖ V5 Endpoints registered (Fleet Analytics + Leaderboard)
INFO:main:‚úÖ V5 Clean Endpoints registered (Fleet Analytics, Leaderboard)
INFO:main:üöÄ v5.2: Using new lightweight v5 endpoints (TruckHealthMonitor disabled)
INFO:     Started server process [57121]
INFO:     Waiting for application startup.
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üöÄ Fuel Copilot API v3.12.0 STARTING...
INFO:lifecycle_manager:üìÖ Startup Time: 2025-12-28T18:48:29.540308
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üîÑ Initializing multi-layer cache...
INFO:lifecycle_manager:‚úÖ Multi-layer cache connected successfully
INFO:lifecycle_manager:üîÑ Initializing async database pool...
INFO:database_async:üîÑ Creating async MySQL connection pool...
INFO:database_async:   Host: localhost:3306
INFO:database_async:   Database: fuel_copilot_local
INFO:database_async:   Pool size: 5-20
INFO:database_async:‚úÖ Async MySQL connection pool created successfully
INFO:lifecycle_manager:‚úÖ Async DB pool initialized successfully
INFO:database_mysql:‚úÖ SQLAlchemy engine created with connection pooling (10+5 connections)
INFO:database:‚úÖ Found 22 trucks in MySQL
INFO:lifecycle_manager:Available trucks: 22
INFO:lifecycle_manager:MySQL enhanced features: enabled
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:‚úÖ API ready for connections
INFO:lifecycle_manager:================================================================================
INFO:     Application startup complete.
INFO:config:‚úÖ Loaded 45 trucks from tanks.yaml
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=10.0, estimated_pct(row[35])=8.58
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 10.0
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
WARNING:main:üîç DEBUG: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
WARNING:main:üîç DEBUG: sensor_pct value: 10.0
‚úÖ SPN Decoder initialized with 111 SPNs
‚úÖ SPN Decoder initialized with 111 SPNs
INFO:     127.0.0.1:59335 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:     127.0.0.1:59349 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:48:42 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:59352 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:     127.0.0.1:59361 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=9.6, estimated_pct(row[35])=8.54
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 9.6
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
WARNING:main:üîç DEBUG: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
WARNING:main:üîç DEBUG: sensor_pct value: 9.6
INFO:     127.0.0.1:59364 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:49:12 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:59367 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:     127.0.0.1:59376 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:     127.0.0.1:59381 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:49:42 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:59384 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:49:47 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:59390 - "GET /fuelAnalytics/api/v2/fleet/patterns HTTP/1.1" 200 OK
INFO:truck_specs_engine:‚úÖ Loaded specs for 38 trucks
INFO:     127.0.0.1:59400 - "GET /fuelAnalytics/api/v2/truck-specs HTTP/1.1" 200 OK
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=9.6, estimated_pct(row[35])=8.56
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 9.6
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
WARNING:main:üîç DEBUG: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
WARNING:main:üîç DEBUG: sensor_pct value: 9.6
INFO:     127.0.0.1:59403 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:     127.0.0.1:59405 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:     127.0.0.1:59405 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:50:01 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:59409 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:50:05 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:59415 - "GET /fuelAnalytics/api/v2/fleet/patterns HTTP/1.1" 200 OK
INFO:cache_service:‚úÖ Redis connected: redis://localhost:6379/0
INFO:     127.0.0.1:59420 - "GET /fuelAnalytics/api/predictive-maintenance HTTP/1.1" 200 OK
INFO:     127.0.0.1:59423 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:50:31 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=9.6, estimated_pct(row[35])=8.57
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 9.6
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
WARNING:main:üîç DEBUG: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
WARNING:main:üîç DEBUG: sensor_pct value: 9.6
INFO:     127.0.0.1:59429 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:     127.0.0.1:59426 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:     127.0.0.1:59435 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
WARNING:  WatchFiles detected changes in 'tests/test_predictive_final_90pct.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üõë Shutting down Fuel Copilot API
INFO:lifecycle_manager:üìÖ Shutdown Time: 2025-12-28T18:50:55.316202
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üîÑ Disconnecting cache...
INFO:lifecycle_manager:‚úÖ Cache disconnected
INFO:lifecycle_manager:üîÑ Closing async database pool...
INFO:database_async:üîÑ Closing async MySQL connection pool...
INFO:database_async:‚úÖ Async MySQL connection pool closed
INFO:lifecycle_manager:‚úÖ Async DB pool closed
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:‚úÖ Clean shutdown completed
INFO:lifecycle_manager:================================================================================
INFO:     Application shutdown complete.
INFO:     Finished server process [57121]
‚ö†Ô∏è MYSQL_PASSWORD not set - database connections will fail
‚ö†Ô∏è LOCAL_DB_PASS not set - local database connections will fail
‚ö†Ô∏è  Redis cache unavailable: No module named 'redis_cache'
/opt/anaconda3/lib/python3.12/site-packages/keras/src/export/tf2onnx_lib.py:8: FutureWarning: In the future `np.object` will be defined as the corresponding NumPy scalar.
  if not hasattr(np, "object"):
‚ö†Ô∏è MPG History router not available: No module named 'logger_config'
INFO:main:‚úÖ Driver Alerts router registered
INFO:main:‚úÖ Alerts router registered
INFO:main:‚úÖ Trucks router registered
INFO:main:‚úÖ Refuels router registered
INFO:main:‚úÖ Analytics router registered
INFO:main:‚úÖ Maintenance router registered
INFO:ekf_integration:‚úÖ EKFManager inicializado en data/ekf_states
INFO:main:‚úÖ FASE 2A: EKF Integration & Diagnostics endpoints registered
INFO:main:‚úÖ FASE 2B: ML Pipeline (LSTM + Anomaly Detection + Driver Scoring) loaded
INFO:kafka_event_bus:‚úÖ Event Bus inicializado
INFO:kafka_event_bus:‚úÖ Event Bus suscriptores inicializados
INFO:main:‚úÖ FASE 2C: Event Bus & Microservices Orchestrator loaded
INFO:main:‚úÖ New Features: Cache + WebSocket + ML + Coaching registered
INFO:main:‚úÖ API v2 router registered
INFO:main:‚úÖ FASE 2C: Route Optimization Engine loaded
INFO:main:‚úÖ Prometheus metrics enabled
INFO:main:‚úÖ Rate limiting middleware enabled
INFO:main:‚úÖ GZip compression middleware enabled
INFO:main:‚úÖ CORS configured with 5 allowed origins
INFO:main:‚úÖ Global exception handler registered
INFO:routers:‚úÖ Registered api_v2 router at /fuelAnalytics/api/v2
INFO:routers:‚úÖ Registered command_center router at /fuelAnalytics/api/command-center
INFO:main:‚úÖ All routers included successfully
INFO:routers_v3:‚úÖ Registered api_v2 router at /fuelAnalytics/api/v2
INFO:routers_v3:‚úÖ Registered sse_endpoints router
INFO:routers_v3:‚úÖ Registered fuel_stations router
INFO:routers_v3:‚úÖ Registered sensor_health_router
INFO:routers_v3:‚úÖ Registered mpg_baseline_router
INFO:routers_v3:‚úÖ Registered driver_alerts_router at /fuelAnalytics/api/v2/driver-alerts
INFO:routers_v3:üöÄ v3.12.21 routers registration complete
INFO:main:‚úÖ v3.12.21 API v2 router registered
INFO:v5_endpoints:‚úÖ V5 Endpoints registered (Fleet Analytics + Leaderboard)
INFO:main:‚úÖ V5 Clean Endpoints registered (Fleet Analytics, Leaderboard)
INFO:main:üöÄ v5.2: Using new lightweight v5 endpoints (TruckHealthMonitor disabled)
INFO:     Started server process [57742]
INFO:     Waiting for application startup.
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üöÄ Fuel Copilot API v3.12.0 STARTING...
INFO:lifecycle_manager:üìÖ Startup Time: 2025-12-28T18:50:59.007838
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üîÑ Initializing multi-layer cache...
INFO:lifecycle_manager:‚úÖ Multi-layer cache connected successfully
INFO:lifecycle_manager:üîÑ Initializing async database pool...
INFO:database_async:üîÑ Creating async MySQL connection pool...
INFO:database_async:   Host: localhost:3306
INFO:database_async:   Database: fuel_copilot_local
INFO:database_async:   Pool size: 5-20
INFO:database_async:‚úÖ Async MySQL connection pool created successfully
INFO:lifecycle_manager:‚úÖ Async DB pool initialized successfully
INFO:database_mysql:‚úÖ SQLAlchemy engine created with connection pooling (10+5 connections)
INFO:database:‚úÖ Found 22 trucks in MySQL
INFO:lifecycle_manager:Available trucks: 22
INFO:lifecycle_manager:MySQL enhanced features: enabled
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:‚úÖ API ready for connections
INFO:lifecycle_manager:================================================================================
INFO:     Application startup complete.
INFO:config:‚úÖ Loaded 45 trucks from tanks.yaml
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=9.6, estimated_pct(row[35])=8.58
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 9.6
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
‚úÖ SPN Decoder initialized with 111 SPNs
‚úÖ SPN Decoder initialized with 111 SPNs
2025-12-28 18:51:01 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
WARNING:main:üîç DEBUG: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
WARNING:main:üîç DEBUG: sensor_pct value: 9.6
INFO:     127.0.0.1:59449 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:     127.0.0.1:59446 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:     127.0.0.1:59543 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:     127.0.0.1:59547 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:51:31 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:59549 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=10.0, estimated_pct(row[35])=8.46
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 10.0
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
WARNING:main:üîç DEBUG: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
WARNING:main:üîç DEBUG: sensor_pct value: 10.0
INFO:     127.0.0.1:59600 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:     127.0.0.1:59644 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:52:01 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:59647 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:52:06 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:59658 - "GET /fuelAnalytics/api/v2/fleet/patterns HTTP/1.1" 200 OK
INFO:     127.0.0.1:59684 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:52:31 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:59703 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:53:01 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:59748 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=8.4, estimated_pct(row[35])=8.4
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 8.4
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
WARNING:main:üîç DEBUG: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
WARNING:main:üîç DEBUG: sensor_pct value: 8.4
INFO:     127.0.0.1:59752 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:54:01 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:60073 - "GET /fuelAnalytics/api/v2/fleet/patterns HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:54:06 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=8.4, estimated_pct(row[35])=8.4
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 8.4
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
WARNING:main:üîç DEBUG: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
WARNING:main:üîç DEBUG: sensor_pct value: 8.4
INFO:     127.0.0.1:60093 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:     127.0.0.1:60089 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:cache_service:‚úÖ Redis connected: redis://localhost:6379/0
WARNING:api_endpoints_async:Error analyzing oil_pump for CO0681: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for CO0681: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for CO0681: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for DO9356: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for DO9356: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for DO9356: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for DO9693: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for DO9693: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for DO9693: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for DR6664: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for DR6664: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for DR6664: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for FM3363: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for FM3363: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for GP9677: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for GP9677: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for GS5030: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for GS5030: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for JB6858: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for JB6858: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for JB6858: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for JC1282: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for JC1282: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for JC1282: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for JP3281: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for JP3281: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for JP3281: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for JR7099: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for JR7099: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for LC6799: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for LC6799: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for LC6799: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for LH1141: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for LH1141: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for MJ9547: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for MJ9547: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for MJ9547: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for MR7679: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for MR7679: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for OM7769: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for OM7769: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for RA9250: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for RA9250: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for RC6625: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for RC6625: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for RH1522: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for RH1522: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for RR1272: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for RR1272: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for RT9127: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for RT9127: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for RT9127: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for SG5760: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for SG5760: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for SG5760: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
INFO:     127.0.0.1:60494 - "GET /fuelAnalytics/api/predictive-maintenance HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:55:04 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=8.4, estimated_pct(row[35])=8.4
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 8.4
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
WARNING:main:üîç DEBUG: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
WARNING:main:üîç DEBUG: sensor_pct value: 8.4
INFO:     127.0.0.1:60500 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:     127.0.0.1:60494 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:56:01 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:60554 - "GET /fuelAnalytics/api/v2/fleet/patterns HTTP/1.1" 200 OK
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=9.6, estimated_pct(row[35])=8.4
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:56:05 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 9.6
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
WARNING:main:üîç DEBUG: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
WARNING:main:üîç DEBUG: sensor_pct value: 9.6
INFO:     127.0.0.1:60561 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:     127.0.0.1:60558 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:57:04 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=4.4, estimated_pct(row[35])=8.28
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 4.4
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
WARNING:main:üîç DEBUG: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
WARNING:main:üîç DEBUG: sensor_pct value: 4.4
INFO:     127.0.0.1:60727 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:     127.0.0.1:60725 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:58:01 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:60741 - "GET /fuelAnalytics/api/v2/fleet/patterns HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 18:58:05 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=4.4, estimated_pct(row[35])=8.21
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 4.4
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
WARNING:main:üîç DEBUG: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
WARNING:main:üîç DEBUG: sensor_pct value: 4.4
INFO:     127.0.0.1:60748 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:     127.0.0.1:60745 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
WARNING:  WatchFiles detected changes in 'tests/test_predictive_ultra_targeted.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üõë Shutting down Fuel Copilot API
INFO:lifecycle_manager:üìÖ Shutdown Time: 2025-12-28T18:58:24.769640
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üîÑ Disconnecting cache...
INFO:lifecycle_manager:‚úÖ Cache disconnected
INFO:lifecycle_manager:üîÑ Closing async database pool...
INFO:database_async:üîÑ Closing async MySQL connection pool...
INFO:database_async:‚úÖ Async MySQL connection pool closed
INFO:lifecycle_manager:‚úÖ Async DB pool closed
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:‚úÖ Clean shutdown completed
INFO:lifecycle_manager:================================================================================
INFO:     Application shutdown complete.
INFO:     Finished server process [57742]
‚ö†Ô∏è MYSQL_PASSWORD not set - database connections will fail
‚ö†Ô∏è LOCAL_DB_PASS not set - local database connections will fail
‚ö†Ô∏è  Redis cache unavailable: No module named 'redis_cache'
WARNING:  WatchFiles detected changes in 'tests/test_predictive_ultra_targeted.py'. Reloading...
/opt/anaconda3/lib/python3.12/site-packages/keras/src/export/tf2onnx_lib.py:8: FutureWarning: In the future `np.object` will be defined as the corresponding NumPy scalar.
  if not hasattr(np, "object"):
‚ö†Ô∏è MPG History router not available: No module named 'logger_config'
INFO:main:‚úÖ Driver Alerts router registered
INFO:main:‚úÖ Alerts router registered
INFO:main:‚úÖ Trucks router registered
INFO:main:‚úÖ Refuels router registered
INFO:main:‚úÖ Analytics router registered
INFO:main:‚úÖ Maintenance router registered
INFO:ekf_integration:‚úÖ EKFManager inicializado en data/ekf_states
INFO:main:‚úÖ FASE 2A: EKF Integration & Diagnostics endpoints registered
INFO:main:‚úÖ FASE 2B: ML Pipeline (LSTM + Anomaly Detection + Driver Scoring) loaded
INFO:kafka_event_bus:‚úÖ Event Bus inicializado
INFO:kafka_event_bus:‚úÖ Event Bus suscriptores inicializados
INFO:main:‚úÖ FASE 2C: Event Bus & Microservices Orchestrator loaded
INFO:main:‚úÖ New Features: Cache + WebSocket + ML + Coaching registered
INFO:main:‚úÖ API v2 router registered
INFO:main:‚úÖ FASE 2C: Route Optimization Engine loaded
INFO:main:‚úÖ Prometheus metrics enabled
INFO:main:‚úÖ Rate limiting middleware enabled
INFO:main:‚úÖ GZip compression middleware enabled
INFO:main:‚úÖ CORS configured with 5 allowed origins
INFO:main:‚úÖ Global exception handler registered
INFO:routers:‚úÖ Registered api_v2 router at /fuelAnalytics/api/v2
INFO:routers:‚úÖ Registered command_center router at /fuelAnalytics/api/command-center
INFO:main:‚úÖ All routers included successfully
INFO:routers_v3:‚úÖ Registered api_v2 router at /fuelAnalytics/api/v2
INFO:routers_v3:‚úÖ Registered sse_endpoints router
INFO:routers_v3:‚úÖ Registered fuel_stations router
INFO:routers_v3:‚úÖ Registered sensor_health_router
INFO:routers_v3:‚úÖ Registered mpg_baseline_router
INFO:routers_v3:‚úÖ Registered driver_alerts_router at /fuelAnalytics/api/v2/driver-alerts
INFO:routers_v3:üöÄ v3.12.21 routers registration complete
INFO:main:‚úÖ v3.12.21 API v2 router registered
INFO:v5_endpoints:‚úÖ V5 Endpoints registered (Fleet Analytics + Leaderboard)
INFO:main:‚úÖ V5 Clean Endpoints registered (Fleet Analytics, Leaderboard)
INFO:main:üöÄ v5.2: Using new lightweight v5 endpoints (TruckHealthMonitor disabled)
INFO:     Started server process [59161]
INFO:     Waiting for application startup.
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üöÄ Fuel Copilot API v3.12.0 STARTING...
INFO:lifecycle_manager:üìÖ Startup Time: 2025-12-28T18:58:30.447336
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üîÑ Initializing multi-layer cache...
INFO:lifecycle_manager:‚úÖ Multi-layer cache connected successfully
INFO:lifecycle_manager:üîÑ Initializing async database pool...
INFO:database_async:üîÑ Creating async MySQL connection pool...
INFO:database_async:   Host: localhost:3306
INFO:database_async:   Database: fuel_copilot_local
INFO:database_async:   Pool size: 5-20
INFO:database_async:‚úÖ Async MySQL connection pool created successfully
INFO:lifecycle_manager:‚úÖ Async DB pool initialized successfully
INFO:database_mysql:‚úÖ SQLAlchemy engine created with connection pooling (10+5 connections)
INFO:database:‚úÖ Found 22 trucks in MySQL
INFO:lifecycle_manager:Available trucks: 22
INFO:lifecycle_manager:MySQL enhanced features: enabled
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:‚úÖ API ready for connections
INFO:lifecycle_manager:================================================================================
INFO:     Application startup complete.
‚ö†Ô∏è MYSQL_PASSWORD not set - database connections will fail
‚ö†Ô∏è LOCAL_DB_PASS not set - local database connections will fail
‚ö†Ô∏è  Redis cache unavailable: No module named 'redis_cache'
/opt/anaconda3/lib/python3.12/site-packages/keras/src/export/tf2onnx_lib.py:8: FutureWarning: In the future `np.object` will be defined as the corresponding NumPy scalar.
  if not hasattr(np, "object"):
‚ö†Ô∏è MPG History router not available: No module named 'logger_config'
INFO:main:‚úÖ Driver Alerts router registered
INFO:main:‚úÖ Alerts router registered
INFO:main:‚úÖ Trucks router registered
INFO:main:‚úÖ Refuels router registered
INFO:main:‚úÖ Analytics router registered
INFO:main:‚úÖ Maintenance router registered
INFO:ekf_integration:‚úÖ EKFManager inicializado en data/ekf_states
INFO:main:‚úÖ FASE 2A: EKF Integration & Diagnostics endpoints registered
INFO:main:‚úÖ FASE 2B: ML Pipeline (LSTM + Anomaly Detection + Driver Scoring) loaded
INFO:kafka_event_bus:‚úÖ Event Bus inicializado
INFO:kafka_event_bus:‚úÖ Event Bus suscriptores inicializados
INFO:main:‚úÖ FASE 2C: Event Bus & Microservices Orchestrator loaded
INFO:main:‚úÖ New Features: Cache + WebSocket + ML + Coaching registered
INFO:main:‚úÖ API v2 router registered
INFO:main:‚úÖ FASE 2C: Route Optimization Engine loaded
INFO:main:‚úÖ Prometheus metrics enabled
INFO:main:‚úÖ Rate limiting middleware enabled
INFO:main:‚úÖ GZip compression middleware enabled
INFO:main:‚úÖ CORS configured with 5 allowed origins
INFO:main:‚úÖ Global exception handler registered
INFO:routers:‚úÖ Registered api_v2 router at /fuelAnalytics/api/v2
INFO:routers:‚úÖ Registered command_center router at /fuelAnalytics/api/command-center
INFO:main:‚úÖ All routers included successfully
INFO:routers_v3:‚úÖ Registered api_v2 router at /fuelAnalytics/api/v2
INFO:routers_v3:‚úÖ Registered sse_endpoints router
INFO:routers_v3:‚úÖ Registered fuel_stations router
INFO:routers_v3:‚úÖ Registered sensor_health_router
INFO:routers_v3:‚úÖ Registered mpg_baseline_router
INFO:routers_v3:‚úÖ Registered driver_alerts_router at /fuelAnalytics/api/v2/driver-alerts
INFO:routers_v3:üöÄ v3.12.21 routers registration complete
INFO:main:‚úÖ v3.12.21 API v2 router registered
INFO:v5_endpoints:‚úÖ V5 Endpoints registered (Fleet Analytics + Leaderboard)
INFO:main:‚úÖ V5 Clean Endpoints registered (Fleet Analytics, Leaderboard)
INFO:main:üöÄ v5.2: Using new lightweight v5 endpoints (TruckHealthMonitor disabled)
INFO:     Started server process [59394]
INFO:     Waiting for application startup.
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üöÄ Fuel Copilot API v3.12.0 STARTING...
INFO:lifecycle_manager:üìÖ Startup Time: 2025-12-28T18:58:38.961660
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üîÑ Initializing multi-layer cache...
INFO:lifecycle_manager:‚úÖ Multi-layer cache connected successfully
INFO:lifecycle_manager:üîÑ Initializing async database pool...
INFO:database_async:üîÑ Creating async MySQL connection pool...
INFO:database_async:   Host: localhost:3306
INFO:database_async:   Database: fuel_copilot_local
INFO:database_async:   Pool size: 5-20
INFO:database_async:‚úÖ Async MySQL connection pool created successfully
INFO:lifecycle_manager:‚úÖ Async DB pool initialized successfully
INFO:database_mysql:‚úÖ SQLAlchemy engine created with connection pooling (10+5 connections)
INFO:database:‚úÖ Found 22 trucks in MySQL
INFO:lifecycle_manager:Available trucks: 22
INFO:lifecycle_manager:MySQL enhanced features: enabled
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:‚úÖ API ready for connections
INFO:lifecycle_manager:================================================================================
INFO:     Application startup complete.
INFO:config:‚úÖ Loaded 45 trucks from tanks.yaml
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=4.4, estimated_pct(row[35])=8.13
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 4.4
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
‚úÖ SPN Decoder initialized with 111 SPNs
‚úÖ SPN Decoder initialized with 111 SPNs
2025-12-28 18:59:04 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
WARNING:main:üîç DEBUG: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
WARNING:main:üîç DEBUG: sensor_pct value: 4.4
INFO:     127.0.0.1:60781 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:     127.0.0.1:60778 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 19:00:01 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:60794 - "GET /fuelAnalytics/api/v2/fleet/patterns HTTP/1.1" 200 OK
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=6.4, estimated_pct(row[35])=8.05
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
INFO:cache_service:‚úÖ Redis connected: redis://localhost:6379/0
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 6.4
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
WARNING:main:üîç DEBUG: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
WARNING:main:üîç DEBUG: sensor_pct value: 6.4
INFO:     127.0.0.1:60798 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
WARNING:api_endpoints_async:Error analyzing oil_pump for CO0681: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for CO0681: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for CO0681: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for DO9356: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for DO9356: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for DO9356: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for DO9693: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for DO9693: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for DO9693: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for DR6664: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for DR6664: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for DR6664: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for FM3363: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for FM3363: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for GP9677: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for GP9677: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for GS5030: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for GS5030: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for JB6858: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for JB6858: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for JB6858: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for JC1282: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for JC1282: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for JC1282: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for JP3281: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for JP3281: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for JP3281: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for JR7099: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for JR7099: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for LC6799: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for LC6799: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for LC6799: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for LH1141: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for LH1141: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for MJ9547: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for MJ9547: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for MJ9547: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for MR7679: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for MR7679: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for OM7769: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for OM7769: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for RA9250: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for RA9250: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for RC6625: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for RC6625: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for RH1522: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for RH1522: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for RR1272: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for RR1272: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for RT9127: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for RT9127: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for RT9127: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing oil_pump for SG5760: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing coolant_pump for SG5760: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
WARNING:api_endpoints_async:Error analyzing def_pump for SG5760: 'PredictiveMaintenanceEnsemble' object has no attribute 'predict'
INFO:     127.0.0.1:60800 - "GET /fuelAnalytics/api/predictive-maintenance HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 19:00:06 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:60804 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
WARNING:  WatchFiles detected changes in 'tests/test_predictive_ultra_targeted.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üõë Shutting down Fuel Copilot API
INFO:lifecycle_manager:üìÖ Shutdown Time: 2025-12-28T19:00:13.598583
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üîÑ Disconnecting cache...
INFO:lifecycle_manager:‚úÖ Cache disconnected
INFO:lifecycle_manager:üîÑ Closing async database pool...
INFO:database_async:üîÑ Closing async MySQL connection pool...
INFO:database_async:‚úÖ Async MySQL connection pool closed
INFO:lifecycle_manager:‚úÖ Async DB pool closed
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:‚úÖ Clean shutdown completed
INFO:lifecycle_manager:================================================================================
INFO:     Application shutdown complete.
INFO:     Finished server process [59394]
‚ö†Ô∏è MYSQL_PASSWORD not set - database connections will fail
‚ö†Ô∏è LOCAL_DB_PASS not set - local database connections will fail
‚ö†Ô∏è  Redis cache unavailable: No module named 'redis_cache'
/opt/anaconda3/lib/python3.12/site-packages/keras/src/export/tf2onnx_lib.py:8: FutureWarning: In the future `np.object` will be defined as the corresponding NumPy scalar.
  if not hasattr(np, "object"):
‚ö†Ô∏è MPG History router not available: No module named 'logger_config'
INFO:main:‚úÖ Driver Alerts router registered
INFO:main:‚úÖ Alerts router registered
INFO:main:‚úÖ Trucks router registered
INFO:main:‚úÖ Refuels router registered
INFO:main:‚úÖ Analytics router registered
INFO:main:‚úÖ Maintenance router registered
INFO:ekf_integration:‚úÖ EKFManager inicializado en data/ekf_states
INFO:main:‚úÖ FASE 2A: EKF Integration & Diagnostics endpoints registered
INFO:main:‚úÖ FASE 2B: ML Pipeline (LSTM + Anomaly Detection + Driver Scoring) loaded
INFO:kafka_event_bus:‚úÖ Event Bus inicializado
INFO:kafka_event_bus:‚úÖ Event Bus suscriptores inicializados
INFO:main:‚úÖ FASE 2C: Event Bus & Microservices Orchestrator loaded
INFO:main:‚úÖ New Features: Cache + WebSocket + ML + Coaching registered
INFO:main:‚úÖ API v2 router registered
INFO:main:‚úÖ FASE 2C: Route Optimization Engine loaded
INFO:main:‚úÖ Prometheus metrics enabled
INFO:main:‚úÖ Rate limiting middleware enabled
INFO:main:‚úÖ GZip compression middleware enabled
INFO:main:‚úÖ CORS configured with 5 allowed origins
INFO:main:‚úÖ Global exception handler registered
INFO:routers:‚úÖ Registered api_v2 router at /fuelAnalytics/api/v2
INFO:routers:‚úÖ Registered command_center router at /fuelAnalytics/api/command-center
INFO:main:‚úÖ All routers included successfully
INFO:routers_v3:‚úÖ Registered api_v2 router at /fuelAnalytics/api/v2
INFO:routers_v3:‚úÖ Registered sse_endpoints router
INFO:routers_v3:‚úÖ Registered fuel_stations router
INFO:routers_v3:‚úÖ Registered sensor_health_router
INFO:routers_v3:‚úÖ Registered mpg_baseline_router
INFO:routers_v3:‚úÖ Registered driver_alerts_router at /fuelAnalytics/api/v2/driver-alerts
INFO:routers_v3:üöÄ v3.12.21 routers registration complete
INFO:main:‚úÖ v3.12.21 API v2 router registered
INFO:v5_endpoints:‚úÖ V5 Endpoints registered (Fleet Analytics + Leaderboard)
INFO:main:‚úÖ V5 Clean Endpoints registered (Fleet Analytics, Leaderboard)
INFO:main:üöÄ v5.2: Using new lightweight v5 endpoints (TruckHealthMonitor disabled)
INFO:     Started server process [59891]
INFO:     Waiting for application startup.
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üöÄ Fuel Copilot API v3.12.0 STARTING...
INFO:lifecycle_manager:üìÖ Startup Time: 2025-12-28T19:00:17.819182
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üîÑ Initializing multi-layer cache...
INFO:lifecycle_manager:‚úÖ Multi-layer cache connected successfully
INFO:lifecycle_manager:üîÑ Initializing async database pool...
INFO:database_async:üîÑ Creating async MySQL connection pool...
INFO:database_async:   Host: localhost:3306
INFO:database_async:   Database: fuel_copilot_local
INFO:database_async:   Pool size: 5-20
INFO:database_async:‚úÖ Async MySQL connection pool created successfully
INFO:lifecycle_manager:‚úÖ Async DB pool initialized successfully
INFO:database_mysql:‚úÖ SQLAlchemy engine created with connection pooling (10+5 connections)
INFO:database:‚úÖ Found 22 trucks in MySQL
INFO:lifecycle_manager:Available trucks: 22
INFO:lifecycle_manager:MySQL enhanced features: enabled
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:‚úÖ API ready for connections
INFO:lifecycle_manager:================================================================================
INFO:     Application startup complete.
INFO:config:‚úÖ Loaded 45 trucks from tanks.yaml
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=6.4, estimated_pct(row[35])=8.02
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
‚úÖ SPN Decoder initialized with 111 SPNs
‚úÖ SPN Decoder initialized with 111 SPNs
2025-12-28 19:01:04 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 6.4
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
WARNING:main:üîç DEBUG: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
WARNING:main:üîç DEBUG: sensor_pct value: 6.4
INFO:     127.0.0.1:60823 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:     127.0.0.1:60821 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 19:02:01 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:60831 - "GET /fuelAnalytics/api/v2/fleet/patterns HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 19:02:06 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=9.6, estimated_pct(row[35])=8.06
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 9.6
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
WARNING:main:üîç DEBUG: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
WARNING:main:üîç DEBUG: sensor_pct value: 9.6
INFO:     127.0.0.1:60858 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:     127.0.0.1:60835 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 19:03:04 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=9.6, estimated_pct(row[35])=8.09
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 9.6
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
WARNING:main:üîç DEBUG: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
WARNING:main:üîç DEBUG: sensor_pct value: 9.6
INFO:     127.0.0.1:60879 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:     127.0.0.1:60876 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 19:04:04 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=9.6, estimated_pct(row[35])=8.12
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 9.6
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
WARNING:main:üîç DEBUG: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
WARNING:main:üîç DEBUG: sensor_pct value: 9.6
INFO:     127.0.0.1:60891 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:     127.0.0.1:60889 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 19:04:09 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:60897 - "GET /fuelAnalytics/api/v2/fleet/patterns HTTP/1.1" 200 OK
INFO:cache_service:‚úÖ Redis connected: redis://localhost:6379/0
INFO:     127.0.0.1:60908 - "GET /fuelAnalytics/api/predictive-maintenance HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 19:05:04 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=9.6, estimated_pct(row[35])=8.15
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 9.6
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
WARNING:main:üîç DEBUG: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
WARNING:main:üîç DEBUG: sensor_pct value: 9.6
INFO:     127.0.0.1:60912 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:     127.0.0.1:60908 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 19:06:04 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=45.6, estimated_pct(row[35])=45.6
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 45.6
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
WARNING:main:üîç DEBUG: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
WARNING:main:üîç DEBUG: sensor_pct value: 45.6
INFO:     127.0.0.1:60924 - "GET /fuelAnalytics/api/v2/fleet/health/advanced HTTP/1.1" 200 OK
INFO:     127.0.0.1:60921 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 19:06:08 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:60930 - "GET /fuelAnalytics/api/v2/fleet/patterns HTTP/1.1" 200 OK
INFO:     127.0.0.1:60937 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:routers.cost_router:Starting cost per mile analysis for 30 days
INFO:cost_per_mile_engine:‚úÖ CostPerMileEngine initialized
WARNING:routers.cost_router:DB query failed, using fallback: (pymysql.err.OperationalError) (1054, "Unknown column 'timestamp_utc' in 'where clause'")
[SQL: 
            SELECT 
                fm.truck_id,
                COUNT(*) as readings,
                COUNT(DISTINCT DATE(fm.timestamp_utc)) as active_days,
                -- Total fuel consumed from consumption_gph (15-second intervals = 0.25/60 hours)
                SUM(CASE WHEN fm.consumption_gph > 0 THEN fm.consumption_gph * (15.0/3600.0) ELSE 0 END) as estimated_gallons,
                -- Fuel consumed while IDLE (engine on, not moving)
                SUM(CASE WHEN fm.truck_status = 'STOPPED' AND fm.idle_gph > 0 THEN fm.idle_gph * (15.0/3600.0) ELSE 0 END) as idle_gallons,
                -- Miles calculated from speed * time (15-second intervals)
                SUM(CASE WHEN fm.speed_mph > 5 THEN fm.speed_mph * (15.0/3600.0) ELSE 0 END) as calculated_miles,
                -- Time spent driving (15-second intervals = 0.25 minutes each)
                SUM(CASE WHEN fm.speed_mph > 5 THEN 0.25 ELSE 0 END) as driving_minutes,
                -- Average speed when driving
                AVG(CASE WHEN fm.speed_mph > 10 THEN fm.speed_mph END) as avg_speed,
                -- Sum from refuel events if available
                COALESCE(ref.total_gallons, 0) as refuel_gallons
            FROM fuel_metrics fm
            LEFT JOIN (
                SELECT truck_id, SUM(gallons_added) as total_gallons
                FROM refuel_events
                WHERE timestamp_utc >= DATE_SUB(UTC_TIMESTAMP(), INTERVAL %(days)s DAY)
                GROUP BY truck_id
            ) ref ON fm.truck_id = ref.truck_id
            WHERE fm.timestamp_utc >= DATE_SUB(UTC_TIMESTAMP(), INTERVAL %(days)s DAY)
            GROUP BY fm.truck_id
            HAVING active_days >= 1
        ]
[parameters: {'days': 30}]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
INFO:routers.cost_router:No historical data, using current truck data for estimates
INFO:database:‚úÖ Found 22 trucks in MySQL
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for CO0681
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for DO9356
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for DO9693
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for DR6664
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for FF7702
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for FM3363
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for GP9677
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for JB6858
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for JC1282
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for JP3281
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for JR7099
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for LC6799
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for MJ9547
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for MO0195
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for MR7679
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for OM7769
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for PC1280
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for RH1522
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for RR1272
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for RT9127
INFO:cost_per_mile_engine:Fleet totals: miles=160000, gallons=nan, engine_hours=nan, fuel_cost=$nan
INFO:cost_per_mile_engine:Cost breakdown: fuel_cpm=$nan, maint_cpm=$nan, tire_cpm=$0.0700, depr_cpm=$0.1500, total_cpm=$nan
INFO:fleet_utilization_engine:‚úÖ FleetUtilizationEngine initialized
INFO:     127.0.0.1:60937 - "GET /fuelAnalytics/api/cost/per-mile?days=30 HTTP/1.1" 200 OK
INFO:     127.0.0.1:60947 - "GET /fuelAnalytics/api/utilization/fleet?days=30 HTTP/1.1" 200 OK
INFO:     127.0.0.1:60949 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:routers.cost_router:Starting cost per mile analysis for 30 days
INFO:cost_per_mile_engine:‚úÖ CostPerMileEngine initialized
WARNING:routers.cost_router:DB query failed, using fallback: (pymysql.err.OperationalError) (1054, "Unknown column 'timestamp_utc' in 'where clause'")
[SQL: 
            SELECT 
                fm.truck_id,
                COUNT(*) as readings,
                COUNT(DISTINCT DATE(fm.timestamp_utc)) as active_days,
                -- Total fuel consumed from consumption_gph (15-second intervals = 0.25/60 hours)
                SUM(CASE WHEN fm.consumption_gph > 0 THEN fm.consumption_gph * (15.0/3600.0) ELSE 0 END) as estimated_gallons,
                -- Fuel consumed while IDLE (engine on, not moving)
                SUM(CASE WHEN fm.truck_status = 'STOPPED' AND fm.idle_gph > 0 THEN fm.idle_gph * (15.0/3600.0) ELSE 0 END) as idle_gallons,
                -- Miles calculated from speed * time (15-second intervals)
                SUM(CASE WHEN fm.speed_mph > 5 THEN fm.speed_mph * (15.0/3600.0) ELSE 0 END) as calculated_miles,
                -- Time spent driving (15-second intervals = 0.25 minutes each)
                SUM(CASE WHEN fm.speed_mph > 5 THEN 0.25 ELSE 0 END) as driving_minutes,
                -- Average speed when driving
                AVG(CASE WHEN fm.speed_mph > 10 THEN fm.speed_mph END) as avg_speed,
                -- Sum from refuel events if available
                COALESCE(ref.total_gallons, 0) as refuel_gallons
            FROM fuel_metrics fm
            LEFT JOIN (
                SELECT truck_id, SUM(gallons_added) as total_gallons
                FROM refuel_events
                WHERE timestamp_utc >= DATE_SUB(UTC_TIMESTAMP(), INTERVAL %(days)s DAY)
                GROUP BY truck_id
            ) ref ON fm.truck_id = ref.truck_id
            WHERE fm.timestamp_utc >= DATE_SUB(UTC_TIMESTAMP(), INTERVAL %(days)s DAY)
            GROUP BY fm.truck_id
            HAVING active_days >= 1
        ]
[parameters: {'days': 30}]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
INFO:routers.cost_router:No historical data, using current truck data for estimates
INFO:database:‚úÖ Found 22 trucks in MySQL
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for CO0681
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for DO9356
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for DO9693
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for DR6664
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for FF7702
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for FM3363
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for GP9677
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for JB6858
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for JC1282
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for JP3281
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for JR7099
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for LC6799
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for MJ9547
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for MO0195
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for MR7679
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for OM7769
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for PC1280
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for RH1522
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for RR1272
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for RT9127
INFO:cost_per_mile_engine:Fleet totals: miles=160000, gallons=nan, engine_hours=nan, fuel_cost=$nan
INFO:cost_per_mile_engine:Cost breakdown: fuel_cpm=$nan, maint_cpm=$nan, tire_cpm=$0.0700, depr_cpm=$0.1500, total_cpm=$nan
INFO:database_mysql:‚úÖ KPIs calculated from MySQL: 27 trucks, 18175 records, 30d period
INFO:     127.0.0.1:60951 - "GET /fuelAnalytics/api/analytics/enhanced-loss-analysis?days=7 HTTP/1.1" 200 OK
INFO:fleet_utilization_engine:‚úÖ FleetUtilizationEngine initialized
INFO:     127.0.0.1:60937 - "GET /fuelAnalytics/api/cost/per-mile?days=30 HTTP/1.1" 200 OK
INFO:     127.0.0.1:60954 - "GET /fuelAnalytics/api/kpis?days=30 HTTP/1.1" 200 OK
INFO:fleet_command_center:‚úÖ Loaded configuration from command_center_config.yaml
INFO:fleet_command_center:‚úÖ Loaded 11 config values from database
INFO:fleet_command_center:‚úÖ Connected to Redis at redis://localhost:6379/0
INFO:predictive_maintenance_engine:‚úÖ MySQL available for Predictive Maintenance persistence
INFO:predictive_maintenance_engine:‚úÖ MySQL PM tables verified
INFO:predictive_maintenance_engine:üìÇ Loaded 369021 readings for 1563 trucks from MySQL
INFO:predictive_maintenance_engine:üîÆ PredictiveMaintenanceEngine v1.1.0 initialized (MySQL storage)
INFO:ml_engines.anomaly_detector:Analyzing anomalies for 45 trucks...
INFO:ml_engines.anomaly_detector:ML: Fetched 592 rows for DR6664 (last 30 days)
INFO:ml_engines.anomaly_detector:ML: Fetched 92 rows for DR6664 (last 1 days)
INFO:ml_engines.anomaly_detector:ML: Fetched 211 rows for GS5030 (last 30 days)
INFO:ml_engines.anomaly_detector:ML: Fetched 0 rows for GS5030 (last 1 days)
INFO:ml_engines.anomaly_detector:ML: Fetched 0 rows for RD5229 (last 30 days)
INFO:ml_engines.anomaly_detector:ML: Fetched 414 rows for JB6858 (last 30 days)
INFO:ml_engines.anomaly_detector:ML: Fetched 192 rows for JB6858 (last 1 days)
INFO:ml_engines.anomaly_detector:ML: Fetched 535 rows for MJ9547 (last 30 days)
INFO:ml_engines.anomaly_detector:ML: Fetched 79 rows for MJ9547 (last 1 days)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:149: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  rpm_factor = np.maximum(df["rpm"].fillna(1000) / 1000, 0.5)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:151: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  df["oil_pressure_psi"].fillna(35) / rpm_factor
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:156: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  oil_temp = df["oil_temp_f"].fillna(200).replace(0, 200)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:157: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  features["coolant_oil_ratio"] = df["coolant_temp_f"].fillna(180) / oil_temp
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:161: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  features["temp_delta"] = df["oil_temp_f"].fillna(200) - df[
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:163: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  ].fillna(180)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:166: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  features["consumption_rate"] = df["consumption_gph"].fillna(3).clip(0, 20)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:170: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  engine_hrs = df["engine_hours"].fillna(1).replace(0, 1)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:171: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  idle_hrs = df["idle_hours"].fillna(0)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:178: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  .fillna(35)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:187: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  rpm_safe = df["rpm"].fillna(1500).replace(0, 1500)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:188: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  features["rpm_efficiency"] = df["speed_mph"].fillna(0) / (rpm_safe / 1000)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:193: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  df["oil_temp_f"].fillna(200).diff().fillna(0).clip(-10, 10)
INFO:ml_engines.anomaly_detector:ML: Fetched 189 rows for RC6625 (last 30 days)
INFO:ml_engines.anomaly_detector:ML: Fetched 0 rows for RC6625 (last 1 days)
INFO:ml_engines.anomaly_detector:ML: Fetched 0 rows for BV6395 (last 30 days)
INFO:ml_engines.anomaly_detector:ML: Fetched 0 rows for OG2033 (last 30 days)
INFO:ml_engines.anomaly_detector:ML: Fetched 0 rows for JB8004 (last 30 days)
INFO:ml_engines.anomaly_detector:ML: Fetched 791 rows for DO9693 (last 30 days)
INFO:ml_engines.anomaly_detector:ML: Fetched 177 rows for DO9693 (last 1 days)
INFO:ml_engines.anomaly_detector:ML: Fetched 1320 rows for CO0681 (last 30 days)
INFO:ml_engines.anomaly_detector:ML: Fetched 247 rows for CO0681 (last 1 days)
INFO:ml_engines.anomaly_detector:ML: Fetched 972 rows for JC1282 (last 30 days)
INFO:ml_engines.anomaly_detector:ML: Fetched 49 rows for JC1282 (last 1 days)
INFO:ml_engines.anomaly_detector:ML: Fetched 513 rows for VD3579 (last 30 days)
INFO:ml_engines.anomaly_detector:ML: Fetched 81 rows for VD3579 (last 1 days)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:149: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  rpm_factor = np.maximum(df["rpm"].fillna(1000) / 1000, 0.5)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:151: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  df["oil_pressure_psi"].fillna(35) / rpm_factor
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:156: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  oil_temp = df["oil_temp_f"].fillna(200).replace(0, 200)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:157: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  features["coolant_oil_ratio"] = df["coolant_temp_f"].fillna(180) / oil_temp
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:161: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  features["temp_delta"] = df["oil_temp_f"].fillna(200) - df[
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:163: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  ].fillna(180)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:166: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  features["consumption_rate"] = df["consumption_gph"].fillna(3).clip(0, 20)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:170: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  engine_hrs = df["engine_hours"].fillna(1).replace(0, 1)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:171: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  idle_hrs = df["idle_hours"].fillna(0)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:178: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  .fillna(35)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:187: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  rpm_safe = df["rpm"].fillna(1500).replace(0, 1500)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:188: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  features["rpm_efficiency"] = df["speed_mph"].fillna(0) / (rpm_safe / 1000)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:193: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  df["oil_temp_f"].fillna(200).diff().fillna(0).clip(-10, 10)
INFO:ml_engines.anomaly_detector:ML: Fetched 0 rows for FM3679 (last 30 days)
INFO:ml_engines.anomaly_detector:ML: Fetched 218 rows for MO0195 (last 30 days)
INFO:ml_engines.anomaly_detector:ML: Fetched 79 rows for MO0195 (last 1 days)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:149: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  rpm_factor = np.maximum(df["rpm"].fillna(1000) / 1000, 0.5)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:151: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  df["oil_pressure_psi"].fillna(35) / rpm_factor
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:156: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  oil_temp = df["oil_temp_f"].fillna(200).replace(0, 200)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:157: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  features["coolant_oil_ratio"] = df["coolant_temp_f"].fillna(180) / oil_temp
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:161: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  features["temp_delta"] = df["oil_temp_f"].fillna(200) - df[
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:163: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  ].fillna(180)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:166: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  features["consumption_rate"] = df["consumption_gph"].fillna(3).clip(0, 20)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:170: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  engine_hrs = df["engine_hours"].fillna(1).replace(0, 1)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:171: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  idle_hrs = df["idle_hours"].fillna(0)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:178: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  .fillna(35)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:187: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  rpm_safe = df["rpm"].fillna(1500).replace(0, 1500)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:188: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  features["rpm_efficiency"] = df["speed_mph"].fillna(0) / (rpm_safe / 1000)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:193: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  df["oil_temp_f"].fillna(200).diff().fillna(0).clip(-10, 10)
INFO:ml_engines.anomaly_detector:ML: Fetched 0 rows for EM8514 (last 30 days)
INFO:ml_engines.anomaly_detector:ML: Fetched 0 rows for GC9751 (last 30 days)
INFO:ml_engines.anomaly_detector:ML: Fetched 645 rows for JR7099 (last 30 days)
INFO:ml_engines.anomaly_detector:ML: Fetched 79 rows for JR7099 (last 1 days)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:149: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  rpm_factor = np.maximum(df["rpm"].fillna(1000) / 1000, 0.5)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:151: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  df["oil_pressure_psi"].fillna(35) / rpm_factor
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:156: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  oil_temp = df["oil_temp_f"].fillna(200).replace(0, 200)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:157: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  features["coolant_oil_ratio"] = df["coolant_temp_f"].fillna(180) / oil_temp
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:161: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  features["temp_delta"] = df["oil_temp_f"].fillna(200) - df[
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:163: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  ].fillna(180)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:166: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  features["consumption_rate"] = df["consumption_gph"].fillna(3).clip(0, 20)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:170: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  engine_hrs = df["engine_hours"].fillna(1).replace(0, 1)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:171: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  idle_hrs = df["idle_hours"].fillna(0)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:178: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  .fillna(35)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:187: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  rpm_safe = df["rpm"].fillna(1500).replace(0, 1500)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:188: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  features["rpm_efficiency"] = df["speed_mph"].fillna(0) / (rpm_safe / 1000)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:193: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  df["oil_temp_f"].fillna(200).diff().fillna(0).clip(-10, 10)
INFO:ml_engines.anomaly_detector:ML: Fetched 1119 rows for SG5760 (last 30 days)
INFO:ml_engines.anomaly_detector:ML: Fetched 35 rows for SG5760 (last 1 days)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:156: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  oil_temp = df["oil_temp_f"].fillna(200).replace(0, 200)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:161: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  features["temp_delta"] = df["oil_temp_f"].fillna(200) - df[
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:171: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  idle_hrs = df["idle_hours"].fillna(0)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:193: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  df["oil_temp_f"].fillna(200).diff().fillna(0).clip(-10, 10)
INFO:ml_engines.anomaly_detector:ML: Fetched 0 rows for RR3094 (last 30 days)
INFO:ml_engines.anomaly_detector:ML: Fetched 1785 rows for MR7679 (last 30 days)
INFO:ml_engines.anomaly_detector:ML: Fetched 330 rows for MR7679 (last 1 days)
INFO:ml_engines.anomaly_detector:ML: Fetched 509 rows for FM3363 (last 30 days)
INFO:ml_engines.anomaly_detector:ML: Fetched 65 rows for FM3363 (last 1 days)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:149: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  rpm_factor = np.maximum(df["rpm"].fillna(1000) / 1000, 0.5)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:166: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  features["consumption_rate"] = df["consumption_gph"].fillna(3).clip(0, 20)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:170: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  engine_hrs = df["engine_hours"].fillna(1).replace(0, 1)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:171: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  idle_hrs = df["idle_hours"].fillna(0)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:187: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  rpm_safe = df["rpm"].fillna(1500).replace(0, 1500)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:188: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  features["rpm_efficiency"] = df["speed_mph"].fillna(0) / (rpm_safe / 1000)
INFO:ml_engines.anomaly_detector:ML: Fetched 0 rows for FM2416 (last 30 days)
INFO:ml_engines.anomaly_detector:ML: Fetched 0 rows for MA8159 (last 30 days)
INFO:ml_engines.anomaly_detector:ML: Fetched 154 rows for RT9127 (last 30 days)
INFO:ml_engines.anomaly_detector:ML: Fetched 2 rows for RT9127 (last 1 days)
INFO:ml_engines.anomaly_detector:ML: Fetched 510 rows for FF7702 (last 30 days)
INFO:ml_engines.anomaly_detector:ML: Fetched 81 rows for FF7702 (last 1 days)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:149: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  rpm_factor = np.maximum(df["rpm"].fillna(1000) / 1000, 0.5)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:151: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  df["oil_pressure_psi"].fillna(35) / rpm_factor
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:156: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  oil_temp = df["oil_temp_f"].fillna(200).replace(0, 200)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:157: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  features["coolant_oil_ratio"] = df["coolant_temp_f"].fillna(180) / oil_temp
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:161: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  features["temp_delta"] = df["oil_temp_f"].fillna(200) - df[
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:163: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  ].fillna(180)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:166: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  features["consumption_rate"] = df["consumption_gph"].fillna(3).clip(0, 20)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:170: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  engine_hrs = df["engine_hours"].fillna(1).replace(0, 1)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:171: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  idle_hrs = df["idle_hours"].fillna(0)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:178: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  .fillna(35)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:187: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  rpm_safe = df["rpm"].fillna(1500).replace(0, 1500)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:188: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  features["rpm_efficiency"] = df["speed_mph"].fillna(0) / (rpm_safe / 1000)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:193: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  df["oil_temp_f"].fillna(200).diff().fillna(0).clip(-10, 10)
INFO:ml_engines.anomaly_detector:ML: Fetched 1097 rows for RR1272 (last 30 days)
INFO:ml_engines.anomaly_detector:ML: Fetched 79 rows for RR1272 (last 1 days)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:149: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  rpm_factor = np.maximum(df["rpm"].fillna(1000) / 1000, 0.5)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:151: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  df["oil_pressure_psi"].fillna(35) / rpm_factor
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:156: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  oil_temp = df["oil_temp_f"].fillna(200).replace(0, 200)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:157: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  features["coolant_oil_ratio"] = df["coolant_temp_f"].fillna(180) / oil_temp
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:161: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  features["temp_delta"] = df["oil_temp_f"].fillna(200) - df[
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:163: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  ].fillna(180)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:166: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  features["consumption_rate"] = df["consumption_gph"].fillna(3).clip(0, 20)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:170: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  engine_hrs = df["engine_hours"].fillna(1).replace(0, 1)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:171: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  idle_hrs = df["idle_hours"].fillna(0)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:178: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  .fillna(35)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:187: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  rpm_safe = df["rpm"].fillna(1500).replace(0, 1500)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:188: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  features["rpm_efficiency"] = df["speed_mph"].fillna(0) / (rpm_safe / 1000)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:193: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  df["oil_temp_f"].fillna(200).diff().fillna(0).clip(-10, 10)
INFO:ml_engines.anomaly_detector:ML: Fetched 0 rows for LV1422 (last 30 days)
INFO:ml_engines.anomaly_detector:ML: Fetched 458 rows for RA9250 (last 30 days)
INFO:ml_engines.anomaly_detector:ML: Fetched 0 rows for RA9250 (last 1 days)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:151: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  df["oil_pressure_psi"].fillna(35) / rpm_factor
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:178: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  .fillna(35)
INFO:ml_engines.anomaly_detector:ML: Fetched 692 rows for DO9356 (last 30 days)
INFO:ml_engines.anomaly_detector:ML: Fetched 78 rows for DO9356 (last 1 days)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:149: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  rpm_factor = np.maximum(df["rpm"].fillna(1000) / 1000, 0.5)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:166: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  features["consumption_rate"] = df["consumption_gph"].fillna(3).clip(0, 20)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:170: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  engine_hrs = df["engine_hours"].fillna(1).replace(0, 1)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:171: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  idle_hrs = df["idle_hours"].fillna(0)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:187: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  rpm_safe = df["rpm"].fillna(1500).replace(0, 1500)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:188: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  features["rpm_efficiency"] = df["speed_mph"].fillna(0) / (rpm_safe / 1000)
INFO:ml_engines.anomaly_detector:ML: Fetched 1097 rows for JP3281 (last 30 days)
INFO:ml_engines.anomaly_detector:ML: Fetched 205 rows for JP3281 (last 1 days)
INFO:ml_engines.anomaly_detector:ML: Fetched 1002 rows for RH1522 (last 30 days)
INFO:ml_engines.anomaly_detector:ML: Fetched 79 rows for RH1522 (last 1 days)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:149: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  rpm_factor = np.maximum(df["rpm"].fillna(1000) / 1000, 0.5)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:151: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  df["oil_pressure_psi"].fillna(35) / rpm_factor
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:156: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  oil_temp = df["oil_temp_f"].fillna(200).replace(0, 200)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:157: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  features["coolant_oil_ratio"] = df["coolant_temp_f"].fillna(180) / oil_temp
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:161: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  features["temp_delta"] = df["oil_temp_f"].fillna(200) - df[
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:163: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  ].fillna(180)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:166: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  features["consumption_rate"] = df["consumption_gph"].fillna(3).clip(0, 20)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:170: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  engine_hrs = df["engine_hours"].fillna(1).replace(0, 1)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:171: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  idle_hrs = df["idle_hours"].fillna(0)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:178: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  .fillna(35)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:187: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  rpm_safe = df["rpm"].fillna(1500).replace(0, 1500)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:188: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  features["rpm_efficiency"] = df["speed_mph"].fillna(0) / (rpm_safe / 1000)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:193: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  df["oil_temp_f"].fillna(200).diff().fillna(0).clip(-10, 10)
INFO:ml_engines.anomaly_detector:ML: Fetched 0 rows for FS7166 (last 30 days)
INFO:ml_engines.anomaly_detector:ML: Fetched 57 rows for LH1141 (last 30 days)
INFO:ml_engines.anomaly_detector:ML: Fetched 0 rows for LH1141 (last 1 days)
INFO:ml_engines.anomaly_detector:ML: Fetched 0 rows for CS8087 (last 30 days)
INFO:ml_engines.anomaly_detector:ML: Fetched 3 rows for NQ6975 (last 30 days)
INFO:ml_engines.anomaly_detector:ML: Fetched 0 rows for FM9838 (last 30 days)
INFO:ml_engines.anomaly_detector:ML: Fetched 0 rows for OS3717 (last 30 days)
INFO:ml_engines.anomaly_detector:ML: Fetched 0 rows for JC9352 (last 30 days)
INFO:ml_engines.anomaly_detector:ML: Fetched 509 rows for PC1280 (last 30 days)
INFO:ml_engines.anomaly_detector:ML: Fetched 79 rows for PC1280 (last 1 days)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:149: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  rpm_factor = np.maximum(df["rpm"].fillna(1000) / 1000, 0.5)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:151: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  df["oil_pressure_psi"].fillna(35) / rpm_factor
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:156: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  oil_temp = df["oil_temp_f"].fillna(200).replace(0, 200)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:157: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  features["coolant_oil_ratio"] = df["coolant_temp_f"].fillna(180) / oil_temp
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:161: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  features["temp_delta"] = df["oil_temp_f"].fillna(200) - df[
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:163: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  ].fillna(180)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:166: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  features["consumption_rate"] = df["consumption_gph"].fillna(3).clip(0, 20)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:170: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  engine_hrs = df["engine_hours"].fillna(1).replace(0, 1)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:171: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  idle_hrs = df["idle_hours"].fillna(0)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:178: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  .fillna(35)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:187: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  rpm_safe = df["rpm"].fillna(1500).replace(0, 1500)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:188: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  features["rpm_efficiency"] = df["speed_mph"].fillna(0) / (rpm_safe / 1000)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:193: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  df["oil_temp_f"].fillna(200).diff().fillna(0).clip(-10, 10)
INFO:ml_engines.anomaly_detector:ML: Fetched 0 rows for YM6023 (last 30 days)
INFO:ml_engines.anomaly_detector:ML: Fetched 1723 rows for LC6799 (last 30 days)
INFO:ml_engines.anomaly_detector:ML: Fetched 302 rows for LC6799 (last 1 days)
INFO:ml_engines.anomaly_detector:ML: Fetched 511 rows for GP9677 (last 30 days)
INFO:ml_engines.anomaly_detector:ML: Fetched 80 rows for GP9677 (last 1 days)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:149: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  rpm_factor = np.maximum(df["rpm"].fillna(1000) / 1000, 0.5)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:151: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  df["oil_pressure_psi"].fillna(35) / rpm_factor
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:156: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  oil_temp = df["oil_temp_f"].fillna(200).replace(0, 200)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:157: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  features["coolant_oil_ratio"] = df["coolant_temp_f"].fillna(180) / oil_temp
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:161: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  features["temp_delta"] = df["oil_temp_f"].fillna(200) - df[
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:163: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  ].fillna(180)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:166: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  features["consumption_rate"] = df["consumption_gph"].fillna(3).clip(0, 20)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:170: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  engine_hrs = df["engine_hours"].fillna(1).replace(0, 1)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:171: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  idle_hrs = df["idle_hours"].fillna(0)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:178: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  .fillna(35)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:187: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  rpm_safe = df["rpm"].fillna(1500).replace(0, 1500)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:188: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  features["rpm_efficiency"] = df["speed_mph"].fillna(0) / (rpm_safe / 1000)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:193: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  df["oil_temp_f"].fillna(200).diff().fillna(0).clip(-10, 10)
INFO:ml_engines.anomaly_detector:ML: Fetched 0 rows for NP1082 (last 30 days)
INFO:ml_engines.anomaly_detector:ML: Fetched 549 rows for OM7769 (last 30 days)
INFO:ml_engines.anomaly_detector:ML: Fetched 78 rows for OM7769 (last 1 days)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:149: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  rpm_factor = np.maximum(df["rpm"].fillna(1000) / 1000, 0.5)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:151: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  df["oil_pressure_psi"].fillna(35) / rpm_factor
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:156: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  oil_temp = df["oil_temp_f"].fillna(200).replace(0, 200)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:157: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  features["coolant_oil_ratio"] = df["coolant_temp_f"].fillna(180) / oil_temp
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:161: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  features["temp_delta"] = df["oil_temp_f"].fillna(200) - df[
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:163: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  ].fillna(180)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:166: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  features["consumption_rate"] = df["consumption_gph"].fillna(3).clip(0, 20)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:170: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  engine_hrs = df["engine_hours"].fillna(1).replace(0, 1)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:171: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  idle_hrs = df["idle_hours"].fillna(0)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:178: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  .fillna(35)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:187: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  rpm_safe = df["rpm"].fillna(1500).replace(0, 1500)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:188: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  features["rpm_efficiency"] = df["speed_mph"].fillna(0) / (rpm_safe / 1000)
/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/ml_engines/anomaly_detector.py:193: FutureWarning: Downcasting object dtype arrays on .fillna, .ffill, .bfill is deprecated and will change in a future version. Call result.infer_objects(copy=False) instead. To opt-in to the future behavior, set `pd.set_option('future.no_silent_downcasting', True)`
  df["oil_temp_f"].fillna(200).diff().fillna(0).clip(-10, 10)
INFO:ml_engines.anomaly_detector:‚úÖ Fleet anomaly analysis complete. 45 trucks analyzed.
INFO:database_mysql:[SensorHealth] Trucks: 21, Voltage: 3, DTC: 1, GPS: 0, Oil: 3, DEF: 0, Overload: 0
INFO:database_mysql:[SensorIssues] Found: oil=3, def=0, voltage=3
INFO:fleet_command_center:üìä Loaded 3 alerts from engine_health_alerts table
INFO:fleet_command_center:üß† Real-Time Predictive: 1 cr√≠ticos, 3 warnings de 19 trucks
INFO:fleet_command_center:üîÑ Deduplicated 32 ‚Üí 30 action items (2 duplicates merged)
INFO:fleet_command_center:‚ö†Ô∏è Systemic issue detected: 129% of fleet affected. Penalty: -43.4 points
INFO:fleet_command_center:üö® 3 trucks in critical state. Penalty: -12 points
INFO:     127.0.0.1:60947 - "GET /fuelAnalytics/api/utilization/fleet?days=30 HTTP/1.1" 200 OK
INFO:     127.0.0.1:60949 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:     127.0.0.1:60951 - "GET /fuelAnalytics/api/analytics/enhanced-loss-analysis?days=7 HTTP/1.1" 200 OK
INFO:     127.0.0.1:60952 - "GET /fuelAnalytics/api/command-center/dashboard HTTP/1.1" 200 OK
INFO:database_mysql:‚úÖ KPIs calculated from MySQL: 27 trucks, 18175 records, 7d period
INFO:     127.0.0.1:60957 - "GET /fuelAnalytics/api/kpis?days=7 HTTP/1.1" 200 OK
INFO:     127.0.0.1:60952 - "GET /fuelAnalytics/api/command-center/dashboard HTTP/1.1" 200 OK
INFO:database_mysql:‚úÖ KPIs calculated from MySQL: 27 trucks, 18175 records, 14d period
INFO:     127.0.0.1:60959 - "GET /fuelAnalytics/api/kpis?days=14 HTTP/1.1" 200 OK
INFO:     127.0.0.1:60961 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 45.6
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
INFO:     127.0.0.1:60949 - "GET /fuelAnalytics/api/analytics/next-refuel-prediction HTTP/1.1" 200 OK
INFO:theft_detection_engine:üîç Starting advanced theft analysis for last 7 days...
INFO:theft_detection_engine:üìä Found 16 significant drops from local DB
INFO:theft_detection_engine:üì¶ Loading trips for 7 units...
INFO:theft_detection_engine:üì¶ Loaded trips for 7 units
INFO:theft_detection_engine:üîÑ Analyzing 16 drops...
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=45.6, estimated_pct(row[35])=45.6
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 45.6
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
INFO:gamification_engine:‚úÖ GamificationEngine initialized
INFO:     127.0.0.1:60949 - "GET /fuelAnalytics/api/analytics/next-refuel-prediction HTTP/1.1" 200 OK
INFO:     127.0.0.1:60947 - "GET /fuelAnalytics/api/gamification/leaderboard HTTP/1.1" 200 OK
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 45.6
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
INFO:     127.0.0.1:60952 - "GET /fuelAnalytics/api/theft-analysis?days=7 HTTP/1.1" 200 OK
INFO:     127.0.0.1:60949 - "GET /fuelAnalytics/api/analytics/next-refuel-prediction HTTP/1.1" 200 OK
INFO:     127.0.0.1:60951 - "GET /fuelAnalytics/api/refuels/analytics?days=7 HTTP/1.1" 200 OK
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 45.6
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
INFO:driver_behavior_engine:[BehaviorEngine] No in-memory state, loading from database...
INFO:     127.0.0.1:60949 - "GET /fuelAnalytics/api/analytics/next-refuel-prediction HTTP/1.1" 200 OK
INFO:     127.0.0.1:60947 - "GET /fuelAnalytics/api/v2/behavior/fleet HTTP/1.1" 200 OK
INFO:     127.0.0.1:60952 - "GET /fuelAnalytics/api/theft-analysis?days=7 HTTP/1.1" 200 OK
INFO:     127.0.0.1:60951 - "GET /fuelAnalytics/api/refuels/analytics?days=7 HTTP/1.1" 200 OK
INFO:     127.0.0.1:60952 - "GET /fuelAnalytics/api/theft-analysis?days=7 HTTP/1.1" 200 OK
INFO:     127.0.0.1:60951 - "GET /fuelAnalytics/api/refuels/analytics?days=7 HTTP/1.1" 200 OK
INFO:database_mysql:[DriverScorecard] Filtered 26 -> 26 drivers (threshold: 10 records)
INFO:     127.0.0.1:60947 - "GET /fuelAnalytics/api/analytics/driver-scorecard?days=7&include_tips=true&include_history=false&language=en HTTP/1.1" 200 OK
INFO:     127.0.0.1:60952 - "GET /fuelAnalytics/api/theft-analysis?days=7 HTTP/1.1" 200 OK
INFO:     127.0.0.1:60951 - "GET /fuelAnalytics/api/refuels/analytics?days=7 HTTP/1.1" 200 OK
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=85.2, estimated_pct(row[35])=50.96
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 85.2
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
INFO:     127.0.0.1:60974 - "GET /fuelAnalytics/api/analytics/next-refuel-prediction HTTP/1.1" 200 OK
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=85.2, estimated_pct(row[35])=58.25
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 85.2
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
INFO:     127.0.0.1:61034 - "GET /fuelAnalytics/api/analytics/next-refuel-prediction HTTP/1.1" 200 OK
INFO:theft_detection_engine:üîç Starting advanced theft analysis for last 7 days...
INFO:theft_detection_engine:üìä Found 16 significant drops from local DB
INFO:theft_detection_engine:üì¶ Loading trips for 7 units...
INFO:theft_detection_engine:üì¶ Loaded trips for 7 units
INFO:theft_detection_engine:üîÑ Analyzing 16 drops...
INFO:     127.0.0.1:61031 - "GET /fuelAnalytics/api/refuels/analytics?days=7 HTTP/1.1" 200 OK
INFO:     127.0.0.1:61032 - "GET /fuelAnalytics/api/theft-analysis?days=7 HTTP/1.1" 200 OK
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=88.0, estimated_pct(row[35])=63.2
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 88.0
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
INFO:     127.0.0.1:61380 - "GET /fuelAnalytics/api/analytics/next-refuel-prediction HTTP/1.1" 200 OK
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=88.0, estimated_pct(row[35])=66.09
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 88.0
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
INFO:     127.0.0.1:61783 - "GET /fuelAnalytics/api/analytics/next-refuel-prediction HTTP/1.1" 200 OK
INFO:theft_detection_engine:üîç Starting advanced theft analysis for last 7 days...
INFO:theft_detection_engine:üìä Found 16 significant drops from local DB
INFO:theft_detection_engine:üì¶ Loading trips for 7 units...
INFO:theft_detection_engine:üì¶ Loaded trips for 7 units
INFO:theft_detection_engine:üîÑ Analyzing 16 drops...
INFO:     127.0.0.1:61780 - "GET /fuelAnalytics/api/refuels/analytics?days=7 HTTP/1.1" 200 OK
INFO:     127.0.0.1:61782 - "GET /fuelAnalytics/api/theft-analysis?days=7 HTTP/1.1" 200 OK
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=88.0, estimated_pct(row[35])=69.04
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 88.0
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
INFO:     127.0.0.1:61832 - "GET /fuelAnalytics/api/analytics/next-refuel-prediction HTTP/1.1" 200 OK
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=88.0, estimated_pct(row[35])=71.29
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 88.0
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
INFO:     127.0.0.1:61966 - "GET /fuelAnalytics/api/analytics/next-refuel-prediction HTTP/1.1" 200 OK
INFO:theft_detection_engine:üîç Starting advanced theft analysis for last 7 days...
INFO:theft_detection_engine:üìä Found 16 significant drops from local DB
INFO:theft_detection_engine:üì¶ Loading trips for 7 units...
INFO:theft_detection_engine:üì¶ Loaded trips for 7 units
INFO:theft_detection_engine:üîÑ Analyzing 16 drops...
INFO:     127.0.0.1:61963 - "GET /fuelAnalytics/api/refuels/analytics?days=7 HTTP/1.1" 200 OK
INFO:     127.0.0.1:61965 - "GET /fuelAnalytics/api/theft-analysis?days=7 HTTP/1.1" 200 OK
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=90.4, estimated_pct(row[35])=72.73
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 90.4
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
INFO:     127.0.0.1:62010 - "GET /fuelAnalytics/api/analytics/next-refuel-prediction HTTP/1.1" 200 OK
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=90.4, estimated_pct(row[35])=74.46
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 90.4
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
INFO:     127.0.0.1:62021 - "GET /fuelAnalytics/api/analytics/next-refuel-prediction HTTP/1.1" 200 OK
INFO:theft_detection_engine:üîç Starting advanced theft analysis for last 7 days...
INFO:theft_detection_engine:üìä Found 16 significant drops from local DB
INFO:theft_detection_engine:üì¶ Loading trips for 7 units...
INFO:theft_detection_engine:üì¶ Loaded trips for 7 units
INFO:theft_detection_engine:üîÑ Analyzing 16 drops...
INFO:     127.0.0.1:62018 - "GET /fuelAnalytics/api/refuels/analytics?days=7 HTTP/1.1" 200 OK
INFO:     127.0.0.1:62020 - "GET /fuelAnalytics/api/theft-analysis?days=7 HTTP/1.1" 200 OK
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=90.4, estimated_pct(row[35])=75.89
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 90.4
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
INFO:     127.0.0.1:62033 - "GET /fuelAnalytics/api/analytics/next-refuel-prediction HTTP/1.1" 200 OK
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=90.4, estimated_pct(row[35])=76.81
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 90.4
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
INFO:     127.0.0.1:62039 - "GET /fuelAnalytics/api/analytics/next-refuel-prediction HTTP/1.1" 200 OK
INFO:theft_detection_engine:üîç Starting advanced theft analysis for last 7 days...
INFO:theft_detection_engine:üìä Found 16 significant drops from local DB
INFO:theft_detection_engine:üì¶ Loading trips for 7 units...
INFO:theft_detection_engine:üì¶ Loaded trips for 7 units
INFO:theft_detection_engine:üîÑ Analyzing 16 drops...
INFO:     127.0.0.1:62035 - "GET /fuelAnalytics/api/refuels/analytics?days=7 HTTP/1.1" 200 OK
INFO:     127.0.0.1:62038 - "GET /fuelAnalytics/api/theft-analysis?days=7 HTTP/1.1" 200 OK
INFO:     127.0.0.1:62051 - "GET /fuelAnalytics/api/auth/me HTTP/1.1" 401 Unauthorized
WARNING:  WatchFiles detected changes in 'tests/test_predictive_complete_90pct.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üõë Shutting down Fuel Copilot API
INFO:lifecycle_manager:üìÖ Shutdown Time: 2025-12-28T20:42:57.213874
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üîÑ Disconnecting cache...
INFO:lifecycle_manager:‚úÖ Cache disconnected
INFO:lifecycle_manager:üîÑ Closing async database pool...
INFO:database_async:üîÑ Closing async MySQL connection pool...
INFO:database_async:‚úÖ Async MySQL connection pool closed
INFO:lifecycle_manager:‚úÖ Async DB pool closed
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:‚úÖ Clean shutdown completed
INFO:lifecycle_manager:================================================================================
INFO:     Application shutdown complete.
INFO:     Finished server process [59891]
‚ö†Ô∏è MYSQL_PASSWORD not set - database connections will fail
‚ö†Ô∏è LOCAL_DB_PASS not set - local database connections will fail
‚ö†Ô∏è  Redis cache unavailable: No module named 'redis_cache'
WARNING:  WatchFiles detected changes in 'tests/test_predictive_complete_90pct.py'. Reloading...
/opt/anaconda3/lib/python3.12/site-packages/keras/src/export/tf2onnx_lib.py:8: FutureWarning: In the future `np.object` will be defined as the corresponding NumPy scalar.
  if not hasattr(np, "object"):
‚ö†Ô∏è MPG History router not available: No module named 'logger_config'
INFO:main:‚úÖ Driver Alerts router registered
INFO:main:‚úÖ Alerts router registered
INFO:main:‚úÖ Trucks router registered
INFO:main:‚úÖ Refuels router registered
INFO:main:‚úÖ Analytics router registered
INFO:main:‚úÖ Maintenance router registered
INFO:ekf_integration:‚úÖ EKFManager inicializado en data/ekf_states
INFO:main:‚úÖ FASE 2A: EKF Integration & Diagnostics endpoints registered
INFO:main:‚úÖ FASE 2B: ML Pipeline (LSTM + Anomaly Detection + Driver Scoring) loaded
INFO:kafka_event_bus:‚úÖ Event Bus inicializado
INFO:kafka_event_bus:‚úÖ Event Bus suscriptores inicializados
INFO:main:‚úÖ FASE 2C: Event Bus & Microservices Orchestrator loaded
INFO:main:‚úÖ New Features: Cache + WebSocket + ML + Coaching registered
INFO:main:‚úÖ API v2 router registered
INFO:main:‚úÖ FASE 2C: Route Optimization Engine loaded
INFO:main:‚úÖ Prometheus metrics enabled
INFO:main:‚úÖ Rate limiting middleware enabled
INFO:main:‚úÖ GZip compression middleware enabled
INFO:main:‚úÖ CORS configured with 5 allowed origins
INFO:main:‚úÖ Global exception handler registered
INFO:routers:‚úÖ Registered api_v2 router at /fuelAnalytics/api/v2
INFO:routers:‚úÖ Registered command_center router at /fuelAnalytics/api/command-center
INFO:main:‚úÖ All routers included successfully
INFO:routers_v3:‚úÖ Registered api_v2 router at /fuelAnalytics/api/v2
INFO:routers_v3:‚úÖ Registered sse_endpoints router
INFO:routers_v3:‚úÖ Registered fuel_stations router
INFO:routers_v3:‚úÖ Registered sensor_health_router
INFO:routers_v3:‚úÖ Registered mpg_baseline_router
INFO:routers_v3:‚úÖ Registered driver_alerts_router at /fuelAnalytics/api/v2/driver-alerts
INFO:routers_v3:üöÄ v3.12.21 routers registration complete
INFO:main:‚úÖ v3.12.21 API v2 router registered
INFO:v5_endpoints:‚úÖ V5 Endpoints registered (Fleet Analytics + Leaderboard)
INFO:main:‚úÖ V5 Clean Endpoints registered (Fleet Analytics, Leaderboard)
INFO:main:üöÄ v5.2: Using new lightweight v5 endpoints (TruckHealthMonitor disabled)
INFO:     Started server process [72908]
INFO:     Waiting for application startup.
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üöÄ Fuel Copilot API v3.12.0 STARTING...
INFO:lifecycle_manager:üìÖ Startup Time: 2025-12-28T20:43:01.746051
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üîÑ Initializing multi-layer cache...
INFO:lifecycle_manager:‚úÖ Multi-layer cache connected successfully
INFO:lifecycle_manager:üîÑ Initializing async database pool...
INFO:database_async:üîÑ Creating async MySQL connection pool...
INFO:database_async:   Host: localhost:3306
INFO:database_async:   Database: fuel_copilot_local
INFO:database_async:   Pool size: 5-20
INFO:database_async:‚úÖ Async MySQL connection pool created successfully
INFO:lifecycle_manager:‚úÖ Async DB pool initialized successfully
INFO:database_mysql:‚úÖ SQLAlchemy engine created with connection pooling (10+5 connections)
INFO:database:‚úÖ Found 22 trucks in MySQL
INFO:lifecycle_manager:Available trucks: 22
INFO:lifecycle_manager:MySQL enhanced features: enabled
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:‚úÖ API ready for connections
INFO:lifecycle_manager:================================================================================
INFO:     Application startup complete.
‚ö†Ô∏è MYSQL_PASSWORD not set - database connections will fail
‚ö†Ô∏è LOCAL_DB_PASS not set - local database connections will fail
‚ö†Ô∏è  Redis cache unavailable: No module named 'redis_cache'
/opt/anaconda3/lib/python3.12/site-packages/keras/src/export/tf2onnx_lib.py:8: FutureWarning: In the future `np.object` will be defined as the corresponding NumPy scalar.
  if not hasattr(np, "object"):
‚ö†Ô∏è MPG History router not available: No module named 'logger_config'
INFO:main:‚úÖ Driver Alerts router registered
INFO:main:‚úÖ Alerts router registered
INFO:main:‚úÖ Trucks router registered
INFO:main:‚úÖ Refuels router registered
INFO:main:‚úÖ Analytics router registered
INFO:main:‚úÖ Maintenance router registered
INFO:ekf_integration:‚úÖ EKFManager inicializado en data/ekf_states
INFO:main:‚úÖ FASE 2A: EKF Integration & Diagnostics endpoints registered
INFO:main:‚úÖ FASE 2B: ML Pipeline (LSTM + Anomaly Detection + Driver Scoring) loaded
INFO:kafka_event_bus:‚úÖ Event Bus inicializado
INFO:kafka_event_bus:‚úÖ Event Bus suscriptores inicializados
INFO:main:‚úÖ FASE 2C: Event Bus & Microservices Orchestrator loaded
INFO:main:‚úÖ New Features: Cache + WebSocket + ML + Coaching registered
INFO:main:‚úÖ API v2 router registered
INFO:main:‚úÖ FASE 2C: Route Optimization Engine loaded
INFO:main:‚úÖ Prometheus metrics enabled
INFO:main:‚úÖ Rate limiting middleware enabled
INFO:main:‚úÖ GZip compression middleware enabled
INFO:main:‚úÖ CORS configured with 5 allowed origins
INFO:main:‚úÖ Global exception handler registered
INFO:routers:‚úÖ Registered api_v2 router at /fuelAnalytics/api/v2
INFO:routers:‚úÖ Registered command_center router at /fuelAnalytics/api/command-center
INFO:main:‚úÖ All routers included successfully
INFO:routers_v3:‚úÖ Registered api_v2 router at /fuelAnalytics/api/v2
INFO:routers_v3:‚úÖ Registered sse_endpoints router
INFO:routers_v3:‚úÖ Registered fuel_stations router
INFO:routers_v3:‚úÖ Registered sensor_health_router
INFO:routers_v3:‚úÖ Registered mpg_baseline_router
INFO:routers_v3:‚úÖ Registered driver_alerts_router at /fuelAnalytics/api/v2/driver-alerts
INFO:routers_v3:üöÄ v3.12.21 routers registration complete
INFO:main:‚úÖ v3.12.21 API v2 router registered
INFO:v5_endpoints:‚úÖ V5 Endpoints registered (Fleet Analytics + Leaderboard)
INFO:main:‚úÖ V5 Clean Endpoints registered (Fleet Analytics, Leaderboard)
INFO:main:üöÄ v5.2: Using new lightweight v5 endpoints (TruckHealthMonitor disabled)
INFO:     Started server process [72920]
INFO:     Waiting for application startup.
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üöÄ Fuel Copilot API v3.12.0 STARTING...
INFO:lifecycle_manager:üìÖ Startup Time: 2025-12-28T20:43:05.051379
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üîÑ Initializing multi-layer cache...
INFO:lifecycle_manager:‚úÖ Multi-layer cache connected successfully
INFO:lifecycle_manager:üîÑ Initializing async database pool...
INFO:database_async:üîÑ Creating async MySQL connection pool...
INFO:database_async:   Host: localhost:3306
INFO:database_async:   Database: fuel_copilot_local
INFO:database_async:   Pool size: 5-20
INFO:database_async:‚úÖ Async MySQL connection pool created successfully
INFO:lifecycle_manager:‚úÖ Async DB pool initialized successfully
INFO:database_mysql:‚úÖ SQLAlchemy engine created with connection pooling (10+5 connections)
INFO:database:‚úÖ Found 22 trucks in MySQL
INFO:lifecycle_manager:Available trucks: 22
INFO:lifecycle_manager:MySQL enhanced features: enabled
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:‚úÖ API ready for connections
INFO:lifecycle_manager:================================================================================
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'tests/test_predictive_complete_90pct.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üõë Shutting down Fuel Copilot API
INFO:lifecycle_manager:üìÖ Shutdown Time: 2025-12-28T20:44:48.051140
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üîÑ Disconnecting cache...
INFO:lifecycle_manager:‚úÖ Cache disconnected
INFO:lifecycle_manager:üîÑ Closing async database pool...
INFO:database_async:üîÑ Closing async MySQL connection pool...
INFO:database_async:‚úÖ Async MySQL connection pool closed
INFO:lifecycle_manager:‚úÖ Async DB pool closed
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:‚úÖ Clean shutdown completed
INFO:lifecycle_manager:================================================================================
INFO:     Application shutdown complete.
INFO:     Finished server process [72920]
‚ö†Ô∏è MYSQL_PASSWORD not set - database connections will fail
‚ö†Ô∏è LOCAL_DB_PASS not set - local database connections will fail
‚ö†Ô∏è  Redis cache unavailable: No module named 'redis_cache'
/opt/anaconda3/lib/python3.12/site-packages/keras/src/export/tf2onnx_lib.py:8: FutureWarning: In the future `np.object` will be defined as the corresponding NumPy scalar.
  if not hasattr(np, "object"):
‚ö†Ô∏è MPG History router not available: No module named 'logger_config'
INFO:main:‚úÖ Driver Alerts router registered
INFO:main:‚úÖ Alerts router registered
INFO:main:‚úÖ Trucks router registered
INFO:main:‚úÖ Refuels router registered
INFO:main:‚úÖ Analytics router registered
INFO:main:‚úÖ Maintenance router registered
INFO:ekf_integration:‚úÖ EKFManager inicializado en data/ekf_states
INFO:main:‚úÖ FASE 2A: EKF Integration & Diagnostics endpoints registered
INFO:main:‚úÖ FASE 2B: ML Pipeline (LSTM + Anomaly Detection + Driver Scoring) loaded
INFO:kafka_event_bus:‚úÖ Event Bus inicializado
INFO:kafka_event_bus:‚úÖ Event Bus suscriptores inicializados
INFO:main:‚úÖ FASE 2C: Event Bus & Microservices Orchestrator loaded
INFO:main:‚úÖ New Features: Cache + WebSocket + ML + Coaching registered
INFO:main:‚úÖ API v2 router registered
INFO:main:‚úÖ FASE 2C: Route Optimization Engine loaded
INFO:main:‚úÖ Prometheus metrics enabled
INFO:main:‚úÖ Rate limiting middleware enabled
INFO:main:‚úÖ GZip compression middleware enabled
INFO:main:‚úÖ CORS configured with 5 allowed origins
INFO:main:‚úÖ Global exception handler registered
INFO:routers:‚úÖ Registered api_v2 router at /fuelAnalytics/api/v2
INFO:routers:‚úÖ Registered command_center router at /fuelAnalytics/api/command-center
INFO:main:‚úÖ All routers included successfully
INFO:routers_v3:‚úÖ Registered api_v2 router at /fuelAnalytics/api/v2
INFO:routers_v3:‚úÖ Registered sse_endpoints router
INFO:routers_v3:‚úÖ Registered fuel_stations router
INFO:routers_v3:‚úÖ Registered sensor_health_router
INFO:routers_v3:‚úÖ Registered mpg_baseline_router
INFO:routers_v3:‚úÖ Registered driver_alerts_router at /fuelAnalytics/api/v2/driver-alerts
INFO:routers_v3:üöÄ v3.12.21 routers registration complete
INFO:main:‚úÖ v3.12.21 API v2 router registered
INFO:v5_endpoints:‚úÖ V5 Endpoints registered (Fleet Analytics + Leaderboard)
INFO:main:‚úÖ V5 Clean Endpoints registered (Fleet Analytics, Leaderboard)
INFO:main:üöÄ v5.2: Using new lightweight v5 endpoints (TruckHealthMonitor disabled)
INFO:     Started server process [73448]
INFO:     Waiting for application startup.
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üöÄ Fuel Copilot API v3.12.0 STARTING...
INFO:lifecycle_manager:üìÖ Startup Time: 2025-12-28T20:44:52.458489
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üîÑ Initializing multi-layer cache...
INFO:lifecycle_manager:‚úÖ Multi-layer cache connected successfully
INFO:lifecycle_manager:üîÑ Initializing async database pool...
INFO:database_async:üîÑ Creating async MySQL connection pool...
INFO:database_async:   Host: localhost:3306
INFO:database_async:   Database: fuel_copilot_local
INFO:database_async:   Pool size: 5-20
INFO:database_async:‚úÖ Async MySQL connection pool created successfully
INFO:lifecycle_manager:‚úÖ Async DB pool initialized successfully
INFO:database_mysql:‚úÖ SQLAlchemy engine created with connection pooling (10+5 connections)
INFO:database:‚úÖ Found 22 trucks in MySQL
INFO:lifecycle_manager:Available trucks: 22
INFO:lifecycle_manager:MySQL enhanced features: enabled
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:‚úÖ API ready for connections
INFO:lifecycle_manager:================================================================================
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'tests/test_predictive_main_execution.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üõë Shutting down Fuel Copilot API
INFO:lifecycle_manager:üìÖ Shutdown Time: 2025-12-28T20:46:10.720752
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üîÑ Disconnecting cache...
INFO:lifecycle_manager:‚úÖ Cache disconnected
INFO:lifecycle_manager:üîÑ Closing async database pool...
INFO:database_async:üîÑ Closing async MySQL connection pool...
INFO:database_async:‚úÖ Async MySQL connection pool closed
INFO:lifecycle_manager:‚úÖ Async DB pool closed
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:‚úÖ Clean shutdown completed
INFO:lifecycle_manager:================================================================================
INFO:     Application shutdown complete.
INFO:     Finished server process [73448]
WARNING:  WatchFiles detected changes in 'tests/test_predictive_main_execution.py'. Reloading...
‚ö†Ô∏è MYSQL_PASSWORD not set - database connections will fail
‚ö†Ô∏è LOCAL_DB_PASS not set - local database connections will fail
‚ö†Ô∏è  Redis cache unavailable: No module named 'redis_cache'
/opt/anaconda3/lib/python3.12/site-packages/keras/src/export/tf2onnx_lib.py:8: FutureWarning: In the future `np.object` will be defined as the corresponding NumPy scalar.
  if not hasattr(np, "object"):
‚ö†Ô∏è MPG History router not available: No module named 'logger_config'
INFO:main:‚úÖ Driver Alerts router registered
INFO:main:‚úÖ Alerts router registered
INFO:main:‚úÖ Trucks router registered
INFO:main:‚úÖ Refuels router registered
INFO:main:‚úÖ Analytics router registered
INFO:main:‚úÖ Maintenance router registered
INFO:ekf_integration:‚úÖ EKFManager inicializado en data/ekf_states
INFO:main:‚úÖ FASE 2A: EKF Integration & Diagnostics endpoints registered
INFO:main:‚úÖ FASE 2B: ML Pipeline (LSTM + Anomaly Detection + Driver Scoring) loaded
INFO:kafka_event_bus:‚úÖ Event Bus inicializado
INFO:kafka_event_bus:‚úÖ Event Bus suscriptores inicializados
INFO:main:‚úÖ FASE 2C: Event Bus & Microservices Orchestrator loaded
INFO:main:‚úÖ New Features: Cache + WebSocket + ML + Coaching registered
INFO:main:‚úÖ API v2 router registered
INFO:main:‚úÖ FASE 2C: Route Optimization Engine loaded
INFO:main:‚úÖ Prometheus metrics enabled
INFO:main:‚úÖ Rate limiting middleware enabled
INFO:main:‚úÖ GZip compression middleware enabled
INFO:main:‚úÖ CORS configured with 5 allowed origins
INFO:main:‚úÖ Global exception handler registered
INFO:routers:‚úÖ Registered api_v2 router at /fuelAnalytics/api/v2
INFO:routers:‚úÖ Registered command_center router at /fuelAnalytics/api/command-center
INFO:main:‚úÖ All routers included successfully
INFO:routers_v3:‚úÖ Registered api_v2 router at /fuelAnalytics/api/v2
INFO:routers_v3:‚úÖ Registered sse_endpoints router
INFO:routers_v3:‚úÖ Registered fuel_stations router
INFO:routers_v3:‚úÖ Registered sensor_health_router
INFO:routers_v3:‚úÖ Registered mpg_baseline_router
INFO:routers_v3:‚úÖ Registered driver_alerts_router at /fuelAnalytics/api/v2/driver-alerts
INFO:routers_v3:üöÄ v3.12.21 routers registration complete
INFO:main:‚úÖ v3.12.21 API v2 router registered
INFO:v5_endpoints:‚úÖ V5 Endpoints registered (Fleet Analytics + Leaderboard)
INFO:main:‚úÖ V5 Clean Endpoints registered (Fleet Analytics, Leaderboard)
INFO:main:üöÄ v5.2: Using new lightweight v5 endpoints (TruckHealthMonitor disabled)
INFO:     Started server process [74743]
INFO:     Waiting for application startup.
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üöÄ Fuel Copilot API v3.12.0 STARTING...
INFO:lifecycle_manager:üìÖ Startup Time: 2025-12-28T20:46:16.902325
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üîÑ Initializing multi-layer cache...
INFO:lifecycle_manager:‚úÖ Multi-layer cache connected successfully
INFO:lifecycle_manager:üîÑ Initializing async database pool...
INFO:database_async:üîÑ Creating async MySQL connection pool...
INFO:database_async:   Host: localhost:3306
INFO:database_async:   Database: fuel_copilot_local
INFO:database_async:   Pool size: 5-20
INFO:database_async:‚úÖ Async MySQL connection pool created successfully
INFO:lifecycle_manager:‚úÖ Async DB pool initialized successfully
INFO:database_mysql:‚úÖ SQLAlchemy engine created with connection pooling (10+5 connections)
INFO:database:‚úÖ Found 22 trucks in MySQL
INFO:lifecycle_manager:Available trucks: 22
INFO:lifecycle_manager:MySQL enhanced features: enabled
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:‚úÖ API ready for connections
INFO:lifecycle_manager:================================================================================
INFO:     Application startup complete.
‚ö†Ô∏è MYSQL_PASSWORD not set - database connections will fail
‚ö†Ô∏è LOCAL_DB_PASS not set - local database connections will fail
‚ö†Ô∏è  Redis cache unavailable: No module named 'redis_cache'
/opt/anaconda3/lib/python3.12/site-packages/keras/src/export/tf2onnx_lib.py:8: FutureWarning: In the future `np.object` will be defined as the corresponding NumPy scalar.
  if not hasattr(np, "object"):
‚ö†Ô∏è MPG History router not available: No module named 'logger_config'
INFO:main:‚úÖ Driver Alerts router registered
INFO:main:‚úÖ Alerts router registered
INFO:main:‚úÖ Trucks router registered
INFO:main:‚úÖ Refuels router registered
INFO:main:‚úÖ Analytics router registered
INFO:main:‚úÖ Maintenance router registered
INFO:ekf_integration:‚úÖ EKFManager inicializado en data/ekf_states
INFO:main:‚úÖ FASE 2A: EKF Integration & Diagnostics endpoints registered
INFO:main:‚úÖ FASE 2B: ML Pipeline (LSTM + Anomaly Detection + Driver Scoring) loaded
INFO:kafka_event_bus:‚úÖ Event Bus inicializado
INFO:kafka_event_bus:‚úÖ Event Bus suscriptores inicializados
INFO:main:‚úÖ FASE 2C: Event Bus & Microservices Orchestrator loaded
INFO:main:‚úÖ New Features: Cache + WebSocket + ML + Coaching registered
INFO:main:‚úÖ API v2 router registered
INFO:main:‚úÖ FASE 2C: Route Optimization Engine loaded
INFO:main:‚úÖ Prometheus metrics enabled
INFO:main:‚úÖ Rate limiting middleware enabled
INFO:main:‚úÖ GZip compression middleware enabled
INFO:main:‚úÖ CORS configured with 5 allowed origins
INFO:main:‚úÖ Global exception handler registered
INFO:routers:‚úÖ Registered api_v2 router at /fuelAnalytics/api/v2
INFO:routers:‚úÖ Registered command_center router at /fuelAnalytics/api/command-center
INFO:main:‚úÖ All routers included successfully
INFO:routers_v3:‚úÖ Registered api_v2 router at /fuelAnalytics/api/v2
INFO:routers_v3:‚úÖ Registered sse_endpoints router
INFO:routers_v3:‚úÖ Registered fuel_stations router
INFO:routers_v3:‚úÖ Registered sensor_health_router
INFO:routers_v3:‚úÖ Registered mpg_baseline_router
INFO:routers_v3:‚úÖ Registered driver_alerts_router at /fuelAnalytics/api/v2/driver-alerts
INFO:routers_v3:üöÄ v3.12.21 routers registration complete
INFO:main:‚úÖ v3.12.21 API v2 router registered
INFO:v5_endpoints:‚úÖ V5 Endpoints registered (Fleet Analytics + Leaderboard)
INFO:main:‚úÖ V5 Clean Endpoints registered (Fleet Analytics, Leaderboard)
INFO:main:üöÄ v5.2: Using new lightweight v5 endpoints (TruckHealthMonitor disabled)
INFO:     Started server process [74986]
INFO:     Waiting for application startup.
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üöÄ Fuel Copilot API v3.12.0 STARTING...
INFO:lifecycle_manager:üìÖ Startup Time: 2025-12-28T20:46:24.832590
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üîÑ Initializing multi-layer cache...
INFO:lifecycle_manager:‚úÖ Multi-layer cache connected successfully
INFO:lifecycle_manager:üîÑ Initializing async database pool...
INFO:database_async:üîÑ Creating async MySQL connection pool...
INFO:database_async:   Host: localhost:3306
INFO:database_async:   Database: fuel_copilot_local
INFO:database_async:   Pool size: 5-20
INFO:database_async:‚úÖ Async MySQL connection pool created successfully
INFO:lifecycle_manager:‚úÖ Async DB pool initialized successfully
INFO:database_mysql:‚úÖ SQLAlchemy engine created with connection pooling (10+5 connections)
INFO:database:‚úÖ Found 22 trucks in MySQL
INFO:lifecycle_manager:Available trucks: 22
INFO:lifecycle_manager:MySQL enhanced features: enabled
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:‚úÖ API ready for connections
INFO:lifecycle_manager:================================================================================
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'tests/test_predictive_main_execution.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üõë Shutting down Fuel Copilot API
INFO:lifecycle_manager:üìÖ Shutdown Time: 2025-12-28T20:46:54.673167
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üîÑ Disconnecting cache...
INFO:lifecycle_manager:‚úÖ Cache disconnected
INFO:lifecycle_manager:üîÑ Closing async database pool...
INFO:database_async:üîÑ Closing async MySQL connection pool...
INFO:database_async:‚úÖ Async MySQL connection pool closed
INFO:lifecycle_manager:‚úÖ Async DB pool closed
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:‚úÖ Clean shutdown completed
INFO:lifecycle_manager:================================================================================
INFO:     Application shutdown complete.
INFO:     Finished server process [74986]
‚ö†Ô∏è MYSQL_PASSWORD not set - database connections will fail
‚ö†Ô∏è LOCAL_DB_PASS not set - local database connections will fail
‚ö†Ô∏è  Redis cache unavailable: No module named 'redis_cache'
/opt/anaconda3/lib/python3.12/site-packages/keras/src/export/tf2onnx_lib.py:8: FutureWarning: In the future `np.object` will be defined as the corresponding NumPy scalar.
  if not hasattr(np, "object"):
‚ö†Ô∏è MPG History router not available: No module named 'logger_config'
INFO:main:‚úÖ Driver Alerts router registered
INFO:main:‚úÖ Alerts router registered
INFO:main:‚úÖ Trucks router registered
INFO:main:‚úÖ Refuels router registered
INFO:main:‚úÖ Analytics router registered
INFO:main:‚úÖ Maintenance router registered
INFO:ekf_integration:‚úÖ EKFManager inicializado en data/ekf_states
INFO:main:‚úÖ FASE 2A: EKF Integration & Diagnostics endpoints registered
INFO:main:‚úÖ FASE 2B: ML Pipeline (LSTM + Anomaly Detection + Driver Scoring) loaded
INFO:kafka_event_bus:‚úÖ Event Bus inicializado
INFO:kafka_event_bus:‚úÖ Event Bus suscriptores inicializados
INFO:main:‚úÖ FASE 2C: Event Bus & Microservices Orchestrator loaded
INFO:main:‚úÖ New Features: Cache + WebSocket + ML + Coaching registered
INFO:main:‚úÖ API v2 router registered
INFO:main:‚úÖ FASE 2C: Route Optimization Engine loaded
INFO:main:‚úÖ Prometheus metrics enabled
INFO:main:‚úÖ Rate limiting middleware enabled
INFO:main:‚úÖ GZip compression middleware enabled
INFO:main:‚úÖ CORS configured with 5 allowed origins
INFO:main:‚úÖ Global exception handler registered
INFO:routers:‚úÖ Registered api_v2 router at /fuelAnalytics/api/v2
INFO:routers:‚úÖ Registered command_center router at /fuelAnalytics/api/command-center
INFO:main:‚úÖ All routers included successfully
INFO:routers_v3:‚úÖ Registered api_v2 router at /fuelAnalytics/api/v2
INFO:routers_v3:‚úÖ Registered sse_endpoints router
INFO:routers_v3:‚úÖ Registered fuel_stations router
INFO:routers_v3:‚úÖ Registered sensor_health_router
INFO:routers_v3:‚úÖ Registered mpg_baseline_router
INFO:routers_v3:‚úÖ Registered driver_alerts_router at /fuelAnalytics/api/v2/driver-alerts
INFO:routers_v3:üöÄ v3.12.21 routers registration complete
INFO:main:‚úÖ v3.12.21 API v2 router registered
INFO:v5_endpoints:‚úÖ V5 Endpoints registered (Fleet Analytics + Leaderboard)
INFO:main:‚úÖ V5 Clean Endpoints registered (Fleet Analytics, Leaderboard)
INFO:main:üöÄ v5.2: Using new lightweight v5 endpoints (TruckHealthMonitor disabled)
INFO:     Started server process [75117]
INFO:     Waiting for application startup.
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üöÄ Fuel Copilot API v3.12.0 STARTING...
INFO:lifecycle_manager:üìÖ Startup Time: 2025-12-28T20:46:58.130039
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üîÑ Initializing multi-layer cache...
INFO:lifecycle_manager:‚úÖ Multi-layer cache connected successfully
INFO:lifecycle_manager:üîÑ Initializing async database pool...
INFO:database_async:üîÑ Creating async MySQL connection pool...
INFO:database_async:   Host: localhost:3306
INFO:database_async:   Database: fuel_copilot_local
INFO:database_async:   Pool size: 5-20
INFO:database_async:‚úÖ Async MySQL connection pool created successfully
INFO:lifecycle_manager:‚úÖ Async DB pool initialized successfully
INFO:database_mysql:‚úÖ SQLAlchemy engine created with connection pooling (10+5 connections)
INFO:database:‚úÖ Found 22 trucks in MySQL
INFO:lifecycle_manager:Available trucks: 22
INFO:lifecycle_manager:MySQL enhanced features: enabled
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:‚úÖ API ready for connections
INFO:lifecycle_manager:================================================================================
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'tests/test_predictive_edge_cases_final.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üõë Shutting down Fuel Copilot API
INFO:lifecycle_manager:üìÖ Shutdown Time: 2025-12-28T20:47:49.698738
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üîÑ Disconnecting cache...
INFO:lifecycle_manager:‚úÖ Cache disconnected
INFO:lifecycle_manager:üîÑ Closing async database pool...
INFO:database_async:üîÑ Closing async MySQL connection pool...
INFO:database_async:‚úÖ Async MySQL connection pool closed
INFO:lifecycle_manager:‚úÖ Async DB pool closed
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:‚úÖ Clean shutdown completed
INFO:lifecycle_manager:================================================================================
INFO:     Application shutdown complete.
INFO:     Finished server process [75117]
‚ö†Ô∏è MYSQL_PASSWORD not set - database connections will fail
‚ö†Ô∏è LOCAL_DB_PASS not set - local database connections will fail
‚ö†Ô∏è  Redis cache unavailable: No module named 'redis_cache'
WARNING:  WatchFiles detected changes in 'tests/test_predictive_edge_cases_final.py'. Reloading...
/opt/anaconda3/lib/python3.12/site-packages/keras/src/export/tf2onnx_lib.py:8: FutureWarning: In the future `np.object` will be defined as the corresponding NumPy scalar.
  if not hasattr(np, "object"):
‚ö†Ô∏è MPG History router not available: No module named 'logger_config'
INFO:main:‚úÖ Driver Alerts router registered
INFO:main:‚úÖ Alerts router registered
INFO:main:‚úÖ Trucks router registered
INFO:main:‚úÖ Refuels router registered
INFO:main:‚úÖ Analytics router registered
INFO:main:‚úÖ Maintenance router registered
INFO:ekf_integration:‚úÖ EKFManager inicializado en data/ekf_states
INFO:main:‚úÖ FASE 2A: EKF Integration & Diagnostics endpoints registered
INFO:main:‚úÖ FASE 2B: ML Pipeline (LSTM + Anomaly Detection + Driver Scoring) loaded
INFO:kafka_event_bus:‚úÖ Event Bus inicializado
INFO:kafka_event_bus:‚úÖ Event Bus suscriptores inicializados
INFO:main:‚úÖ FASE 2C: Event Bus & Microservices Orchestrator loaded
INFO:main:‚úÖ New Features: Cache + WebSocket + ML + Coaching registered
INFO:main:‚úÖ API v2 router registered
INFO:main:‚úÖ FASE 2C: Route Optimization Engine loaded
INFO:main:‚úÖ Prometheus metrics enabled
INFO:main:‚úÖ Rate limiting middleware enabled
INFO:main:‚úÖ GZip compression middleware enabled
INFO:main:‚úÖ CORS configured with 5 allowed origins
INFO:main:‚úÖ Global exception handler registered
INFO:routers:‚úÖ Registered api_v2 router at /fuelAnalytics/api/v2
INFO:routers:‚úÖ Registered command_center router at /fuelAnalytics/api/command-center
INFO:main:‚úÖ All routers included successfully
INFO:routers_v3:‚úÖ Registered api_v2 router at /fuelAnalytics/api/v2
INFO:routers_v3:‚úÖ Registered sse_endpoints router
INFO:routers_v3:‚úÖ Registered fuel_stations router
INFO:routers_v3:‚úÖ Registered sensor_health_router
INFO:routers_v3:‚úÖ Registered mpg_baseline_router
INFO:routers_v3:‚úÖ Registered driver_alerts_router at /fuelAnalytics/api/v2/driver-alerts
INFO:routers_v3:üöÄ v3.12.21 routers registration complete
INFO:main:‚úÖ v3.12.21 API v2 router registered
INFO:v5_endpoints:‚úÖ V5 Endpoints registered (Fleet Analytics + Leaderboard)
INFO:main:‚úÖ V5 Clean Endpoints registered (Fleet Analytics, Leaderboard)
INFO:main:üöÄ v5.2: Using new lightweight v5 endpoints (TruckHealthMonitor disabled)
INFO:     Started server process [75226]
INFO:     Waiting for application startup.
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üöÄ Fuel Copilot API v3.12.0 STARTING...
INFO:lifecycle_manager:üìÖ Startup Time: 2025-12-28T20:47:53.338736
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üîÑ Initializing multi-layer cache...
INFO:lifecycle_manager:‚úÖ Multi-layer cache connected successfully
INFO:lifecycle_manager:üîÑ Initializing async database pool...
INFO:database_async:üîÑ Creating async MySQL connection pool...
INFO:database_async:   Host: localhost:3306
INFO:database_async:   Database: fuel_copilot_local
INFO:database_async:   Pool size: 5-20
INFO:database_async:‚úÖ Async MySQL connection pool created successfully
INFO:lifecycle_manager:‚úÖ Async DB pool initialized successfully
INFO:database_mysql:‚úÖ SQLAlchemy engine created with connection pooling (10+5 connections)
INFO:database:‚úÖ Found 22 trucks in MySQL
INFO:lifecycle_manager:Available trucks: 22
INFO:lifecycle_manager:MySQL enhanced features: enabled
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:‚úÖ API ready for connections
INFO:lifecycle_manager:================================================================================
INFO:     Application startup complete.
‚ö†Ô∏è MYSQL_PASSWORD not set - database connections will fail
‚ö†Ô∏è LOCAL_DB_PASS not set - local database connections will fail
‚ö†Ô∏è  Redis cache unavailable: No module named 'redis_cache'
/opt/anaconda3/lib/python3.12/site-packages/keras/src/export/tf2onnx_lib.py:8: FutureWarning: In the future `np.object` will be defined as the corresponding NumPy scalar.
  if not hasattr(np, "object"):
‚ö†Ô∏è MPG History router not available: No module named 'logger_config'
INFO:main:‚úÖ Driver Alerts router registered
INFO:main:‚úÖ Alerts router registered
INFO:main:‚úÖ Trucks router registered
INFO:main:‚úÖ Refuels router registered
INFO:main:‚úÖ Analytics router registered
INFO:main:‚úÖ Maintenance router registered
INFO:ekf_integration:‚úÖ EKFManager inicializado en data/ekf_states
INFO:main:‚úÖ FASE 2A: EKF Integration & Diagnostics endpoints registered
INFO:main:‚úÖ FASE 2B: ML Pipeline (LSTM + Anomaly Detection + Driver Scoring) loaded
INFO:kafka_event_bus:‚úÖ Event Bus inicializado
INFO:kafka_event_bus:‚úÖ Event Bus suscriptores inicializados
INFO:main:‚úÖ FASE 2C: Event Bus & Microservices Orchestrator loaded
INFO:main:‚úÖ New Features: Cache + WebSocket + ML + Coaching registered
INFO:main:‚úÖ API v2 router registered
INFO:main:‚úÖ FASE 2C: Route Optimization Engine loaded
INFO:main:‚úÖ Prometheus metrics enabled
INFO:main:‚úÖ Rate limiting middleware enabled
INFO:main:‚úÖ GZip compression middleware enabled
INFO:main:‚úÖ CORS configured with 5 allowed origins
INFO:main:‚úÖ Global exception handler registered
INFO:routers:‚úÖ Registered api_v2 router at /fuelAnalytics/api/v2
INFO:routers:‚úÖ Registered command_center router at /fuelAnalytics/api/command-center
INFO:main:‚úÖ All routers included successfully
INFO:routers_v3:‚úÖ Registered api_v2 router at /fuelAnalytics/api/v2
INFO:routers_v3:‚úÖ Registered sse_endpoints router
INFO:routers_v3:‚úÖ Registered fuel_stations router
INFO:routers_v3:‚úÖ Registered sensor_health_router
INFO:routers_v3:‚úÖ Registered mpg_baseline_router
INFO:routers_v3:‚úÖ Registered driver_alerts_router at /fuelAnalytics/api/v2/driver-alerts
INFO:routers_v3:üöÄ v3.12.21 routers registration complete
INFO:main:‚úÖ v3.12.21 API v2 router registered
INFO:v5_endpoints:‚úÖ V5 Endpoints registered (Fleet Analytics + Leaderboard)
INFO:main:‚úÖ V5 Clean Endpoints registered (Fleet Analytics, Leaderboard)
INFO:main:üöÄ v5.2: Using new lightweight v5 endpoints (TruckHealthMonitor disabled)
INFO:     Started server process [75238]
INFO:     Waiting for application startup.
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üöÄ Fuel Copilot API v3.12.0 STARTING...
INFO:lifecycle_manager:üìÖ Startup Time: 2025-12-28T20:48:04.377848
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üîÑ Initializing multi-layer cache...
INFO:lifecycle_manager:‚úÖ Multi-layer cache connected successfully
INFO:lifecycle_manager:üîÑ Initializing async database pool...
INFO:database_async:üîÑ Creating async MySQL connection pool...
INFO:database_async:   Host: localhost:3306
INFO:database_async:   Database: fuel_copilot_local
INFO:database_async:   Pool size: 5-20
INFO:database_async:‚úÖ Async MySQL connection pool created successfully
INFO:lifecycle_manager:‚úÖ Async DB pool initialized successfully
INFO:database_mysql:‚úÖ SQLAlchemy engine created with connection pooling (10+5 connections)
INFO:database:‚úÖ Found 22 trucks in MySQL
INFO:lifecycle_manager:Available trucks: 22
INFO:lifecycle_manager:MySQL enhanced features: enabled
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:‚úÖ API ready for connections
INFO:lifecycle_manager:================================================================================
INFO:     Application startup complete.
‚úÖ SPN Decoder initialized with 111 SPNs
‚úÖ SPN Decoder initialized with 111 SPNs
INFO:     127.0.0.1:62651 - "GET /fuelAnalytics/api/v2/trucks HTTP/1.1" 404 Not Found
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 20:49:43 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:62653 - "GET /fuelAnalytics/api/v2/trucks/DO9693 HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 20:49:43 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:62660 - "GET /fuelAnalytics/api/v2/trucks/FF7702 HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 20:49:43 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:62667 - "GET /fuelAnalytics/api/v2/trucks/GS5030 HTTP/1.1" 200 OK
ERROR:database_mysql:Error getting refuel history: (pymysql.err.OperationalError) (1054, "Unknown column 'refuel_gallons' in 'field list'")
[SQL: 
            SELECT 
                truck_id,
                timestamp_utc,
                refuel_gallons,
                estimated_pct as fuel_level_after_pct,
                estimated_liters as fuel_level_after_liters,
                estimated_gallons as fuel_level_after_gallons,
                truck_status as status,
                odometer_mi
            FROM fuel_metrics
            WHERE truck_id = %(truck_id)s
              AND refuel_gallons > 0
              AND timestamp_utc > NOW() - INTERVAL %(days_back)s DAY
            ORDER BY timestamp_utc ASC
        ]
[parameters: {'truck_id': 'DO9693', 'days_back': 30}]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
INFO:database:‚ö†Ô∏è Using CSV fallback for DO9693 refuels
INFO:main:üì≠ No refuels found for DO9693
INFO:     127.0.0.1:62674 - "GET /fuelAnalytics/api/v2/trucks/DO9693/refuels HTTP/1.1" 200 OK
ERROR:database_mysql:Error getting refuel history: (pymysql.err.OperationalError) (1054, "Unknown column 'refuel_gallons' in 'field list'")
[SQL: 
            SELECT 
                truck_id,
                timestamp_utc,
                refuel_gallons,
                estimated_pct as fuel_level_after_pct,
                estimated_liters as fuel_level_after_liters,
                estimated_gallons as fuel_level_after_gallons,
                truck_status as status,
                odometer_mi
            FROM fuel_metrics
            WHERE truck_id = %(truck_id)s
              AND refuel_gallons > 0
              AND timestamp_utc > NOW() - INTERVAL %(days_back)s DAY
            ORDER BY timestamp_utc ASC
        ]
[parameters: {'truck_id': 'FF7702', 'days_back': 30}]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
INFO:database:‚ö†Ô∏è Using CSV fallback for FF7702 refuels
INFO:main:üì≠ No refuels found for FF7702
INFO:     127.0.0.1:62676 - "GET /fuelAnalytics/api/v2/trucks/FF7702/refuels HTTP/1.1" 200 OK
ERROR:database_mysql:Error getting refuel history: (pymysql.err.OperationalError) (1054, "Unknown column 'refuel_gallons' in 'field list'")
[SQL: 
            SELECT 
                truck_id,
                timestamp_utc,
                refuel_gallons,
                estimated_pct as fuel_level_after_pct,
                estimated_liters as fuel_level_after_liters,
                estimated_gallons as fuel_level_after_gallons,
                truck_status as status,
                odometer_mi
            FROM fuel_metrics
            WHERE truck_id = %(truck_id)s
              AND refuel_gallons > 0
              AND timestamp_utc > NOW() - INTERVAL %(days_back)s DAY
            ORDER BY timestamp_utc ASC
        ]
[parameters: {'truck_id': 'GS5030', 'days_back': 30}]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
INFO:database:‚ö†Ô∏è Using CSV fallback for GS5030 refuels
INFO:main:üì≠ No refuels found for GS5030
INFO:     127.0.0.1:62678 - "GET /fuelAnalytics/api/v2/trucks/GS5030/refuels HTTP/1.1" 200 OK
ERROR:api_v2:Error fetching sensors for DO9693: invalid literal for int() with base 10: '523452.3'
INFO:     127.0.0.1:62680 - "GET /fuelAnalytics/api/v2/trucks/DO9693/sensors HTTP/1.1" 500 Internal Server Error
INFO:     127.0.0.1:62682 - "GET /fuelAnalytics/api/v2/trucks/DO9693/alerts HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:62684 - "GET /fuelAnalytics/api/v2/trucks/FF7702/alerts HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:62686 - "GET /fuelAnalytics/api/v2/trucks/GS5030/alerts HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:62688 - "GET /fuelAnalytics/api/v2/trucks/DO9693/maintenance HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:62690 - "GET /fuelAnalytics/api/v2/trucks/FF7702/maintenance HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:62692 - "GET /fuelAnalytics/api/v2/trucks/GS5030/maintenance HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:62694 - "GET /fuelAnalytics/api/v2/analytics/summary HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:62696 - "GET /fuelAnalytics/api/v2/analytics/mpg HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:62698 - "GET /fuelAnalytics/api/v2/analytics/fuel-loss HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:62700 - "GET /fuelAnalytics/api/v2/analytics/driver-scores HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:62702 - "GET /fuelAnalytics/api/v2/alerts/active HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:62704 - "GET /fuelAnalytics/api/v2/alerts/critical HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:62706 - "GET /fuelAnalytics/api/v2/alerts/resolved HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:62708 - "GET /fuelAnalytics/api/v2/maintenance/upcoming HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:62710 - "GET /fuelAnalytics/api/v2/maintenance/overdue HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:62712 - "GET /fuelAnalytics/api/v2/health/fleet HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:62714 - "GET /fuelAnalytics/api/v2/health/truck/DO9693 HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:62716 - "GET /fuelAnalytics/api/v2/health/truck/FF7702 HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:62718 - "GET /fuelAnalytics/api/v2/health/truck/GS5030 HTTP/1.1" 404 Not Found
INFO:database:‚úÖ Found 22 trucks in MySQL
INFO:config:‚úÖ Loaded 45 trucks from tanks.yaml
INFO:database_mysql:üîç DEBUG: First row columns: truck_id=CO0681, sensor_pct(row[36])=86.8, estimated_pct(row[35])=86.66
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 86.8
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
INFO:bulk_mysql_handler:üöÄ Bulk MySQL Handler initialized (batch_size=20, auto_flush=30.0s)
INFO:     127.0.0.1:63758 - "GET /fuelAnalytics/api/health HTTP/1.1" 200 OK
INFO:     127.0.0.1:63760 - "GET /fuelAnalytics/api/health/quick HTTP/1.1" 200 OK
INFO:     127.0.0.1:63762 - "GET /fuelAnalytics/api/health/deep HTTP/1.1" 200 OK
INFO:database:‚úÖ Found 22 trucks in MySQL
INFO:     127.0.0.1:63764 - "GET /fuelAnalytics/api/status HTTP/1.1" 200 OK
INFO:     127.0.0.1:63766 - "GET /fuelAnalytics/api/cache/stats HTTP/1.1" 200 OK
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 86.8
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
WARNING:main:üîç DEBUG: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
WARNING:main:üîç DEBUG: sensor_pct value: 86.8
INFO:     127.0.0.1:63768 - "GET /fuelAnalytics/api/fleet HTTP/1.1" 200 OK
INFO:database:‚úÖ Found 22 trucks in MySQL
INFO:     127.0.0.1:63770 - "GET /fuelAnalytics/api/trucks HTTP/1.1" 200 OK
INFO:observability:[get_truck_detail] Fetching data for DO9693
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for DO9693
INFO:     127.0.0.1:63772 - "GET /fuelAnalytics/api/trucks/DO9693 HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/fastapi/applications.py", line 1139, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/gzip.py", line 130, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/main.py", line 741, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/anaconda3/lib/python3.12/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 177, in __call__
    raise exc
  File "/opt/anaconda3/lib/python3.12/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 175, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/anaconda3/lib/python3.12/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "/opt/anaconda3/lib/python3.12/site-packages/fastapi/routing.py", line 120, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/anaconda3/lib/python3.12/site-packages/fastapi/routing.py", line 106, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/fastapi/routing.py", line 464, in app
    response = actual_response_class(content, **response_args)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/responses.py", line 189, in __init__
    super().__init__(content, status_code, headers, media_type, background)
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/responses.py", line 46, in __init__
    self.body = self.render(content)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/responses.py", line 192, in render
    return json.dumps(
           ^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/json/__init__.py", line 238, in dumps
    **kw).encode(obj)
          ^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/json/encoder.py", line 258, in iterencode
    return _iterencode(o, 0)
           ^^^^^^^^^^^^^^^^^
ValueError: Out of range float values are not JSON compliant: nan
INFO:observability:[get_truck_detail] Fetching data for FF7702
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for FF7702
INFO:     127.0.0.1:63774 - "GET /fuelAnalytics/api/trucks/FF7702 HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/fastapi/applications.py", line 1139, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/gzip.py", line 130, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/main.py", line 741, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/anaconda3/lib/python3.12/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 177, in __call__
    raise exc
  File "/opt/anaconda3/lib/python3.12/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 175, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/anaconda3/lib/python3.12/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "/opt/anaconda3/lib/python3.12/site-packages/fastapi/routing.py", line 120, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/anaconda3/lib/python3.12/site-packages/fastapi/routing.py", line 106, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/fastapi/routing.py", line 464, in app
    response = actual_response_class(content, **response_args)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/responses.py", line 189, in __init__
    super().__init__(content, status_code, headers, media_type, background)
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/responses.py", line 46, in __init__
    self.body = self.render(content)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/responses.py", line 192, in render
    return json.dumps(
           ^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/json/__init__.py", line 238, in dumps
    **kw).encode(obj)
          ^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/json/encoder.py", line 258, in iterencode
    return _iterencode(o, 0)
           ^^^^^^^^^^^^^^^^^
ValueError: Out of range float values are not JSON compliant: nan
INFO:observability:[get_truck_detail] Fetching data for GS5030
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚ö†Ô∏è Using CSV fallback for GS5030
INFO:     127.0.0.1:63776 - "GET /fuelAnalytics/api/trucks/GS5030 HTTP/1.1" 200 OK
INFO:src.repositories.truck_repository:TruckRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.sensor_repository:SensorRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.def_repository:DEFRepository initialized for DB: fuel_copilot_local
INFO:src.repositories.dtc_repository:DTCRepository initialized for DB: fuel_copilot_local
INFO:src.services.analytics_service_adapted:AnalyticsService initialized (wrapping database_mysql)
2025-12-28 20:53:59 [debug    ] PriorityEngine initialized     components=15 decay_k=0.04
INFO:src.services.health_analyzer_adapted:HealthAnalyzer initialized (adapted version)
INFO:src.services.def_predictor_adapted:DEFPredictor initialized (tank: 75L)
INFO:src.services.pattern_analyzer_adapted:PatternAnalyzer initialized (adapted version)
INFO:src.orchestrators.fleet_orchestrator_adapted:FleetOrchestrator initialized with all services
INFO:     127.0.0.1:63778 - "GET /fuelAnalytics/api/v2/trucks/DO9693 HTTP/1.1" 200 OK
ERROR:database_mysql:Error getting refuel history: (pymysql.err.OperationalError) (1054, "Unknown column 'refuel_gallons' in 'field list'")
[SQL: 
            SELECT 
                truck_id,
                timestamp_utc,
                refuel_gallons,
                estimated_pct as fuel_level_after_pct,
                estimated_liters as fuel_level_after_liters,
                estimated_gallons as fuel_level_after_gallons,
                truck_status as status,
                odometer_mi
            FROM fuel_metrics
            WHERE truck_id = %(truck_id)s
              AND refuel_gallons > 0
              AND timestamp_utc > NOW() - INTERVAL %(days_back)s DAY
            ORDER BY timestamp_utc ASC
        ]
[parameters: {'truck_id': 'DO9693', 'days_back': 30}]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
INFO:database:‚ö†Ô∏è Using CSV fallback for DO9693 refuels
INFO:main:üì≠ No refuels found for DO9693
INFO:     127.0.0.1:63785 - "GET /fuelAnalytics/api/v2/trucks/DO9693/refuels HTTP/1.1" 200 OK
ERROR:api_v2:Error fetching sensors for DO9693: invalid literal for int() with base 10: '523452.3'
INFO:     127.0.0.1:63787 - "GET /fuelAnalytics/api/v2/trucks/DO9693/sensors HTTP/1.1" 500 Internal Server Error
INFO:database:‚úÖ Found 22 trucks in MySQL
ERROR:database_mysql:Error getting refuel history: (pymysql.err.OperationalError) (1054, "Unknown column 'refuel_gallons' in 'field list'")
[SQL: 
            SELECT 
                truck_id,
                timestamp_utc,
                refuel_gallons,
                estimated_pct as fuel_level_after_pct,
                estimated_liters as fuel_level_after_liters,
                estimated_gallons as fuel_level_after_gallons,
                truck_status as status,
                odometer_mi
            FROM fuel_metrics
            WHERE truck_id = %(truck_id)s
              AND refuel_gallons > 0
              AND timestamp_utc > NOW() - INTERVAL %(days_back)s DAY
            ORDER BY timestamp_utc ASC
        ]
[parameters: {'truck_id': 'CO0681', 'days_back': 7}]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
INFO:database:‚ö†Ô∏è Using CSV fallback for CO0681 refuels
ERROR:database_mysql:Error getting refuel history: (pymysql.err.OperationalError) (1054, "Unknown column 'refuel_gallons' in 'field list'")
[SQL: 
            SELECT 
                truck_id,
                timestamp_utc,
                refuel_gallons,
                estimated_pct as fuel_level_after_pct,
                estimated_liters as fuel_level_after_liters,
                estimated_gallons as fuel_level_after_gallons,
                truck_status as status,
                odometer_mi
            FROM fuel_metrics
            WHERE truck_id = %(truck_id)s
              AND refuel_gallons > 0
              AND timestamp_utc > NOW() - INTERVAL %(days_back)s DAY
            ORDER BY timestamp_utc ASC
        ]
[parameters: {'truck_id': 'DO9356', 'days_back': 7}]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
INFO:database:‚ö†Ô∏è Using CSV fallback for DO9356 refuels
ERROR:database_mysql:Error getting refuel history: (pymysql.err.OperationalError) (1054, "Unknown column 'refuel_gallons' in 'field list'")
[SQL: 
            SELECT 
                truck_id,
                timestamp_utc,
                refuel_gallons,
                estimated_pct as fuel_level_after_pct,
                estimated_liters as fuel_level_after_liters,
                estimated_gallons as fuel_level_after_gallons,
                truck_status as status,
                odometer_mi
            FROM fuel_metrics
            WHERE truck_id = %(truck_id)s
              AND refuel_gallons > 0
              AND timestamp_utc > NOW() - INTERVAL %(days_back)s DAY
            ORDER BY timestamp_utc ASC
        ]
[parameters: {'truck_id': 'DO9693', 'days_back': 7}]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
INFO:database:‚ö†Ô∏è Using CSV fallback for DO9693 refuels
ERROR:database_mysql:Error getting refuel history: (pymysql.err.OperationalError) (1054, "Unknown column 'refuel_gallons' in 'field list'")
[SQL: 
            SELECT 
                truck_id,
                timestamp_utc,
                refuel_gallons,
                estimated_pct as fuel_level_after_pct,
                estimated_liters as fuel_level_after_liters,
                estimated_gallons as fuel_level_after_gallons,
                truck_status as status,
                odometer_mi
            FROM fuel_metrics
            WHERE truck_id = %(truck_id)s
              AND refuel_gallons > 0
              AND timestamp_utc > NOW() - INTERVAL %(days_back)s DAY
            ORDER BY timestamp_utc ASC
        ]
[parameters: {'truck_id': 'DR6664', 'days_back': 7}]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
INFO:database:‚ö†Ô∏è Using CSV fallback for DR6664 refuels
ERROR:database_mysql:Error getting refuel history: (pymysql.err.OperationalError) (1054, "Unknown column 'refuel_gallons' in 'field list'")
[SQL: 
            SELECT 
                truck_id,
                timestamp_utc,
                refuel_gallons,
                estimated_pct as fuel_level_after_pct,
                estimated_liters as fuel_level_after_liters,
                estimated_gallons as fuel_level_after_gallons,
                truck_status as status,
                odometer_mi
            FROM fuel_metrics
            WHERE truck_id = %(truck_id)s
              AND refuel_gallons > 0
              AND timestamp_utc > NOW() - INTERVAL %(days_back)s DAY
            ORDER BY timestamp_utc ASC
        ]
[parameters: {'truck_id': 'FF7702', 'days_back': 7}]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
INFO:database:‚ö†Ô∏è Using CSV fallback for FF7702 refuels
ERROR:database_mysql:Error getting refuel history: (pymysql.err.OperationalError) (1054, "Unknown column 'refuel_gallons' in 'field list'")
[SQL: 
            SELECT 
                truck_id,
                timestamp_utc,
                refuel_gallons,
                estimated_pct as fuel_level_after_pct,
                estimated_liters as fuel_level_after_liters,
                estimated_gallons as fuel_level_after_gallons,
                truck_status as status,
                odometer_mi
            FROM fuel_metrics
            WHERE truck_id = %(truck_id)s
              AND refuel_gallons > 0
              AND timestamp_utc > NOW() - INTERVAL %(days_back)s DAY
            ORDER BY timestamp_utc ASC
        ]
[parameters: {'truck_id': 'FM3363', 'days_back': 7}]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
INFO:database:‚ö†Ô∏è Using CSV fallback for FM3363 refuels
ERROR:database_mysql:Error getting refuel history: (pymysql.err.OperationalError) (1054, "Unknown column 'refuel_gallons' in 'field list'")
[SQL: 
            SELECT 
                truck_id,
                timestamp_utc,
                refuel_gallons,
                estimated_pct as fuel_level_after_pct,
                estimated_liters as fuel_level_after_liters,
                estimated_gallons as fuel_level_after_gallons,
                truck_status as status,
                odometer_mi
            FROM fuel_metrics
            WHERE truck_id = %(truck_id)s
              AND refuel_gallons > 0
              AND timestamp_utc > NOW() - INTERVAL %(days_back)s DAY
            ORDER BY timestamp_utc ASC
        ]
[parameters: {'truck_id': 'GP9677', 'days_back': 7}]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
INFO:database:‚ö†Ô∏è Using CSV fallback for GP9677 refuels
ERROR:database_mysql:Error getting refuel history: (pymysql.err.OperationalError) (1054, "Unknown column 'refuel_gallons' in 'field list'")
[SQL: 
            SELECT 
                truck_id,
                timestamp_utc,
                refuel_gallons,
                estimated_pct as fuel_level_after_pct,
                estimated_liters as fuel_level_after_liters,
                estimated_gallons as fuel_level_after_gallons,
                truck_status as status,
                odometer_mi
            FROM fuel_metrics
            WHERE truck_id = %(truck_id)s
              AND refuel_gallons > 0
              AND timestamp_utc > NOW() - INTERVAL %(days_back)s DAY
            ORDER BY timestamp_utc ASC
        ]
[parameters: {'truck_id': 'JB6858', 'days_back': 7}]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
INFO:database:‚ö†Ô∏è Using CSV fallback for JB6858 refuels
INFO:database_mysql:Found 2 refuels in refuel_events table
INFO:database:‚úÖ Retrieved 2 refuel events from MySQL for JC1282
ERROR:database_mysql:Error getting refuel history: (pymysql.err.OperationalError) (1054, "Unknown column 'refuel_gallons' in 'field list'")
[SQL: 
            SELECT 
                truck_id,
                timestamp_utc,
                refuel_gallons,
                estimated_pct as fuel_level_after_pct,
                estimated_liters as fuel_level_after_liters,
                estimated_gallons as fuel_level_after_gallons,
                truck_status as status,
                odometer_mi
            FROM fuel_metrics
            WHERE truck_id = %(truck_id)s
              AND refuel_gallons > 0
              AND timestamp_utc > NOW() - INTERVAL %(days_back)s DAY
            ORDER BY timestamp_utc ASC
        ]
[parameters: {'truck_id': 'JP3281', 'days_back': 7}]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
INFO:database:‚ö†Ô∏è Using CSV fallback for JP3281 refuels
ERROR:database_mysql:Error getting refuel history: (pymysql.err.OperationalError) (1054, "Unknown column 'refuel_gallons' in 'field list'")
[SQL: 
            SELECT 
                truck_id,
                timestamp_utc,
                refuel_gallons,
                estimated_pct as fuel_level_after_pct,
                estimated_liters as fuel_level_after_liters,
                estimated_gallons as fuel_level_after_gallons,
                truck_status as status,
                odometer_mi
            FROM fuel_metrics
            WHERE truck_id = %(truck_id)s
              AND refuel_gallons > 0
              AND timestamp_utc > NOW() - INTERVAL %(days_back)s DAY
            ORDER BY timestamp_utc ASC
        ]
[parameters: {'truck_id': 'JR7099', 'days_back': 7}]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
INFO:database:‚ö†Ô∏è Using CSV fallback for JR7099 refuels
ERROR:database_mysql:Error getting refuel history: (pymysql.err.OperationalError) (1054, "Unknown column 'refuel_gallons' in 'field list'")
[SQL: 
            SELECT 
                truck_id,
                timestamp_utc,
                refuel_gallons,
                estimated_pct as fuel_level_after_pct,
                estimated_liters as fuel_level_after_liters,
                estimated_gallons as fuel_level_after_gallons,
                truck_status as status,
                odometer_mi
            FROM fuel_metrics
            WHERE truck_id = %(truck_id)s
              AND refuel_gallons > 0
              AND timestamp_utc > NOW() - INTERVAL %(days_back)s DAY
            ORDER BY timestamp_utc ASC
        ]
[parameters: {'truck_id': 'LC6799', 'days_back': 7}]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
INFO:database:‚ö†Ô∏è Using CSV fallback for LC6799 refuels
ERROR:database_mysql:Error getting refuel history: (pymysql.err.OperationalError) (1054, "Unknown column 'refuel_gallons' in 'field list'")
[SQL: 
            SELECT 
                truck_id,
                timestamp_utc,
                refuel_gallons,
                estimated_pct as fuel_level_after_pct,
                estimated_liters as fuel_level_after_liters,
                estimated_gallons as fuel_level_after_gallons,
                truck_status as status,
                odometer_mi
            FROM fuel_metrics
            WHERE truck_id = %(truck_id)s
              AND refuel_gallons > 0
              AND timestamp_utc > NOW() - INTERVAL %(days_back)s DAY
            ORDER BY timestamp_utc ASC
        ]
[parameters: {'truck_id': 'MJ9547', 'days_back': 7}]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
INFO:database:‚ö†Ô∏è Using CSV fallback for MJ9547 refuels
ERROR:database_mysql:Error getting refuel history: (pymysql.err.OperationalError) (1054, "Unknown column 'refuel_gallons' in 'field list'")
[SQL: 
            SELECT 
                truck_id,
                timestamp_utc,
                refuel_gallons,
                estimated_pct as fuel_level_after_pct,
                estimated_liters as fuel_level_after_liters,
                estimated_gallons as fuel_level_after_gallons,
                truck_status as status,
                odometer_mi
            FROM fuel_metrics
            WHERE truck_id = %(truck_id)s
              AND refuel_gallons > 0
              AND timestamp_utc > NOW() - INTERVAL %(days_back)s DAY
            ORDER BY timestamp_utc ASC
        ]
[parameters: {'truck_id': 'MO0195', 'days_back': 7}]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
INFO:database:‚ö†Ô∏è Using CSV fallback for MO0195 refuels
ERROR:database_mysql:Error getting refuel history: (pymysql.err.OperationalError) (1054, "Unknown column 'refuel_gallons' in 'field list'")
[SQL: 
            SELECT 
                truck_id,
                timestamp_utc,
                refuel_gallons,
                estimated_pct as fuel_level_after_pct,
                estimated_liters as fuel_level_after_liters,
                estimated_gallons as fuel_level_after_gallons,
                truck_status as status,
                odometer_mi
            FROM fuel_metrics
            WHERE truck_id = %(truck_id)s
              AND refuel_gallons > 0
              AND timestamp_utc > NOW() - INTERVAL %(days_back)s DAY
            ORDER BY timestamp_utc ASC
        ]
[parameters: {'truck_id': 'MR7679', 'days_back': 7}]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
INFO:database:‚ö†Ô∏è Using CSV fallback for MR7679 refuels
ERROR:database_mysql:Error getting refuel history: (pymysql.err.OperationalError) (1054, "Unknown column 'refuel_gallons' in 'field list'")
[SQL: 
            SELECT 
                truck_id,
                timestamp_utc,
                refuel_gallons,
                estimated_pct as fuel_level_after_pct,
                estimated_liters as fuel_level_after_liters,
                estimated_gallons as fuel_level_after_gallons,
                truck_status as status,
                odometer_mi
            FROM fuel_metrics
            WHERE truck_id = %(truck_id)s
              AND refuel_gallons > 0
              AND timestamp_utc > NOW() - INTERVAL %(days_back)s DAY
            ORDER BY timestamp_utc ASC
        ]
[parameters: {'truck_id': 'OM7769', 'days_back': 7}]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
INFO:database:‚ö†Ô∏è Using CSV fallback for OM7769 refuels
ERROR:database_mysql:Error getting refuel history: (pymysql.err.OperationalError) (1054, "Unknown column 'refuel_gallons' in 'field list'")
[SQL: 
            SELECT 
                truck_id,
                timestamp_utc,
                refuel_gallons,
                estimated_pct as fuel_level_after_pct,
                estimated_liters as fuel_level_after_liters,
                estimated_gallons as fuel_level_after_gallons,
                truck_status as status,
                odometer_mi
            FROM fuel_metrics
            WHERE truck_id = %(truck_id)s
              AND refuel_gallons > 0
              AND timestamp_utc > NOW() - INTERVAL %(days_back)s DAY
            ORDER BY timestamp_utc ASC
        ]
[parameters: {'truck_id': 'PC1280', 'days_back': 7}]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
INFO:database:‚ö†Ô∏è Using CSV fallback for PC1280 refuels
ERROR:database_mysql:Error getting refuel history: (pymysql.err.OperationalError) (1054, "Unknown column 'refuel_gallons' in 'field list'")
[SQL: 
            SELECT 
                truck_id,
                timestamp_utc,
                refuel_gallons,
                estimated_pct as fuel_level_after_pct,
                estimated_liters as fuel_level_after_liters,
                estimated_gallons as fuel_level_after_gallons,
                truck_status as status,
                odometer_mi
            FROM fuel_metrics
            WHERE truck_id = %(truck_id)s
              AND refuel_gallons > 0
              AND timestamp_utc > NOW() - INTERVAL %(days_back)s DAY
            ORDER BY timestamp_utc ASC
        ]
[parameters: {'truck_id': 'RH1522', 'days_back': 7}]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
INFO:database:‚ö†Ô∏è Using CSV fallback for RH1522 refuels
ERROR:database_mysql:Error getting refuel history: (pymysql.err.OperationalError) (1054, "Unknown column 'refuel_gallons' in 'field list'")
[SQL: 
            SELECT 
                truck_id,
                timestamp_utc,
                refuel_gallons,
                estimated_pct as fuel_level_after_pct,
                estimated_liters as fuel_level_after_liters,
                estimated_gallons as fuel_level_after_gallons,
                truck_status as status,
                odometer_mi
            FROM fuel_metrics
            WHERE truck_id = %(truck_id)s
              AND refuel_gallons > 0
              AND timestamp_utc > NOW() - INTERVAL %(days_back)s DAY
            ORDER BY timestamp_utc ASC
        ]
[parameters: {'truck_id': 'RR1272', 'days_back': 7}]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
INFO:database:‚ö†Ô∏è Using CSV fallback for RR1272 refuels
ERROR:database_mysql:Error getting refuel history: (pymysql.err.OperationalError) (1054, "Unknown column 'refuel_gallons' in 'field list'")
[SQL: 
            SELECT 
                truck_id,
                timestamp_utc,
                refuel_gallons,
                estimated_pct as fuel_level_after_pct,
                estimated_liters as fuel_level_after_liters,
                estimated_gallons as fuel_level_after_gallons,
                truck_status as status,
                odometer_mi
            FROM fuel_metrics
            WHERE truck_id = %(truck_id)s
              AND refuel_gallons > 0
              AND timestamp_utc > NOW() - INTERVAL %(days_back)s DAY
            ORDER BY timestamp_utc ASC
        ]
[parameters: {'truck_id': 'RT9127', 'days_back': 7}]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
INFO:database:‚ö†Ô∏è Using CSV fallback for RT9127 refuels
ERROR:database_mysql:Error getting refuel history: (pymysql.err.OperationalError) (1054, "Unknown column 'refuel_gallons' in 'field list'")
[SQL: 
            SELECT 
                truck_id,
                timestamp_utc,
                refuel_gallons,
                estimated_pct as fuel_level_after_pct,
                estimated_liters as fuel_level_after_liters,
                estimated_gallons as fuel_level_after_gallons,
                truck_status as status,
                odometer_mi
            FROM fuel_metrics
            WHERE truck_id = %(truck_id)s
              AND refuel_gallons > 0
              AND timestamp_utc > NOW() - INTERVAL %(days_back)s DAY
            ORDER BY timestamp_utc ASC
        ]
[parameters: {'truck_id': 'SG5760', 'days_back': 7}]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
INFO:database:‚ö†Ô∏è Using CSV fallback for SG5760 refuels
ERROR:database_mysql:Error getting refuel history: (pymysql.err.OperationalError) (1054, "Unknown column 'refuel_gallons' in 'field list'")
[SQL: 
            SELECT 
                truck_id,
                timestamp_utc,
                refuel_gallons,
                estimated_pct as fuel_level_after_pct,
                estimated_liters as fuel_level_after_liters,
                estimated_gallons as fuel_level_after_gallons,
                truck_status as status,
                odometer_mi
            FROM fuel_metrics
            WHERE truck_id = %(truck_id)s
              AND refuel_gallons > 0
              AND timestamp_utc > NOW() - INTERVAL %(days_back)s DAY
            ORDER BY timestamp_utc ASC
        ]
[parameters: {'truck_id': 'VD3579', 'days_back': 7}]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
INFO:database:‚ö†Ô∏è Using CSV fallback for VD3579 refuels
INFO:     127.0.0.1:63789 - "GET /fuelAnalytics/api/refuels HTTP/1.1" 200 OK
INFO:cache_service:‚úÖ Redis connected: redis://localhost:6379/0
INFO:     127.0.0.1:63791 - "GET /fuelAnalytics/api/refuels/analytics HTTP/1.1" 200 OK
INFO:database:‚úÖ Found 22 trucks in MySQL
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for CO0681
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for DO9356
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for DO9693
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for DR6664
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for FF7702
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for FM3363
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for GP9677
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for JB6858
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for JC1282
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for JP3281
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for JR7099
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for LC6799
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for MJ9547
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for MO0195
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for MR7679
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for OM7769
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for PC1280
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for RH1522
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for RR1272
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for RT9127
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for SG5760
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for VD3579
INFO:     127.0.0.1:63794 - "GET /fuelAnalytics/api/alerts HTTP/1.1" 200 OK
INFO:database_mysql:‚úÖ KPIs calculated from MySQL: 22 trucks, 2553 records, 1d period
INFO:     127.0.0.1:63796 - "GET /fuelAnalytics/api/kpis HTTP/1.1" 200 OK
INFO:database_mysql:‚úÖ Loss analysis: 22 trucks, $137.25 total loss
INFO:     127.0.0.1:63798 - "GET /fuelAnalytics/api/loss-analysis HTTP/1.1" 200 OK
INFO:database_mysql:[DriverScorecard] Filtered 26 -> 26 drivers (threshold: 10 records)
INFO:     127.0.0.1:63800 - "GET /fuelAnalytics/api/analytics/driver-scorecard HTTP/1.1" 200 OK
ERROR:main:Error in contextualized MPG: cannot import name 'get_fleet_summary' from 'terrain_factor' (/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/terrain_factor.py)
INFO:     127.0.0.1:63802 - "GET /fuelAnalytics/api/analytics/mpg-contextualized HTTP/1.1" 500 Internal Server Error
INFO:     127.0.0.1:63804 - "GET /fuelAnalytics/api/analytics/enhanced-kpis HTTP/1.1" 200 OK
INFO:     127.0.0.1:63806 - "GET /fuelAnalytics/api/analytics/enhanced-loss-analysis HTTP/1.1" 200 OK
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 86.8
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
INFO:     127.0.0.1:63808 - "GET /fuelAnalytics/api/analytics/route-efficiency HTTP/1.1" 200 OK
INFO:database_mysql:‚úÖ KPIs calculated from MySQL: 27 trucks, 18349 records, 7d period
INFO:     127.0.0.1:63810 - "GET /fuelAnalytics/api/analytics/cost-attribution HTTP/1.1" 200 OK
INFO:database_mysql:‚úÖ Loss analysis: 27 trucks, $4147.63 total loss
INFO:     127.0.0.1:63812 - "GET /fuelAnalytics/api/analytics/inefficiency-causes HTTP/1.1" 200 OK
INFO:database:‚úÖ Using MySQL for fleet summary - 22 trucks found
ERROR:database:üîç DEBUG database.py: First truck keys: ['truck_id', 'status', 'fuel_level', 'estimated_pct', 'estimated_gallons', 'sensor_pct', 'sensor_gallons', 'drift', 'drift_pct', 'mpg', 'idle_gph', 'speed', 'speed_mph', 'rpm', 'idle_method', 'last_update', 'health_score', 'health_category']
ERROR:database:üîç DEBUG database.py: sensor_pct value: 86.8
INFO:database:‚úÖ Retrieved 22 truck details from MySQL
INFO:     127.0.0.1:63814 - "GET /fuelAnalytics/api/analytics/inefficiency-by-truck HTTP/1.1" 200 OK
INFO:database:‚úÖ Retrieved 173 history records from MySQL for DO9693
INFO:     127.0.0.1:63816 - "GET /fuelAnalytics/api/trucks/DO9693/sensor-history HTTP/1.1" 200 OK
INFO:database:‚úÖ Retrieved 173 history records from MySQL for DO9693
INFO:     127.0.0.1:63818 - "GET /fuelAnalytics/api/trucks/DO9693/fuel-trend HTTP/1.1" 200 OK
ERROR:database_pool:Database connection error: (1146, "Table 'fuel_copilot_local.units_map' doesn't exist")
ERROR:database_enhanced:Error getting fleet sensor status: (1146, "Table 'fuel_copilot_local.units_map' doesn't exist")
INFO:     127.0.0.1:63820 - "GET /fuelAnalytics/api/fleet/sensor-health HTTP/1.1" 200 OK
INFO:     127.0.0.1:63822 - "GET /fuelAnalytics/api/health/fleet/summary HTTP/1.1" 200 OK
INFO:     127.0.0.1:63824 - "GET /fuelAnalytics/api/health/truck/DO9693 HTTP/1.1" 503 Service Unavailable
INFO:     127.0.0.1:63826 - "GET /fuelAnalytics/api/health/sensors HTTP/1.1" 503 Service Unavailable
INFO:database:‚úÖ Found 22 trucks in MySQL
ERROR:database_mysql:Error getting refuel history: (pymysql.err.OperationalError) (1054, "Unknown column 'refuel_gallons' in 'field list'")
[SQL: 
            SELECT 
                truck_id,
                timestamp_utc,
                refuel_gallons,
                estimated_pct as fuel_level_after_pct,
                estimated_liters as fuel_level_after_liters,
                estimated_gallons as fuel_level_after_gallons,
                truck_status as status,
                odometer_mi
            FROM fuel_metrics
            WHERE truck_id = %(truck_id)s
              AND refuel_gallons > 0
              AND timestamp_utc > NOW() - INTERVAL %(days_back)s DAY
            ORDER BY timestamp_utc ASC
        ]
[parameters: {'truck_id': 'CO0681', 'days_back': 7}]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
INFO:database:‚ö†Ô∏è Using CSV fallback for CO0681 refuels
ERROR:database_mysql:Error getting refuel history: (pymysql.err.OperationalError) (1054, "Unknown column 'refuel_gallons' in 'field list'")
[SQL: 
            SELECT 
                truck_id,
                timestamp_utc,
                refuel_gallons,
                estimated_pct as fuel_level_after_pct,
                estimated_liters as fuel_level_after_liters,
                estimated_gallons as fuel_level_after_gallons,
                truck_status as status,
                odometer_mi
            FROM fuel_metrics
            WHERE truck_id = %(truck_id)s
              AND refuel_gallons > 0
              AND timestamp_utc > NOW() - INTERVAL %(days_back)s DAY
            ORDER BY timestamp_utc ASC
        ]
[parameters: {'truck_id': 'DO9356', 'days_back': 7}]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
INFO:database:‚ö†Ô∏è Using CSV fallback for DO9356 refuels
ERROR:database_mysql:Error getting refuel history: (pymysql.err.OperationalError) (1054, "Unknown column 'refuel_gallons' in 'field list'")
[SQL: 
            SELECT 
                truck_id,
                timestamp_utc,
                refuel_gallons,
                estimated_pct as fuel_level_after_pct,
                estimated_liters as fuel_level_after_liters,
                estimated_gallons as fuel_level_after_gallons,
                truck_status as status,
                odometer_mi
            FROM fuel_metrics
            WHERE truck_id = %(truck_id)s
              AND refuel_gallons > 0
              AND timestamp_utc > NOW() - INTERVAL %(days_back)s DAY
            ORDER BY timestamp_utc ASC
        ]
[parameters: {'truck_id': 'DO9693', 'days_back': 7}]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
INFO:database:‚ö†Ô∏è Using CSV fallback for DO9693 refuels
ERROR:database_mysql:Error getting refuel history: (pymysql.err.OperationalError) (1054, "Unknown column 'refuel_gallons' in 'field list'")
[SQL: 
            SELECT 
                truck_id,
                timestamp_utc,
                refuel_gallons,
                estimated_pct as fuel_level_after_pct,
                estimated_liters as fuel_level_after_liters,
                estimated_gallons as fuel_level_after_gallons,
                truck_status as status,
                odometer_mi
            FROM fuel_metrics
            WHERE truck_id = %(truck_id)s
              AND refuel_gallons > 0
              AND timestamp_utc > NOW() - INTERVAL %(days_back)s DAY
            ORDER BY timestamp_utc ASC
        ]
[parameters: {'truck_id': 'DR6664', 'days_back': 7}]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
INFO:database:‚ö†Ô∏è Using CSV fallback for DR6664 refuels
ERROR:database_mysql:Error getting refuel history: (pymysql.err.OperationalError) (1054, "Unknown column 'refuel_gallons' in 'field list'")
[SQL: 
            SELECT 
                truck_id,
                timestamp_utc,
                refuel_gallons,
                estimated_pct as fuel_level_after_pct,
                estimated_liters as fuel_level_after_liters,
                estimated_gallons as fuel_level_after_gallons,
                truck_status as status,
                odometer_mi
            FROM fuel_metrics
            WHERE truck_id = %(truck_id)s
              AND refuel_gallons > 0
              AND timestamp_utc > NOW() - INTERVAL %(days_back)s DAY
            ORDER BY timestamp_utc ASC
        ]
[parameters: {'truck_id': 'FF7702', 'days_back': 7}]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
INFO:database:‚ö†Ô∏è Using CSV fallback for FF7702 refuels
ERROR:database_mysql:Error getting refuel history: (pymysql.err.OperationalError) (1054, "Unknown column 'refuel_gallons' in 'field list'")
[SQL: 
            SELECT 
                truck_id,
                timestamp_utc,
                refuel_gallons,
                estimated_pct as fuel_level_after_pct,
                estimated_liters as fuel_level_after_liters,
                estimated_gallons as fuel_level_after_gallons,
                truck_status as status,
                odometer_mi
            FROM fuel_metrics
            WHERE truck_id = %(truck_id)s
              AND refuel_gallons > 0
              AND timestamp_utc > NOW() - INTERVAL %(days_back)s DAY
            ORDER BY timestamp_utc ASC
        ]
[parameters: {'truck_id': 'FM3363', 'days_back': 7}]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
INFO:database:‚ö†Ô∏è Using CSV fallback for FM3363 refuels
ERROR:database_mysql:Error getting refuel history: (pymysql.err.OperationalError) (1054, "Unknown column 'refuel_gallons' in 'field list'")
[SQL: 
            SELECT 
                truck_id,
                timestamp_utc,
                refuel_gallons,
                estimated_pct as fuel_level_after_pct,
                estimated_liters as fuel_level_after_liters,
                estimated_gallons as fuel_level_after_gallons,
                truck_status as status,
                odometer_mi
            FROM fuel_metrics
            WHERE truck_id = %(truck_id)s
              AND refuel_gallons > 0
              AND timestamp_utc > NOW() - INTERVAL %(days_back)s DAY
            ORDER BY timestamp_utc ASC
        ]
[parameters: {'truck_id': 'GP9677', 'days_back': 7}]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
INFO:database:‚ö†Ô∏è Using CSV fallback for GP9677 refuels
ERROR:database_mysql:Error getting refuel history: (pymysql.err.OperationalError) (1054, "Unknown column 'refuel_gallons' in 'field list'")
[SQL: 
            SELECT 
                truck_id,
                timestamp_utc,
                refuel_gallons,
                estimated_pct as fuel_level_after_pct,
                estimated_liters as fuel_level_after_liters,
                estimated_gallons as fuel_level_after_gallons,
                truck_status as status,
                odometer_mi
            FROM fuel_metrics
            WHERE truck_id = %(truck_id)s
              AND refuel_gallons > 0
              AND timestamp_utc > NOW() - INTERVAL %(days_back)s DAY
            ORDER BY timestamp_utc ASC
        ]
[parameters: {'truck_id': 'JB6858', 'days_back': 7}]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
INFO:database:‚ö†Ô∏è Using CSV fallback for JB6858 refuels
INFO:database_mysql:Found 2 refuels in refuel_events table
INFO:database:‚úÖ Retrieved 2 refuel events from MySQL for JC1282
ERROR:database_mysql:Error getting refuel history: (pymysql.err.OperationalError) (1054, "Unknown column 'refuel_gallons' in 'field list'")
[SQL: 
            SELECT 
                truck_id,
                timestamp_utc,
                refuel_gallons,
                estimated_pct as fuel_level_after_pct,
                estimated_liters as fuel_level_after_liters,
                estimated_gallons as fuel_level_after_gallons,
                truck_status as status,
                odometer_mi
            FROM fuel_metrics
            WHERE truck_id = %(truck_id)s
              AND refuel_gallons > 0
              AND timestamp_utc > NOW() - INTERVAL %(days_back)s DAY
            ORDER BY timestamp_utc ASC
        ]
[parameters: {'truck_id': 'JP3281', 'days_back': 7}]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
INFO:database:‚ö†Ô∏è Using CSV fallback for JP3281 refuels
ERROR:database_mysql:Error getting refuel history: (pymysql.err.OperationalError) (1054, "Unknown column 'refuel_gallons' in 'field list'")
[SQL: 
            SELECT 
                truck_id,
                timestamp_utc,
                refuel_gallons,
                estimated_pct as fuel_level_after_pct,
                estimated_liters as fuel_level_after_liters,
                estimated_gallons as fuel_level_after_gallons,
                truck_status as status,
                odometer_mi
            FROM fuel_metrics
            WHERE truck_id = %(truck_id)s
              AND refuel_gallons > 0
              AND timestamp_utc > NOW() - INTERVAL %(days_back)s DAY
            ORDER BY timestamp_utc ASC
        ]
[parameters: {'truck_id': 'JR7099', 'days_back': 7}]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
INFO:database:‚ö†Ô∏è Using CSV fallback for JR7099 refuels
ERROR:database_mysql:Error getting refuel history: (pymysql.err.OperationalError) (1054, "Unknown column 'refuel_gallons' in 'field list'")
[SQL: 
            SELECT 
                truck_id,
                timestamp_utc,
                refuel_gallons,
                estimated_pct as fuel_level_after_pct,
                estimated_liters as fuel_level_after_liters,
                estimated_gallons as fuel_level_after_gallons,
                truck_status as status,
                odometer_mi
            FROM fuel_metrics
            WHERE truck_id = %(truck_id)s
              AND refuel_gallons > 0
              AND timestamp_utc > NOW() - INTERVAL %(days_back)s DAY
            ORDER BY timestamp_utc ASC
        ]
[parameters: {'truck_id': 'LC6799', 'days_back': 7}]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
INFO:database:‚ö†Ô∏è Using CSV fallback for LC6799 refuels
ERROR:database_mysql:Error getting refuel history: (pymysql.err.OperationalError) (1054, "Unknown column 'refuel_gallons' in 'field list'")
[SQL: 
            SELECT 
                truck_id,
                timestamp_utc,
                refuel_gallons,
                estimated_pct as fuel_level_after_pct,
                estimated_liters as fuel_level_after_liters,
                estimated_gallons as fuel_level_after_gallons,
                truck_status as status,
                odometer_mi
            FROM fuel_metrics
            WHERE truck_id = %(truck_id)s
              AND refuel_gallons > 0
              AND timestamp_utc > NOW() - INTERVAL %(days_back)s DAY
            ORDER BY timestamp_utc ASC
        ]
[parameters: {'truck_id': 'MJ9547', 'days_back': 7}]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
INFO:database:‚ö†Ô∏è Using CSV fallback for MJ9547 refuels
ERROR:database_mysql:Error getting refuel history: (pymysql.err.OperationalError) (1054, "Unknown column 'refuel_gallons' in 'field list'")
[SQL: 
            SELECT 
                truck_id,
                timestamp_utc,
                refuel_gallons,
                estimated_pct as fuel_level_after_pct,
                estimated_liters as fuel_level_after_liters,
                estimated_gallons as fuel_level_after_gallons,
                truck_status as status,
                odometer_mi
            FROM fuel_metrics
            WHERE truck_id = %(truck_id)s
              AND refuel_gallons > 0
              AND timestamp_utc > NOW() - INTERVAL %(days_back)s DAY
            ORDER BY timestamp_utc ASC
        ]
[parameters: {'truck_id': 'MO0195', 'days_back': 7}]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
INFO:database:‚ö†Ô∏è Using CSV fallback for MO0195 refuels
ERROR:database_mysql:Error getting refuel history: (pymysql.err.OperationalError) (1054, "Unknown column 'refuel_gallons' in 'field list'")
[SQL: 
            SELECT 
                truck_id,
                timestamp_utc,
                refuel_gallons,
                estimated_pct as fuel_level_after_pct,
                estimated_liters as fuel_level_after_liters,
                estimated_gallons as fuel_level_after_gallons,
                truck_status as status,
                odometer_mi
            FROM fuel_metrics
            WHERE truck_id = %(truck_id)s
              AND refuel_gallons > 0
              AND timestamp_utc > NOW() - INTERVAL %(days_back)s DAY
            ORDER BY timestamp_utc ASC
        ]
[parameters: {'truck_id': 'MR7679', 'days_back': 7}]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
INFO:database:‚ö†Ô∏è Using CSV fallback for MR7679 refuels
ERROR:database_mysql:Error getting refuel history: (pymysql.err.OperationalError) (1054, "Unknown column 'refuel_gallons' in 'field list'")
[SQL: 
            SELECT 
                truck_id,
                timestamp_utc,
                refuel_gallons,
                estimated_pct as fuel_level_after_pct,
                estimated_liters as fuel_level_after_liters,
                estimated_gallons as fuel_level_after_gallons,
                truck_status as status,
                odometer_mi
            FROM fuel_metrics
            WHERE truck_id = %(truck_id)s
              AND refuel_gallons > 0
              AND timestamp_utc > NOW() - INTERVAL %(days_back)s DAY
            ORDER BY timestamp_utc ASC
        ]
[parameters: {'truck_id': 'OM7769', 'days_back': 7}]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
INFO:database:‚ö†Ô∏è Using CSV fallback for OM7769 refuels
ERROR:database_mysql:Error getting refuel history: (pymysql.err.OperationalError) (1054, "Unknown column 'refuel_gallons' in 'field list'")
[SQL: 
            SELECT 
                truck_id,
                timestamp_utc,
                refuel_gallons,
                estimated_pct as fuel_level_after_pct,
                estimated_liters as fuel_level_after_liters,
                estimated_gallons as fuel_level_after_gallons,
                truck_status as status,
                odometer_mi
            FROM fuel_metrics
            WHERE truck_id = %(truck_id)s
              AND refuel_gallons > 0
              AND timestamp_utc > NOW() - INTERVAL %(days_back)s DAY
            ORDER BY timestamp_utc ASC
        ]
[parameters: {'truck_id': 'PC1280', 'days_back': 7}]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
INFO:database:‚ö†Ô∏è Using CSV fallback for PC1280 refuels
ERROR:database_mysql:Error getting refuel history: (pymysql.err.OperationalError) (1054, "Unknown column 'refuel_gallons' in 'field list'")
[SQL: 
            SELECT 
                truck_id,
                timestamp_utc,
                refuel_gallons,
                estimated_pct as fuel_level_after_pct,
                estimated_liters as fuel_level_after_liters,
                estimated_gallons as fuel_level_after_gallons,
                truck_status as status,
                odometer_mi
            FROM fuel_metrics
            WHERE truck_id = %(truck_id)s
              AND refuel_gallons > 0
              AND timestamp_utc > NOW() - INTERVAL %(days_back)s DAY
            ORDER BY timestamp_utc ASC
        ]
[parameters: {'truck_id': 'RH1522', 'days_back': 7}]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
INFO:database:‚ö†Ô∏è Using CSV fallback for RH1522 refuels
ERROR:database_mysql:Error getting refuel history: (pymysql.err.OperationalError) (1054, "Unknown column 'refuel_gallons' in 'field list'")
[SQL: 
            SELECT 
                truck_id,
                timestamp_utc,
                refuel_gallons,
                estimated_pct as fuel_level_after_pct,
                estimated_liters as fuel_level_after_liters,
                estimated_gallons as fuel_level_after_gallons,
                truck_status as status,
                odometer_mi
            FROM fuel_metrics
            WHERE truck_id = %(truck_id)s
              AND refuel_gallons > 0
              AND timestamp_utc > NOW() - INTERVAL %(days_back)s DAY
            ORDER BY timestamp_utc ASC
        ]
[parameters: {'truck_id': 'RR1272', 'days_back': 7}]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
INFO:database:‚ö†Ô∏è Using CSV fallback for RR1272 refuels
ERROR:database_mysql:Error getting refuel history: (pymysql.err.OperationalError) (1054, "Unknown column 'refuel_gallons' in 'field list'")
[SQL: 
            SELECT 
                truck_id,
                timestamp_utc,
                refuel_gallons,
                estimated_pct as fuel_level_after_pct,
                estimated_liters as fuel_level_after_liters,
                estimated_gallons as fuel_level_after_gallons,
                truck_status as status,
                odometer_mi
            FROM fuel_metrics
            WHERE truck_id = %(truck_id)s
              AND refuel_gallons > 0
              AND timestamp_utc > NOW() - INTERVAL %(days_back)s DAY
            ORDER BY timestamp_utc ASC
        ]
[parameters: {'truck_id': 'RT9127', 'days_back': 7}]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
INFO:database:‚ö†Ô∏è Using CSV fallback for RT9127 refuels
ERROR:database_mysql:Error getting refuel history: (pymysql.err.OperationalError) (1054, "Unknown column 'refuel_gallons' in 'field list'")
[SQL: 
            SELECT 
                truck_id,
                timestamp_utc,
                refuel_gallons,
                estimated_pct as fuel_level_after_pct,
                estimated_liters as fuel_level_after_liters,
                estimated_gallons as fuel_level_after_gallons,
                truck_status as status,
                odometer_mi
            FROM fuel_metrics
            WHERE truck_id = %(truck_id)s
              AND refuel_gallons > 0
              AND timestamp_utc > NOW() - INTERVAL %(days_back)s DAY
            ORDER BY timestamp_utc ASC
        ]
[parameters: {'truck_id': 'SG5760', 'days_back': 7}]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
INFO:database:‚ö†Ô∏è Using CSV fallback for SG5760 refuels
ERROR:database_mysql:Error getting refuel history: (pymysql.err.OperationalError) (1054, "Unknown column 'refuel_gallons' in 'field list'")
[SQL: 
            SELECT 
                truck_id,
                timestamp_utc,
                refuel_gallons,
                estimated_pct as fuel_level_after_pct,
                estimated_liters as fuel_level_after_liters,
                estimated_gallons as fuel_level_after_gallons,
                truck_status as status,
                odometer_mi
            FROM fuel_metrics
            WHERE truck_id = %(truck_id)s
              AND refuel_gallons > 0
              AND timestamp_utc > NOW() - INTERVAL %(days_back)s DAY
            ORDER BY timestamp_utc ASC
        ]
[parameters: {'truck_id': 'VD3579', 'days_back': 7}]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
INFO:database:‚ö†Ô∏è Using CSV fallback for VD3579 refuels
INFO:     127.0.0.1:63828 - "GET /fuelAnalytics/api/batch/dashboard HTTP/1.1" 200 OK
INFO:     127.0.0.1:63830 - "GET /fuelAnalytics/api/analytics/driver/DO9693/history HTTP/1.1" 200 OK
INFO:     127.0.0.1:63832 - "GET /fuelAnalytics/api/analytics/truck/DO9693/mpg-context HTTP/1.1" 422 Unprocessable Entity
INFO:theft_detection_engine:üîç Starting advanced theft analysis for last 7 days...
INFO:theft_detection_engine:üìä Found 16 significant drops from local DB
INFO:theft_detection_engine:üì¶ Loading trips for 7 units...
INFO:theft_detection_engine:üì¶ Loaded trips for 7 units
INFO:theft_detection_engine:üîÑ Analyzing 16 drops...
INFO:     127.0.0.1:63834 - "GET /fuelAnalytics/api/theft-analysis HTTP/1.1" 200 OK
INFO:observability:[get_truck_detail] Fetching data for DO9693
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for DO9693
INFO:     127.0.0.1:63837 - "GET /fuelAnalytics/api/trucks/DO9693 HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/fastapi/applications.py", line 1139, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/gzip.py", line 130, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/main.py", line 741, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/anaconda3/lib/python3.12/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 177, in __call__
    raise exc
  File "/opt/anaconda3/lib/python3.12/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 175, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/anaconda3/lib/python3.12/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "/opt/anaconda3/lib/python3.12/site-packages/fastapi/routing.py", line 120, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/anaconda3/lib/python3.12/site-packages/fastapi/routing.py", line 106, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/fastapi/routing.py", line 464, in app
    response = actual_response_class(content, **response_args)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/responses.py", line 189, in __init__
    super().__init__(content, status_code, headers, media_type, background)
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/responses.py", line 46, in __init__
    self.body = self.render(content)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/responses.py", line 192, in render
    return json.dumps(
           ^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/json/__init__.py", line 238, in dumps
    **kw).encode(obj)
          ^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/json/encoder.py", line 258, in iterencode
    return _iterencode(o, 0)
           ^^^^^^^^^^^^^^^^^
ValueError: Out of range float values are not JSON compliant: nan
INFO:observability:[get_truck_detail] Fetching data for FF7702
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚úÖ MySQL data retrieved for FF7702
INFO:     127.0.0.1:63839 - "GET /fuelAnalytics/api/trucks/FF7702 HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/fastapi/applications.py", line 1139, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/gzip.py", line 29, in __call__
    await responder(scope, receive, send)
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/gzip.py", line 130, in __call__
    await super().__call__(scope, receive, send)
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/gzip.py", line 46, in __call__
    await self.app(scope, receive, self.send_with_compression)
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/base.py", line 191, in __call__
    with recv_stream, send_stream, collapse_excgroups():
                                   ^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
    raise exc
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/base.py", line 193, in __call__
    response = await self.dispatch_func(request, call_next)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/tomasruiz/Desktop/Fuel-Analytics-Backend/main.py", line 741, in dispatch
    response = await call_next(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/base.py", line 168, in call_next
    raise app_exc from app_exc.__cause__ or app_exc.__context__
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/base.py", line 144, in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
  File "/opt/anaconda3/lib/python3.12/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 177, in __call__
    raise exc
  File "/opt/anaconda3/lib/python3.12/site-packages/prometheus_fastapi_instrumentator/middleware.py", line 175, in __call__
    await self.app(scope, receive, send_wrapper)
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/anaconda3/lib/python3.12/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "/opt/anaconda3/lib/python3.12/site-packages/fastapi/routing.py", line 120, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/opt/anaconda3/lib/python3.12/site-packages/fastapi/routing.py", line 106, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/fastapi/routing.py", line 464, in app
    response = actual_response_class(content, **response_args)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/responses.py", line 189, in __init__
    super().__init__(content, status_code, headers, media_type, background)
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/responses.py", line 46, in __init__
    self.body = self.render(content)
                ^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/starlette/responses.py", line 192, in render
    return json.dumps(
           ^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/json/__init__.py", line 238, in dumps
    **kw).encode(obj)
          ^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/json/encoder.py", line 258, in iterencode
    return _iterencode(o, 0)
           ^^^^^^^^^^^^^^^^^
ValueError: Out of range float values are not JSON compliant: nan
INFO:observability:[get_truck_detail] Fetching data for GS5030
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚ö†Ô∏è Using CSV fallback for GS5030
INFO:     127.0.0.1:63841 - "GET /fuelAnalytics/api/trucks/GS5030 HTTP/1.1" 200 OK
INFO:observability:[get_truck_detail] Fetching data for GS5032
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚ö†Ô∏è Using CSV fallback for GS5032
INFO:     127.0.0.1:63843 - "GET /fuelAnalytics/api/trucks/GS5032 HTTP/1.1" 404 Not Found
INFO:observability:[get_truck_detail] Fetching data for GS5033
INFO:database_mysql:Retrieved 22 trucks from MySQL
INFO:database:‚ö†Ô∏è Using CSV fallback for GS5033
INFO:     127.0.0.1:63845 - "GET /fuelAnalytics/api/trucks/GS5033 HTTP/1.1" 404 Not Found
INFO:database:‚úÖ Retrieved 173 history records from MySQL for DO9693
INFO:     127.0.0.1:63847 - "GET /fuelAnalytics/api/trucks/DO9693/sensor-history HTTP/1.1" 200 OK
INFO:database:‚úÖ Retrieved 82 history records from MySQL for FF7702
INFO:     127.0.0.1:63849 - "GET /fuelAnalytics/api/trucks/FF7702/sensor-history HTTP/1.1" 200 OK
INFO:database:‚ö†Ô∏è Using CSV fallback for GS5030 history
INFO:     127.0.0.1:63851 - "GET /fuelAnalytics/api/trucks/GS5030/sensor-history HTTP/1.1" 200 OK
INFO:     127.0.0.1:63853 - "GET /fuelAnalytics/api/health/truck/DO9693 HTTP/1.1" 503 Service Unavailable
INFO:     127.0.0.1:63855 - "GET /fuelAnalytics/api/health/truck/FF7702 HTTP/1.1" 503 Service Unavailable
INFO:     127.0.0.1:63857 - "GET /fuelAnalytics/api/health/truck/GS5030 HTTP/1.1" 503 Service Unavailable
WARNING:  WatchFiles detected changes in 'tests/test_predictive_edge_cases_final.py', 'tests/test_predictive_main_execution.py', 'tests/test_predictive_complete_90pct.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üõë Shutting down Fuel Copilot API
INFO:lifecycle_manager:üìÖ Shutdown Time: 2025-12-28T21:02:06.746338
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üîÑ Disconnecting cache...
INFO:lifecycle_manager:‚úÖ Cache disconnected
INFO:lifecycle_manager:üîÑ Closing async database pool...
INFO:database_async:üîÑ Closing async MySQL connection pool...
INFO:database_async:‚úÖ Async MySQL connection pool closed
INFO:lifecycle_manager:‚úÖ Async DB pool closed
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:‚úÖ Clean shutdown completed
INFO:lifecycle_manager:================================================================================
INFO:     Application shutdown complete.
INFO:     Finished server process [75238]
‚ö†Ô∏è MYSQL_PASSWORD not set - database connections will fail
‚ö†Ô∏è LOCAL_DB_PASS not set - local database connections will fail
‚ö†Ô∏è  Redis cache unavailable: No module named 'redis_cache'
/opt/anaconda3/lib/python3.12/site-packages/keras/src/export/tf2onnx_lib.py:8: FutureWarning: In the future `np.object` will be defined as the corresponding NumPy scalar.
  if not hasattr(np, "object"):
‚ö†Ô∏è MPG History router not available: No module named 'logger_config'
INFO:main:‚úÖ Driver Alerts router registered
INFO:main:‚úÖ Alerts router registered
INFO:main:‚úÖ Trucks router registered
INFO:main:‚úÖ Refuels router registered
INFO:main:‚úÖ Analytics router registered
INFO:main:‚úÖ Maintenance router registered
INFO:ekf_integration:‚úÖ EKFManager inicializado en data/ekf_states
INFO:main:‚úÖ FASE 2A: EKF Integration & Diagnostics endpoints registered
INFO:main:‚úÖ FASE 2B: ML Pipeline (LSTM + Anomaly Detection + Driver Scoring) loaded
INFO:kafka_event_bus:‚úÖ Event Bus inicializado
INFO:kafka_event_bus:‚úÖ Event Bus suscriptores inicializados
INFO:main:‚úÖ FASE 2C: Event Bus & Microservices Orchestrator loaded
INFO:main:‚úÖ New Features: Cache + WebSocket + ML + Coaching registered
INFO:main:‚úÖ API v2 router registered
INFO:main:‚úÖ FASE 2C: Route Optimization Engine loaded
INFO:main:‚úÖ Prometheus metrics enabled
INFO:main:‚úÖ Rate limiting middleware enabled
INFO:main:‚úÖ GZip compression middleware enabled
INFO:main:‚úÖ CORS configured with 5 allowed origins
INFO:main:‚úÖ Global exception handler registered
INFO:routers:‚úÖ Registered api_v2 router at /fuelAnalytics/api/v2
INFO:routers:‚úÖ Registered command_center router at /fuelAnalytics/api/command-center
INFO:main:‚úÖ All routers included successfully
INFO:routers_v3:‚úÖ Registered api_v2 router at /fuelAnalytics/api/v2
INFO:routers_v3:‚úÖ Registered sse_endpoints router
INFO:routers_v3:‚úÖ Registered fuel_stations router
INFO:routers_v3:‚úÖ Registered sensor_health_router
INFO:routers_v3:‚úÖ Registered mpg_baseline_router
INFO:routers_v3:‚úÖ Registered driver_alerts_router at /fuelAnalytics/api/v2/driver-alerts
INFO:routers_v3:üöÄ v3.12.21 routers registration complete
INFO:main:‚úÖ v3.12.21 API v2 router registered
INFO:v5_endpoints:‚úÖ V5 Endpoints registered (Fleet Analytics + Leaderboard)
INFO:main:‚úÖ V5 Clean Endpoints registered (Fleet Analytics, Leaderboard)
INFO:main:üöÄ v5.2: Using new lightweight v5 endpoints (TruckHealthMonitor disabled)
INFO:     Started server process [78780]
INFO:     Waiting for application startup.
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üöÄ Fuel Copilot API v3.12.0 STARTING...
INFO:lifecycle_manager:üìÖ Startup Time: 2025-12-28T21:02:10.687763
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:üîÑ Initializing multi-layer cache...
INFO:lifecycle_manager:‚úÖ Multi-layer cache connected successfully
INFO:lifecycle_manager:üîÑ Initializing async database pool...
INFO:database_async:üîÑ Creating async MySQL connection pool...
INFO:database_async:   Host: localhost:3306
INFO:database_async:   Database: fuel_copilot_local
INFO:database_async:   Pool size: 5-20
INFO:database_async:‚úÖ Async MySQL connection pool created successfully
INFO:lifecycle_manager:‚úÖ Async DB pool initialized successfully
INFO:database_mysql:‚úÖ SQLAlchemy engine created with connection pooling (10+5 connections)
INFO:database:‚úÖ Found 22 trucks in MySQL
INFO:lifecycle_manager:Available trucks: 22
INFO:lifecycle_manager:MySQL enhanced features: enabled
INFO:lifecycle_manager:================================================================================
INFO:lifecycle_manager:‚úÖ API ready for connections
INFO:lifecycle_manager:================================================================================
INFO:     Application startup complete.
